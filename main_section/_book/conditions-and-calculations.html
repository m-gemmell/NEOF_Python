<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Conditions and Calculations | Python for Bioinformatics</title>
  <meta name="description" content="11 Conditions and Calculations | Python for Bioinformatics" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Conditions and Calculations | Python for Bioinformatics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Conditions and Calculations | Python for Bioinformatics" />
  
  
  

<meta name="author" content="Graeme Fox" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reading-sequence-data.html"/>
<link rel="next" href="reading-and-writing-files.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="python-for-bioinformatics.html"><a href="python-for-bioinformatics.html"><i class="fa fa-check"></i><b>2</b> Python for bioinformatics</a></li>
<li class="chapter" data-level="3" data-path="cluster-introduction.html"><a href="cluster-introduction.html"><i class="fa fa-check"></i><b>3</b> Cluster Introduction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cluster-introduction.html"><a href="cluster-introduction.html#logon-instructions"><i class="fa fa-check"></i><b>3.1</b> Logon Instructions</a></li>
<li class="chapter" data-level="3.2" data-path="cluster-introduction.html"><a href="cluster-introduction.html#the-terminal-window"><i class="fa fa-check"></i><b>3.2</b> The Terminal Window</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="scripting-in-python.html"><a href="scripting-in-python.html"><i class="fa fa-check"></i><b>4</b> Scripting in Python</a>
<ul>
<li class="chapter" data-level="4.1" data-path="scripting-in-python.html"><a href="scripting-in-python.html#introduction-to-commands-and-scripts"><i class="fa fa-check"></i><b>4.1</b> Introduction to commands and scripts</a></li>
<li class="chapter" data-level="4.2" data-path="scripting-in-python.html"><a href="scripting-in-python.html#issuing-commands-directly-to-the-interpretator"><i class="fa fa-check"></i><b>4.2</b> Issuing commands directly to the interpretator</a></li>
<li class="chapter" data-level="4.3" data-path="scripting-in-python.html"><a href="scripting-in-python.html#a-note-on-indentation"><i class="fa fa-check"></i><b>4.3</b> A note on indentation</a></li>
<li class="chapter" data-level="4.4" data-path="scripting-in-python.html"><a href="scripting-in-python.html#tabs-vs-spaces"><i class="fa fa-check"></i><b>4.4</b> Tabs vs spaces</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="python-fundamentals.html"><a href="python-fundamentals.html"><i class="fa fa-check"></i><b>5</b> Python Fundamentals</a>
<ul>
<li class="chapter" data-level="5.1" data-path="python-fundamentals.html"><a href="python-fundamentals.html#operators"><i class="fa fa-check"></i><b>5.1</b> Operators</a></li>
<li class="chapter" data-level="5.2" data-path="python-fundamentals.html"><a href="python-fundamentals.html#comments"><i class="fa fa-check"></i><b>5.2</b> Comments</a></li>
<li class="chapter" data-level="5.3" data-path="python-fundamentals.html"><a href="python-fundamentals.html#variables"><i class="fa fa-check"></i><b>5.3</b> Variables</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="python-fundamentals.html"><a href="python-fundamentals.html#strings"><i class="fa fa-check"></i><b>5.3.1</b> Strings</a></li>
<li class="chapter" data-level="5.3.2" data-path="python-fundamentals.html"><a href="python-fundamentals.html#integers"><i class="fa fa-check"></i><b>5.3.2</b> Integers</a></li>
<li class="chapter" data-level="5.3.3" data-path="python-fundamentals.html"><a href="python-fundamentals.html#floats-floating-point-numbers"><i class="fa fa-check"></i><b>5.3.3</b> Floats (floating point numbers)</a></li>
<li class="chapter" data-level="5.3.4" data-path="python-fundamentals.html"><a href="python-fundamentals.html#booleans"><i class="fa fa-check"></i><b>5.3.4</b> Booleans</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="python-fundamentals.html"><a href="python-fundamentals.html#classes-of-variable"><i class="fa fa-check"></i><b>5.4</b> Classes of variable</a></li>
<li class="chapter" data-level="5.5" data-path="python-fundamentals.html"><a href="python-fundamentals.html#transforming-variables"><i class="fa fa-check"></i><b>5.5</b> Transforming variables</a></li>
<li class="chapter" data-level="5.6" data-path="python-fundamentals.html"><a href="python-fundamentals.html#functions-and-methods"><i class="fa fa-check"></i><b>5.6</b> Functions and methods</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="python-fundamentals.html"><a href="python-fundamentals.html#running-a-function"><i class="fa fa-check"></i><b>5.6.1</b> Running a function</a></li>
<li class="chapter" data-level="5.6.2" data-path="python-fundamentals.html"><a href="python-fundamentals.html#running-a-method"><i class="fa fa-check"></i><b>5.6.2</b> Running a method</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="python-fundamentals.html"><a href="python-fundamentals.html#recap"><i class="fa fa-check"></i><b>5.7</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>6</b> Data Structures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>6.1</b> Lists</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-structures.html"><a href="data-structures.html#add-numeric-data-to-a-list"><i class="fa fa-check"></i><b>6.1.1</b> Add numeric data to a list</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-structures.html"><a href="data-structures.html#set"><i class="fa fa-check"></i><b>6.2</b> Set</a></li>
<li class="chapter" data-level="6.3" data-path="data-structures.html"><a href="data-structures.html#dictionary"><i class="fa fa-check"></i><b>6.3</b> Dictionary</a></li>
<li class="chapter" data-level="6.4" data-path="data-structures.html"><a href="data-structures.html#recap-1"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="python-conditions-if-and-else-statements.html"><a href="python-conditions-if-and-else-statements.html"><i class="fa fa-check"></i><b>7</b> Python Conditions: ‘if’ and ‘else’ statements</a>
<ul>
<li class="chapter" data-level="7.1" data-path="python-conditions-if-and-else-statements.html"><a href="python-conditions-if-and-else-statements.html#if-statements"><i class="fa fa-check"></i><b>7.1</b> If statements</a></li>
<li class="chapter" data-level="7.2" data-path="python-conditions-if-and-else-statements.html"><a href="python-conditions-if-and-else-statements.html#if-else-statements"><i class="fa fa-check"></i><b>7.2</b> If else statements</a></li>
<li class="chapter" data-level="7.3" data-path="python-conditions-if-and-else-statements.html"><a href="python-conditions-if-and-else-statements.html#recap-2"><i class="fa fa-check"></i><b>7.3</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="starting-scripting-in-python.html"><a href="starting-scripting-in-python.html"><i class="fa fa-check"></i><b>8</b> Starting scripting in Python</a></li>
<li class="chapter" data-level="9" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>9</b> Loops</a>
<ul>
<li class="chapter" data-level="9.1" data-path="loops.html"><a href="loops.html#data-structure-recap"><i class="fa fa-check"></i><b>9.1</b> Data Structure Recap</a></li>
<li class="chapter" data-level="9.2" data-path="loops.html"><a href="loops.html#introduction-to-loops"><i class="fa fa-check"></i><b>9.2</b> Introduction To Loops</a></li>
<li class="chapter" data-level="9.3" data-path="loops.html"><a href="loops.html#for-loops"><i class="fa fa-check"></i><b>9.3</b> For Loops</a></li>
<li class="chapter" data-level="9.4" data-path="loops.html"><a href="loops.html#for-loop-example"><i class="fa fa-check"></i><b>9.4</b> For Loop Example</a></li>
<li class="chapter" data-level="9.5" data-path="loops.html"><a href="loops.html#while-loops"><i class="fa fa-check"></i><b>9.5</b> While loops</a></li>
<li class="chapter" data-level="9.6" data-path="loops.html"><a href="loops.html#further-control-statements"><i class="fa fa-check"></i><b>9.6</b> Further control statements</a></li>
<li class="chapter" data-level="9.7" data-path="loops.html"><a href="loops.html#recap-3"><i class="fa fa-check"></i><b>9.7</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reading-sequence-data.html"><a href="reading-sequence-data.html"><i class="fa fa-check"></i><b>10</b> Reading sequence data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="reading-sequence-data.html"><a href="reading-sequence-data.html#seqio"><i class="fa fa-check"></i><b>10.1</b> SeqIO</a></li>
<li class="chapter" data-level="10.2" data-path="reading-sequence-data.html"><a href="reading-sequence-data.html#reading-a-fastq-dna-data-file-into-python"><i class="fa fa-check"></i><b>10.2</b> Reading a FASTQ DNA data file into Python</a></li>
<li class="chapter" data-level="10.3" data-path="reading-sequence-data.html"><a href="reading-sequence-data.html#the-fastq-format"><i class="fa fa-check"></i><b>10.3</b> The FASTQ format</a></li>
<li class="chapter" data-level="10.4" data-path="reading-sequence-data.html"><a href="reading-sequence-data.html#read-a-fastq-file-into-python"><i class="fa fa-check"></i><b>10.4</b> Read a FASTQ file into Python</a></li>
<li class="chapter" data-level="10.5" data-path="reading-sequence-data.html"><a href="reading-sequence-data.html#setting-up-a-script-to-use-biopython"><i class="fa fa-check"></i><b>10.5</b> Setting up a script to use BioPython</a></li>
<li class="chapter" data-level="10.6" data-path="reading-sequence-data.html"><a href="reading-sequence-data.html#read-a-fie-of-sequence-data"><i class="fa fa-check"></i><b>10.6</b> Read a fie of sequence data</a></li>
<li class="chapter" data-level="10.7" data-path="reading-sequence-data.html"><a href="reading-sequence-data.html#modifying-reads"><i class="fa fa-check"></i><b>10.7</b> Modifying reads</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="conditions-and-calculations.html"><a href="conditions-and-calculations.html"><i class="fa fa-check"></i><b>11</b> Conditions and Calculations</a></li>
<li class="chapter" data-level="12" data-path="reading-and-writing-files.html"><a href="reading-and-writing-files.html"><i class="fa fa-check"></i><b>12</b> Reading and writing files</a>
<ul>
<li class="chapter" data-level="12.1" data-path="reading-and-writing-files.html"><a href="reading-and-writing-files.html#open"><i class="fa fa-check"></i><b>12.1</b> ‘open’</a></li>
<li class="chapter" data-level="12.2" data-path="reading-and-writing-files.html"><a href="reading-and-writing-files.html#with"><i class="fa fa-check"></i><b>12.2</b> ‘with’</a></li>
<li class="chapter" data-level="12.3" data-path="reading-and-writing-files.html"><a href="reading-and-writing-files.html#read-a-data-file"><i class="fa fa-check"></i><b>12.3</b> Read a data file</a></li>
<li class="chapter" data-level="12.4" data-path="reading-and-writing-files.html"><a href="reading-and-writing-files.html#write-data-file"><i class="fa fa-check"></i><b>12.4</b> Write data file</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Python for Bioinformatics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conditions-and-calculations" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">11</span> Conditions and Calculations<a href="conditions-and-calculations.html#conditions-and-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Suppose we want to filter the raw sequence reads by some parameter.
Within our loop we could calculate metrics such as the read length or the GC content.</p>
<p>Starting a new section at the bottom of you script, re-specify where SeqIO.parse should read the file. We need to do this because the SeqIO.parse object gets ‘consumed’ in the loop we built during the last section. To loop again, and do something else, we need to re-establish the SeqIO.parse connection.</p>
<pre><code>R_undulata_R1_data = SeqIO.parse(wd + &quot;data/Raja_undulata_WGS_trim_R1.fastq&quot;, &quot;fastq&quot;)</code></pre>
<p>Suppose we want to find and ultimately remove short reads from the data. As our loop moves through the file, we can count the number of nucleotides in each read using the Python function len().</p>
<pre><code>for record in R_undulata_R1_data:
  print(len(record.seq))</code></pre>
<p>We can see there is some size variation in the file and can use an <em>if</em> statement to select only those reads with a read length of &gt; 100 nucleotides.</p>
<p>Modify the loop above to the following:</p>
<pre><code># initialise an empty list to hold the records that we want to keep
wanted_sequences = []

for record in R_undulata_R1_data:
  #print(len(record.seq))
  if len(record.seq) &gt; 100:
    # add the record to the list of records we want to keep
    wanted_sequences.append(record)

print(&quot;Found &quot; + str(len(wanted_sequences)) + &quot; reads &gt;100bp in length.&quot;)</code></pre>
<p>We use the len() function again to see how many records are contained in the wanted_long_sequences list and print the results to the terminal.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="reading-sequence-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reading-and-writing-files.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
