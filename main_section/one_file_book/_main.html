<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Python for Bioinformatics" />
<meta property="og:type" content="book" />
<meta property="og:image" content="/figures/NEOF.png" />
<meta property="og:description" content="NEOF book for the Python for Bioinformatics workshop" />


<meta name="author" content="Graeme Fox &amp; Matthew R. Gemmell" />



<meta name="description" content="NEOF book for the Python for Bioinformatics workshop">

<title>Python for Bioinformatics</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<!--bookdown:toc:end-->
<!--bookdown:toc:start-->
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="header">
<h1 class="title">Python for Bioinformatics</h1>
<h4 class="author"><em>Graeme Fox &amp; Matthew R. Gemmell</em></h4>
<h4 class="date"><em>December, 2023</em></h4>
</div>
<center>
<img src="figures/NEOF_logo.png" style="width:30.0%" />
</center>



<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<center>
<img src="figures/python.png" style="width:30.0%" />
</center>
<p>Python is one of the most popular programming languages for bioinformatics and data analysis in general. It is a very flexible language with countless applications in the manipulation and processing of data files. This course is aimed at Python beginners and will give you transferable skills to manipulate your own data. The course will also provide you experience in Python modules tailored specifically for bioinformatics and genomics analyses.</p>
<p>Sessions will start with a brief presentation followed by self-paced computer practicals guided by an online interactive book. The book will contain theory, practice code, and exercises. Multiple choice questions will help reinforce what you have learnt throughout the book.</p>
<p>At the end of the course learners will be able to:</p>
<ul>
<li>Create, edit, run, and save python scripts with Jupyter-notebook.</li>
<li>Understand and use fundamental python concepts including operators, annotations, variables, and variable classes.</li>
<li>Utilise a variety of python functions and methods.</li>
<li>Store and manipulate data within lists, sets, and dictionaries.</li>
<li>Produce If and else statements to print out different results based on logical conditions (True or False).</li>
<li>Carry out the same task on multiple items with loops.</li>
<li>Read in and write out fastq files with the biopython library.</li>
<li>Filter sequences from fastq data.</li>
<li>Use logical operators to test multiple conditions at once.</li>
</ul>
<p>There are <a href="https://neof-workshops.github.io/Python_m4zqwb/Supplemental/">supplementary materials</a> including the use of the Pandas for table based data and Matplotlib for plot production. These can be run through after the course by the learner.</p>
<div id="table-of-contents" class="section level2 unnumbered">
<h2>Table of contents</h2>
<table class="table" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:center;">
<a href="#intro">Course Introduction</a>
</td>
<td style="text-align:center;">
<a href="#cluster">Working in the VNC</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#intro"><img src="figures/python.png" height="150" /></a>
</td>
<td style="text-align:center;">
<a href="#cluster"><img src="figures/cluster.png" height="150" /></a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#jupyter">Jupyer-notebook</a>
</td>
<td style="text-align:center;">
<a href="#scripting">Scripting in Python</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#jupyter"><img src="figures/jupyter_logo.png" height="150" /></a>
</td>
<td style="text-align:center;">
<a href="#scripting"><img src="figures/scripting_icon.png" height="150" /></a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#python_fundamentals">Python Fundamentals</a>
</td>
<td style="text-align:center;">
<a href="#functions_methods">Functions and methods</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#python_fundamentals"><img src="figures/python_fundamentals.png" height="150" /></a>
</td>
<td style="text-align:center;">
<a href="#functions_methods"><img src="figures/function.png" height="150" /></a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#data_structures">Data Structures</a>
</td>
<td style="text-align:center;">
<a href="#fundamental_exercise">Fundamental exercise</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#data_structures"><img src="figures/python_data_structure.png" height="150" /></a>
</td>
<td style="text-align:center;">
<a href="#fundamental_exercise"><img src="figures/Mimas%20tiliae.png" height="150" /></a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#python_conditions">Conditions (if and else statements)</a>
</td>
<td style="text-align:center;">
<a href="#loops">Loops</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#python_conditions"><img src="figures/python_condition.png" height="150" /></a>
</td>
<td style="text-align:center;">
<a href="#loops"><img src="figures/loopdeloo.png" height="150" /></a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#reading_seq_data">Working with DNA Sequence Data</a>
</td>
<td style="text-align:center;">
<a href="#modify_dna_data">Manipulating Sequence Data</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#reading_seq_data"><img src="figures/biopython_logo.png" height="150" /></a>
</td>
<td style="text-align:center;">
<a href="#modify_dna_data"><img src="figures/modify_dna.png" height="150" /></a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#reading_writing">Reading and Writing Files</a>
</td>
<td style="text-align:center;">
<a href="#logical_operators">Logical operators</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#reading_writing"><img src="figures/contract.png" height="150" /></a>
</td>
<td style="text-align:center;">
<a href="#logical_operators"><img src="figures/logic.png" height="150" /></a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#fundrecapexercise">Final exercises</a>
</td>
<td style="text-align:center;">
<a href="#further_resources">Appendix</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="#fundrecapexercise"><img src="figures/exercise_2.png" height="150" /></a>
</td>
<td style="text-align:center;">
<a href="#further_resources"><img src="figures/further_resources.png" height="150" /></a>
</td>
</tr>
</tbody>
</table>
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>

</div>
</div>
<div id="intro" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Python for bioinformatics</h1>
<center>
<img src="figures/python_logo.png" height="100" /> <img src="figures/biopython_logo.png" height="100" />
</center>
<p>This is a course to explore and learn the fundamentals of programming in the Python language with a specific focus on how this tool can be used in bioinformatics.</p>
<p><a href="https://www.python.org">Python</a> is a high level programming language enabling very rapid development of applications or scripts. It has a simple, easy-to-read syntax and is very accessible as a first or second programming language. Python has many pre-built modules and packages, allowing you to import lots of functionality, and avoid the need to “re-invent the wheel”.</p>
<p>Python is favoured by many programmers for the flexibility it affords and the speed at which it can be written.</p>
<p>This course assumes absolutely no Python experience or prior programming experience in any other language.</p>
<p>Over the next two days you will:</p>
<ul>
<li><strong>Learn</strong> the fundamental components of a Python script</li>
<li><strong>Discover</strong> how to write, edit and run a Python script</li>
<li><strong>Understand</strong> and use variables</li>
<li><strong>Understand</strong> and choose data structures</li>
<li><strong>Use</strong> control structure (conditions and loops)</li>
<li><strong>Learn</strong> string manipulation</li>
<li><strong>Read</strong> and manipulate DNA sequence data</li>
<li><strong>Be able to</strong> read input files and write output files</li>
<li><strong>Have a plan</strong> on what to do next to further your knowledge.</li>
</ul>
<p>We will cover the theory behind Python concepts and terminology. Python code is designed to be human-readable and understanding the underlying processes is important. There will be lots of opportunity to practice writing Python. Practice will involve typing and running Python code whilst working through the workshop materials. This will allow you to see the output of Python commands and help you to understand how Python works.</p>
<div id="materials-covered-in-the-course" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Materials Covered in the Course</h2>
<center>
<img src="figures/materials.png" style="width:15.0%" />
</center>
<p>After learning some of the basics of Python we will import some DNA sequence data and perform some common types of analyses. The focus is on learning the theory and the ways in which Python can be used, rather than the specifics of the analysis. Hopefully you will take away new skills that can be applied to your own data.</p>
<p>In the supplementary material, we import and work with a different form of data often encountered by biologists; the comma delimited file.</p>
</div>
<div id="inputting-commands" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Inputting Commands</h2>
<p>Commands are in the following font and colour and should be run in the VNC window following the link provided to you by the course coordinators. (Do not try to run the following, however.)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>    This <span class="kw">is</span> an example of a command.</span></code></pre></div>
</div>
<div id="pseudocode" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Pseudocode</h2>
<center>
<img src="figures/noun-cherry-cake-5973.png" style="width:15.0%" />
</center>
<p>Sometimes to illustrate how a concept works, we will illustrate it with some <b>pseudocode</b>. This is a way of representing a concept in simple terms that can be understood without knowing the correct programming terminology or syntax.</p>
<p>Do not try to run the pseudocode as Python will not understand it.</p>

</div>
</div>
<div id="cluster" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Cluster Introduction</h1>
<center>
<img src="figures/cluster.png" style="width:25.0%" />
</center>
<div id="logon-instructions" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Logon Instructions</h2>
<p>For this workshop we will be using Virtual Network Computing (VNC).
Connect to the VNC with a browser by using the webVNC link you were sent.</p>
You will now be in a logged-in Linux VNC desktop with a terminal window visible.
You will see something as below.
<center>
<img src="figures/logon_pic.png" style="width:75.0%" />
</center>
<p>If you do not see something similar please ask for assistance.</p>
<p>If the VNC is taking up too much/little space of your browser you can use the zoom of your browser to adjust the size. Ensure you can see one whole terminal.</p>
</div>
<div id="the-terminal-window" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> The Terminal Window</h2>
<p>In our case the terminal window looks like the picture below. We are using the terminal window as our shell to interpret our commands to the kernel. Depending on your system and preferences it may look different.</p>
<center>
<img src="figures/terminal_window.png" style="width:75.0%" />
</center>
<p>You’re now ready to start the workshop!</p>
</div>
<div id="load-workshop-data" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Load workshop data</h2>
<p>Before we get started, we need to copy across some data files to analyse later in the workshop.</p>
<p>In the terminal window, issue the following commands to copy the data into your account:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">cd</span> ~</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">cp</span> <span class="at">-r</span> /pub14/tea/nsc206/NEOF/Python_course_data .</span></code></pre></div>
</div>
<div id="mamba" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Mamba</h2>
<p><img src="figures/mamba_logo.png" width="20%" style="display: block; margin: auto;" /></p>
<p>This workshop requires some programs.
These can be difficult to install.
Instead we have used Mambaforge to install the programs including Jupyter-notebook.
To learn more about Mambaforge and how to create your own environment please see the <a href="#mamba_install">appendix</a>.</p>
<p>To set-up your environment for this workshop please run the following code (you must include the full stop and space at the front of the command).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">.</span> usepython</span></code></pre></div>
<p>You will have successfully activated the environment if you now see <code>(python)</code> at the start of your command prompt.
This indicates you are now in the mamba environment called <code>python</code> created by the instructor.</p>
<p>If you are interested in the use script you can look at its contents.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">less</span> /usr/local/bin/usepython</span></code></pre></div>
<p><strong>Tip:</strong> press <code>q</code> to quit <code>less</code>.</p>
<p>For more about mamba and how to create your own <code>python</code> environment please see the <a href="#mamba_install">appendix</a></p>

</div>
</div>
<div id="jupyter" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Jupyter</h1>
<p><img src="figures/jupyter_logo.png" width="20%" style="display: block; margin: auto;" /></p>
<p><a href="https://jupyter.org/"><code>Jupyter-notebook</code></a> is a nice browser based method to write, edit, and run code. It was initially created for Python coding, but has since branched out to many other languages, such as <code>R</code>.</p>
<p>We are using it in this workshop for a variety of its properties:</p>
<ul>
<li>It is popular and well maintained.</li>
<li>It is lightweight. Other heavier weight programs would struggle in our HPC due to the graphical and CPU load.</li>
<li>It is interactive and displays code output.</li>
<li>It allows for easier annotation, editing, and debugging than the command line.</li>
<li>It provides a graphical interface for changing directories and choosing files.</li>
</ul>
<p>Before carrying out any analysis we will go through a quick tutorial of <code>jupyter-notebook</code>.</p>
<div id="open-jupyter-notebook" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Open Jupyter-notebook</h2>
<p>The first step is to open <code>jupyter-notebook</code>. Run the below command in your <code>(python)</code> environment.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">jupyter-notebook</span></span></code></pre></div>
<p>This will open <code>jupyter-notebook</code> in firefox. We won’t need to access the linux terminal in this book anymore. Leave the terminal running <code>jupyter-notebook</code> and full screen your <code>firefox</code> so you should see something like below.</p>
<div class="webex-solution">
<button>
Can’t see the whole webVNC window?
</button>
<p>You may need to zoom out with your browser so you can see the full webVNC window.</p>
<ul>
<li><strong>Chrome</strong>: Click on the <strong>three dots in vertical line</strong> (
<svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <circle cx="256" cy="256" r="48"></circle> <circle cx="256" cy="416" r="48"></circle> <circle cx="256" cy="96" r="48"></circle></svg>
) on the top left for a dropdown menu which includes zoom options.</li>
<li><strong>Edge</strong>: Click on the <strong>three horizontal lines</strong> (
<svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <circle cx="256" cy="256" r="48"></circle> <circle cx="416" cy="256" r="48"></circle> <circle cx="96" cy="256" r="48"></circle></svg>
) on the top left for a dropdown menu which includes zoom options.</li>
<li><strong>Firefox</strong>: Click on the <strong>three dots in horizontal line</strong> (
<svg viewBox="0 0 448 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg>
) on the top left for a dropdown menu which includes zoom options.</li>
</ul>
</div>
<p><img src="figures/jupyter_notebook_example_1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="changing-directories" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Changing directories</h2>
<p>To move around the directories you can click on directory names.</p>
<p>Click on <strong>“Python_course_data”</strong> to move into that directory. You will then see the below showing the files in the directory.</p>
<p><img src="figures/jupyter_notebook_example_files.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="create-notebook" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Create notebook</h2>
<p>The next step is to create a python notebook.</p>
<ol style="list-style-type: decimal">
<li>Click on the <strong>“New”</strong> button towards the top right, right of the “Upload” button.</li>
<li>From the dropdown click <strong>Python 3 (ipykernel)</strong>.</li>
</ol>
<p>This will open up a new Python notebook like below.</p>
<p><img src="figures/jupyter_notebook_example_2.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="cells-and-code" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Cells and code</h2>
<p><code>Jupyter-notebook</code> uses <strong>cells</strong> (the gray boxes) to separate code. This is very useful to compartmentalise our code.</p>
<p>There will already be one <strong>cell</strong>. Within the <strong>cell</strong>, type in the below commands.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="dv">1</span><span class="op">+</span><span class="dv">1</span></span></code></pre></div>
<p>When pressing enter in <strong>cells</strong> it will create a new line. To run all commands in a <strong>cell</strong> press <code>CTRL + enter</code>.</p>
<p>Run your current <strong>cell</strong> and you should see something like below.</p>
<p><img src="figures/jupyter_notebook_example_3.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="create-new-cells" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Create new cells</h2>
<p>You can create new <strong>cells</strong> by 2 different means.</p>
<ul>
<li>Press the <code>+</code> button on the tool bar (between the floppy disk <svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M380.93,57.37A32,32,0,0,0,358.3,48H94.22A46.21,46.21,0,0,0,48,94.22V417.78A46.21,46.21,0,0,0,94.22,464H417.78A46.36,46.36,0,0,0,464,417.78V153.7a32,32,0,0,0-9.37-22.63ZM256,416a64,64,0,1,1,64-64A63.92,63.92,0,0,1,256,416Zm48-224H112a16,16,0,0,1-16-16V112a16,16,0,0,1,16-16H304a16,16,0,0,1,16,16v64A16,16,0,0,1,304,192Z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></path></svg> and scissors <svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M103.48,224a71.64,71.64,0,0,0,44.76-15.66l41.5,16.89,6.82-12.63a39.15,39.15,0,0,1,4.32-6.37l14.22-14.42-41.17-24.94A72,72,0,1,0,103.48,224Zm0-112a40,40,0,1,1-40,40A40,40,0,0,1,103.48,112Z"></path> <path d="M480,169l-5.52-12.58c-4.48-10.42-14.74-16-32.78-17.85-10.12-1-26.95-1.24-49.69,3.81-20,4.45-122.14,28.2-164.95,58.62C206.81,215.39,203,234.67,200,250.16c-2.78,14.14-5,25.31-18,35-15,11.14-27.27,16.38-33.58,18.6a71.74,71.74,0,1,0,24.79,38ZM255.48,256a16,16,0,1,1,16-16A16,16,0,0,1,255.48,256Zm-152,144a40,40,0,1,1,40-40A40,40,0,0,1,103.48,400Z"></path> <path d="M343.79,259.87l-83.74,48.18,27.63,13.08,3.62,1.74C310,331.92,359.74,356,410.53,359c3.89.23,7.47.34,10.78.34C442,359.31,453,354,459.75,350L480,336Z"></path></svg>). This will add a <strong>cell</strong> below your currently selected <strong>cell</strong>.</li>
<li>Click on the <strong><code>Insert</code></strong> button and use the dropdown to add a cell above or below your currently selected cell.</li>
</ul>
<p><strong>Tip:</strong> Hover over the toolbar icons to display a text based description of its function.</p>
<p>With that knowledge add a second <strong>cell</strong> below the first <strong>cell</strong>. Add the following code to your second <strong>cell</strong> but do not run it.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>num_1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>num_2 <span class="op">=</span> <span class="dv">10</span></span></code></pre></div>
<p><strong>Tip:</strong> Notice there are green lines around your selected cell.</p>
<p>Insert a third <strong>cell</strong> and add the following code to it. Do not run the code.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>num_1 <span class="op">*</span> num_2</span></code></pre></div>
</div>
<div id="running-code" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Running code</h2>
<p>Try to run the code in the third <strong>cell</strong>. There should be an error as we have not created the objects <code>num_1</code> &amp; <code>num_2</code>. We have only written the code for these objects but not run them.</p>
<p>We can run all the code in a notebook starting from the first <strong>cell</strong> to the last <strong>cell</strong>.</p>
<p>To run all <strong>cells</strong> from the start:</p>
<ul>
<li>Click on the <strong>“Cell”</strong> button.</li>
<li>Click <strong>“Run All”</strong> from the drop-down options.</li>
</ul>
<p>You should then see something like the below in your notebook.</p>
<p><img src="figures/jupyter_notebook_example_4.png" width="100%" style="display: block; margin: auto;" /></p>
<p>There is no output printed for <strong>cell</strong> 2 because we are assigning variables. However, the correct output for Cell 3 is below it. This is because the variables were assigned in <strong>cell</strong> 2 before <strong>cell</strong> 3 was run.</p>
</div>
<div id="saving-the-file" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Saving the file</h2>
<p><img src="figures/r_save.png" width="10%" style="display: block; margin: auto;" /></p>
<p>As with many good coding interfaces we can save our notebook.</p>
<p>First we should rename the file. Rename the notebook to <strong>“jupyter_tut”</strong>:</p>
<ol style="list-style-type: decimal">
<li>Click on the name of the notebook, currently called <strong>“Untitled”</strong>.
<ul>
<li>This is at the very top of the notebook, right of the Jupyter logo.</li>
</ul></li>
<li>A pop-up called <strong>“Rename Notebook”</strong> will appear. Change the Name to <strong>“jupyter_tut”</strong>.</li>
<li>Click <strong>“Rename”</strong>.</li>
</ol>
<p>Now we can save the file. Two methods to save are:</p>
<ul>
<li>Click the floppy disk <svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M380.93,57.37A32,32,0,0,0,358.3,48H94.22A46.21,46.21,0,0,0,48,94.22V417.78A46.21,46.21,0,0,0,94.22,464H417.78A46.36,46.36,0,0,0,464,417.78V153.7a32,32,0,0,0-9.37-22.63ZM256,416a64,64,0,1,1,64-64A63.92,63.92,0,0,1,256,416Zm48-224H112a16,16,0,0,1-16-16V112a16,16,0,0,1,16-16H304a16,16,0,0,1,16,16v64A16,16,0,0,1,304,192Z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></path></svg> on the toolbar.</li>
<li>Click on the <strong>“File”</strong> button. Click <strong>“Save and Checkpoint”</strong> from the dropdown options.</li>
</ul>
</div>
<div id="title-cells-with-markdown" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Title cells with markdown</h2>
<p>We will be using multiple notebooks in this workshop. We will also have multiple sections per notebook. It will be useful to create header cells with markdown to create visual separation of the different sections.</p>
<p>To add a header <strong>cell</strong> to the top of our notebook:</p>
<ul>
<li>Create a new <strong>cell</strong> at the top of the notebook.</li>
<li>Click on the <strong>“Code”</strong> drop down and select the <strong>“Markdown”</strong> option.
<ul>
<li>Do not choose the <strong>“Heading”</strong> option as it no longer works.</li>
</ul></li>
</ul>
<p><img src="figures/jupyter_notebook_example_5.png" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li>Add the following to the <strong>“Markdown”</strong> cell to create a first level header.
<ul>
<li>Ensure you have a space between the <code>#</code> and header text (“Tutorial”).</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Tutorial</span></span></code></pre></div>
<p>Great, we can now add nice headers in our notebooks. <strong>Save</strong> the notebook once more before carrying on to the next section.</p>
<div class="webex-solution">
<button>
Markdown
</button>
<p>You won’t need to know more about <code>Markdown</code> but if you are interested please see the <a href="https://www.markdownguide.org/basic-syntax/"><code>Markdown</code> guide</a>.</p>
</div>
</div>
<div id="close-the-notebook" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Close the notebook</h2>
<p>To close the notebook:</p>
<ul>
<li>Click on <strong>“File”</strong>.</li>
<li>From the dropdown options click <strong>“Close and Halt”</strong>.</li>
</ul>
<p>When you are back in the file explorer page you may not yet see the new file you saved. If so, you will need to refresh the page with the Refresh button <svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M320,146s24.36-12-64-12A160,160,0,1,0,416,294" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"></path> <polyline points="256 58 336 138 256 218" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></polyline></svg> towards the top right.</p>
<p><img src="figures/jupyter_notebook_refresh.png" width="100%" style="display: block; margin: auto;" /></p>
<p>With that quick tutorial of <code>jupyter-notebook</code> we can start our community analysis in the next chapter.</p>
<p>For more info on <code>jupter-notebook</code> please see the <a href="#jupyter_appendix">appendix</a>.</p>
</div>
<div id="video-tutorial" class="section level2" number="4.10">
<h2><span class="header-section-number">4.10</span> Video tutorial</h2>
<div class="container">
<iframe src="https://www.youtube.com/embed/2jqOdreD1c4" frameborder="0" allowfullscreen class="video">
</iframe>
</div>

</div>
</div>



<div id="scripting" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Scripting in Python</h1>
<center>
<img src="figures/python_logo.png" height="150" /><img src="figures/scripting_icon.png" height="150" />
</center>
<div id="introduction-to-commands-and-scripts" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction to commands and scripts</h2>
<p>There are two important components to programming in <strong>Python</strong>; the commands that are committed by the user, and the interpreter which receives and implements the commands.</p>
<p>Each command can be thought of as a single instruction and these can be added together into a series of steps, called a script.
Think about how a cooking recipe is often presented:</p>
<ol style="list-style-type: decimal">
<li>Break a few eggs</li>
<li>Make an omelette</li>
</ol>
<p>These are two distinct <em>commands</em>, but together they form a <em>script</em> for how to transform raw eggs into an omelette.</p>
</div>
<div id="issuing-commands" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Issuing commands</h2>
<center>
<img src="figures/translator.png" style="width:15.0%" />
</center>
<p>In this section we will learn and use some <strong>Python</strong> commands.</p>
<p>Create a new <strong>notebook</strong> in your <strong>“Python_course_data”</strong> directory. Rename it to <strong>“01-Fundamentals”</strong> and save it.</p>
<p>Convert the first <strong>cell</strong> to a <strong>Markdown cell</strong>. Add the following to the cell to create a 1st and 2nd level header.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># 1-Fundamentals</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">## Scripting</span></span></code></pre></div>
<div id="print" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Print</h3>
<p><img src="figures/printer.png" width="10%" style="display: block; margin: auto;" /></p>
<p>The first command we will use is <code>print()</code>. This will print the desired text. Type and run the below commands in 2 new <strong>Code cells</strong>.</p>
<p><strong>Note</strong>: Python is very particular about braces/brackets and quote marks.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Hello, world!&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;I&#39;m excited to be learning some Python!&quot;</span>)</span></code></pre></div>
<p>Below each cell you will see the specified text.</p>
</div>
<div id="working-directory" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Working directory</h3>
<p><img src="figures/directory.png" width="10%" style="display: block; margin: auto;" /></p>
<p>The command <code>getcwd()</code> stands for “get the <em>current working directory</em>”. This command comes from the <strong>Python module</strong> <code>os</code>. We therefore need to <code>import</code> the module and specify it when running the command (<code>os.getcwd()</code>).</p>
<p>Run the below in a new cell.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>os.getcwd()</span></code></pre></div>
<p>This will return something like: ‘/pub14/tea/nsc206/Python_course_data’ (your nsc number will be different though).</p>
<p><code>print()</code> and <code>os.getcwd()</code> are nice commands to start with but don’t appear very useful, yet. We will see later how they can be used effectively.</p>
</div>
</div>
<div id="a-note-on-indentation" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> A note on indentation</h2>
<p><img src="figures/tab.png" width="10%" style="display: block; margin: auto;" /></p>
<p><strong>Indentation</strong> refers to any <strong>spaces</strong> or <strong>tab</strong> characters at the beginning of a line of code.
<strong>Indentation</strong> helps readability of code.
It defines code blocks dedicated to a single purpose.
However, <strong>indentation</strong> in <strong>Python</strong> is <strong>mandatory</strong> and the interpreter will give an error if the <strong>indentation</strong> is wrong.</p>
<p><code>Jupyter-notebook</code> attempts to <em>auto</em> indent code.
However, you still need to take care that the level of indentation in the script matches that in the workbook <strong>exactly</strong>.</p>
<div id="tabs-vs-spaces" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Tabs vs spaces</h3>
<p><img src="figures/indent_python_debate.png" width="15%" style="display: block; margin: auto;" /></p>
<p>There is an active debate about whether tabs or spaces are more appropriate for <strong>indentation</strong>.</p>
<p>For reference, one tab = 4 spaces.</p>
<p>You can use either tabs or spaces, but you cannot use them interchangeably! Use one and keep consistent with your use.</p>
<p>Do not enter the below, this is just an illustration of how three levels of tab <strong>indentation</strong> looks in a script.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Zero level of indentation</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="co"># One level of indentation</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="co"># Two levels of identation</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># Zero level of indentation</span></span></code></pre></div>
</div>
</div>
<div id="scripting-recap-mcqs" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Scripting recap MCQs</h2>
<p><img src="figures/question_bubble_black.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Wonderful! That is the end of the scripting chapter. Now time for some reinforcement.</p>
<p>Choose the correct option to complete the below sentences:</p>
<ol style="list-style-type: decimal">
<li>The command ________ gets your current working directory.
<div id="radio_JMPQGTHYJB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_JMPQGTHYJB" value="answer"></input> <span><strong><code>getcwd()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_JMPQGTHYJB" value=""></input> <span><strong><code>os</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_JMPQGTHYJB" value=""></input> <span><strong><code>print()</code></strong></span></label>
</div></li>
<li>The command ________ prints text.
<div id="radio_RWOZORWMHH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RWOZORWMHH" value=""></input> <span><strong><code>getcwd()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_RWOZORWMHH" value=""></input> <span><strong><code>os</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_RWOZORWMHH" value="answer"></input> <span><strong><code>print()</code></strong></span></label>
</div></li>
<li>The module ________ is needed for the <code>getcwd()</code> command.
<div id="radio_WSKBZFIVCL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WSKBZFIVCL" value=""></input> <span><strong><code>getcwd()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_WSKBZFIVCL" value="answer"></input> <span><strong><code>os</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_WSKBZFIVCL" value=""></input> <span><strong><code>print()</code></strong></span></label>
</div></li>
<li>________ can be used for <strong>indentation</strong> in <strong>Python</strong>.
<div id="radio_GQRROKKDLD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GQRROKKDLD" value=""></input> <span><strong>Tabs</strong></span></label><label><input type="radio" autocomplete="off" name="radio_GQRROKKDLD" value=""></input> <span><strong>Spaces</strong></span></label><label><input type="radio" autocomplete="off" name="radio_GQRROKKDLD" value="answer"></input> <span><strong>Tabs or Spaces</strong></span></label>
</div></li>
</ol>

</div>
</div>
<div id="python_fundamentals" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Python Fundamentals</h1>
<p><img src="figures/python_fundamentals.png" width="15%" style="display: block; margin: auto;" /></p>
<p>This chapter covers some of the fundamental concepts of scripting in Python.
An understanding of how to use <strong>operators</strong>, <strong>variables</strong>, and <strong>functions</strong> will
give a good grounding in how the language works and allow you to develop
your own methods and code.</p>
<p>You definitely do not need to memorise all the information here as all of these
concepts will be explored more in the rest of the tutorial. The best way to
learn how various aspects of the Python language works is by <em>doing</em> rather
than by <em>reading</em>.</p>
<p>Consider
coming back to this page later if you want to remind yourself of how a
particular operator works or how to define a <strong>function</strong>.</p>
<p>We’ll continue to use our <strong>“01-Fundamentals”</strong> notebook.
Within it create a new <strong>Markdown</strong> cell with the following headers:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co">## Fundamentals</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">### Operators</span></span></code></pre></div>
<div id="operators" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Operators</h2>
<p><img src="figures/bodmas_ribbon.png" width="65%" style="display: block; margin: auto;" /></p>
<p>Python allows the use of the usual arithmetic <strong>operators</strong> and follows the traditional rules of mathematical precedence (BODMAS).</p>
<p>The main mathematical operators are:</p>
<ul>
<li><strong><code>+</code></strong> (addition)</li>
<li><strong><code>-</code></strong> (subtraction)</li>
<li><strong><code>*</code></strong> (multiplication)</li>
<li><strong><code>/</code></strong> (division)</li>
<li><strong><code>**</code></strong> (power/exponent)</li>
<li><strong><code>//</code></strong> (Floor division)</li>
<li><strong><code>%</code></strong> (modulo operator. Find the remainder after dividing 2 numbers)</li>
</ul>
<p>For each code block below create a <strong>code cell</strong>, enter the code, and run it.
This will demonstrate the code output and give you some practice.</p>
<div class="webex-solution">
<button>
Moving across cells in jupyter-notebook
</button>
<p>For convenience you can can create a bunch of empty cells and then use the up and down arrow keys to move to other cells.
This requires knowing the two different interaction modes.</p>
<ul>
<li><strong>esc mode</strong>: This mode allows you to move up and down between cells. You are in <strong>esc mode</strong> if the highlighted border of your current cell is blue (leftside) and grey.
<img src="figures/jupyter_esc_mode_cell.png" width="95%" style="display: block; margin: auto;" /></li>
<li><strong>command mode</strong>: This mode allows you to type in the cell. You are in <strong>command mode</strong> if the highlighted border of your current cell is green.
<img src="figures/jupyter_command_mode_cell.png" width="95%" style="display: block; margin: auto;" /></li>
</ul>
<p>Press <strong>enter</strong> when on a cell in <strong>esc mode</strong> to enter <strong>command mode</strong>. This allows you to start typing in the selected cell.</p>
<p>When you run code (ctrl + enter) in <strong>command mode</strong> you will then enter <strong>esc mode</strong>.</p>
<p>Be careful! If you press a number key whilst in <strong>esc mode</strong> you will change the cell to a <strong>markdown cell</strong>. Additionally, you will change the first line to a header line equal to the number you pressed. I.e. if you pressed 2, the following would be added to the start of the first line of the cell: <code>##</code>.</p>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="dv">9</span><span class="op">-</span><span class="dv">6</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="dv">3</span><span class="op">*</span><span class="dv">4</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="dv">42</span><span class="op">/</span><span class="dv">7</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="dv">45</span><span class="op">/</span><span class="dv">7</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="dv">3</span><span class="op">**</span><span class="dv">3</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="dv">42</span><span class="op">//</span><span class="dv">7</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="dv">45</span><span class="op">//</span><span class="dv">7</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="dv">45</span><span class="op">%</span><span class="dv">7</span></span></code></pre></div>
</div>
<div id="commentsannotations" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Comments/Annotations</h2>
<p><img src="figures/hashtag2.png" width="15%" style="display: block; margin: auto;" /></p>
<p>It is often useful to include human-readable <strong>comments</strong> in your scripts and code.
<strong>Comments/Annotations</strong> in Python are indicated by the hash symbol (<code>#</code>).
Anything to the right of the hash is considered a <strong>comment</strong> and is ignored by the interpreter.</p>
<p>Create a new <strong>Markdown cell</strong> with the following.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co">### Annotation</span></span></code></pre></div>
<p>In a new <strong>cell</strong>, enter and run the below.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># This line is a comment</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;This section will print&quot;</span>) <span class="co"># This section is ignored</span></span></code></pre></div>
<p>Only the <code>print()</code> command is used by the python interpreter.
The other text is ignored due to the hashtags.
You will also notice that the text of <strong>comments/annotations</strong> are uniquely coloured in <code>jupyter-notebook</code>.
This is useful to quickly see what are parts of <strong>comments</strong> and not.</p>
</div>
<div id="variables" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Variables</h2>
<p><img src="figures/cargo_container.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>Variables</strong> are used to store information which can then be referenced or manipulated later.
It is useful to label data with descriptive names which are easily read by humans.
You can think of a <strong>variable</strong> as a ‘container’ to hold a piece of information.</p>
<p><strong>Variables</strong> are assigned a value using the equals (<code>=</code>) character.</p>
<p><strong>Variable name rules</strong>:</p>
<ul>
<li>Must start with either a letter or an underscore
<ul>
<li>Cannot start with a number.</li>
</ul></li>
<li>Must only contain alphanumeric characters (and underscores)
<ul>
<li>No punctuation such as full stops, quotes, commas, colons, etc are allowed.</li>
</ul></li>
<li>They are case sensitive.</li>
</ul>
<p>Python supports several classes (or types) of <strong>variables</strong> including <strong>strings</strong>, <strong>integers</strong>, <strong>floats</strong>, and <strong>booleans</strong>.</p>
<p>In a new <strong>Markdown cell</strong> add the following:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co">### Variables</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co">#### Strings</span></span></code></pre></div>
<div id="strings" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Strings</h3>
<p><img src="figures/string_bubble.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>Strings</strong> are used to store alphanumeric text. A <strong>string</strong> is defined by enclosing the text with either single (<code>'text'</code>) or double quotes (<code>"text"</code>).</p>
<p>In the below code we define two <strong>string variables</strong>, and then retrieve them again by using their name, or identifier.</p>
<p>As before, for each code block below create a <strong>code cell</strong>, enter the code, and run it.
Do this for all future code examples.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co">#Assign string variables</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>DNA_string <span class="op">=</span> <span class="st">&quot;GCACAAACC&quot;</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>amino_acids <span class="op">=</span> <span class="st">&quot;ARG VAL TRP&quot;</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co">#Call the DNA_string variable</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>DNA_string</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co">#Call the amino_acids string variable</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>amino_acids</span></code></pre></div>
<p>You will notice that you can use your <strong>variables</strong> in the same <strong>cell</strong> you created it in, or in a different <strong>cell</strong>.
As long as you have run the code that creates/assigns the <strong>variable</strong> you can use it elsewhere in the same notebook.</p>
</div>
<div id="integers" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Integers</h3>
<p><img src="figures/noun-seven-3801475.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>Integers</strong> are used to store whole numbers.
These should not be declared with quote marks otherwise they will be stored as a string.</p>
<p>Create the following <strong>markdown cell</strong>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co">#### Integers</span></span></code></pre></div>
<p>Create and run the following <strong>code cells</strong>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co">#Roman numeral letters</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>I <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>V <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>X <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>C <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>D <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>M <span class="op">=</span> <span class="dv">1000</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>I</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>X</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co">#7</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>VII <span class="op">=</span> V <span class="op">+</span> (I <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>VII</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co">#67</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>LXVII <span class="op">=</span> L <span class="op">+</span> X <span class="op">+</span> VII</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>LXVII</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co">#44</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>XLIV <span class="op">=</span> (L <span class="op">-</span> X) <span class="op">+</span> (V <span class="op">-</span> I)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>XLIV</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co">#2023</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>MMXXIII <span class="op">=</span> (M <span class="op">*</span> <span class="dv">2</span>) <span class="op">+</span> (X <span class="op">*</span> <span class="dv">2</span>) <span class="op">+</span> (I <span class="op">*</span> <span class="dv">3</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>MMXXIII</span></code></pre></div>
</div>
<div id="floats-floating-point-numbers" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Floats (floating point numbers)</h3>
<p><img src="figures/float.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>Floating point numbers</strong> are used to store real numbers (I.e. a number written with a decimal point dividing the integer and the fractional parts).</p>
<p>Create a new <strong>markdown cell</strong> with the following:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co">#### Floats</span></span></code></pre></div>
<p>Run the following code:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>my_float <span class="op">=</span> <span class="fl">7.0001</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>another_float <span class="op">=</span> <span class="fl">345.765</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>yet_another_float <span class="op">=</span> <span class="op">-</span><span class="fl">5.423e+19</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>my_float</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>another_float</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>yet_another_float</span></code></pre></div>
</div>
<div id="booleans" class="section level3" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Booleans</h3>
<p><img src="figures/true_or_false.png" width="20%" style="display: block; margin: auto;" /></p>
<p><strong>Booleans</strong> are a special type of variable that can represent one of
two values: <strong>True</strong> or <strong>False</strong>.
You can compare any two values in Python and get a result of either <strong>True</strong> or <strong>False</strong>.</p>
<ul>
<li>To check if two values are equal we use double equals: <code>==</code></li>
<li>To check if two values are not equal we use: <code>!=</code></li>
<li>Greater than (<code>&gt;</code>) or less than (<code>&lt;</code>) also work.</li>
</ul>
<p>Create a new <strong>markdown cell</strong> with the following:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co">#### Booleans</span></span></code></pre></div>
<p>Run the following code:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="dv">1</span> <span class="op">==</span> <span class="dv">1</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="dv">1</span> <span class="op">==</span> <span class="dv">2</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="dv">2</span> <span class="op">==</span> <span class="dv">17</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="dv">2</span> <span class="op">!=</span> <span class="dv">17</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>(<span class="dv">10</span> <span class="op">*</span> <span class="dv">2</span>) <span class="op">&lt;</span> <span class="dv">30</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>(<span class="dv">10</span> <span class="op">*</span> <span class="dv">30</span>) <span class="op">&gt;</span> <span class="dv">20</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co">#Use one of our previously created integer variables</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>a_bool <span class="op">=</span> X <span class="op">&gt;</span> <span class="dv">4</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>a_bool</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co">#Check if 2 string variables are identical</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="co">#Cannot use &gt; or &lt; with strings</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>another_bool <span class="op">=</span> DNA_string <span class="op">==</span> amino_acids</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>another_bool</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co">#Can compare if boolean variables are identical</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>yet_another_bool <span class="op">=</span> a_bool <span class="op">==</span> another_bool</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>yet_another_bool</span></code></pre></div>
</div>
</div>
<div id="classes-of-variable" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Classes of variable</h2>
<p><img src="figures/class.png" width="20%" style="display: block; margin: auto;" /></p>
<p>Every <strong>variable</strong> in Python has a <strong>class</strong>. These are the characteristics we described above:</p>
<ul>
<li><strong>String</strong> (<code>&lt;class 'str'&gt;</code>)</li>
<li><strong>Integer</strong> (<code>&lt;class 'int'&gt;</code>)</li>
<li><strong>Float</strong> (<code>&lt;class 'float'&gt;</code>)</li>
<li><strong>Boolean</strong> (<code>&lt;class 'bool'&gt;</code>)</li>
</ul>
<p>Unlike some other languages, you do not need to tell Python which <strong>class</strong> a <strong>variable</strong> should have.
Python will try to figure it out based on the value assigned.</p>
<p>Create a new <strong>markdown cell</strong> with the following:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co">### Classes</span></span></code></pre></div>
<p>You can check the <strong>class</strong> of a <strong>variable</strong> by passing it to the <code>type()</code> <strong>function</strong>:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>variable1 <span class="op">=</span> <span class="st">&quot;a piece of text&quot;</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="bu">type</span>(variable1)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>variable2 <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="bu">type</span>(variable2)</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>variable3 <span class="op">=</span> <span class="fl">7.0001</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="bu">type</span>(variable3)</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>variable4 <span class="op">=</span> <span class="va">True</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="bu">type</span>(variable4)</span></code></pre></div>
</div>
<div id="transforming-variables" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Transforming variables</h2>
<p><img src="figures/transform.png" width="20%" style="display: block; margin: auto;" /></p>
<p><strong>Variables</strong> can be transformed from one <strong>class/type</strong> to another provided the value can be coerced into the new data type (I.e. you could not transform a <strong>string</strong> of text to a <strong>floating point number</strong>).</p>
<p>Create a new <strong>markdown cell</strong> with the following:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="co">### Transforming variables</span></span></code></pre></div>
<p>To transform a <strong>float</strong> to an <strong>integer</strong> use the <code>int()</code> <strong>function</strong> (note the loss of precision):</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>a_float <span class="op">=</span> <span class="fl">17.45</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="bu">int</span>(a_float)</span></code></pre></div>
<p>To transform an <strong>integer</strong> to a <strong>string</strong> use the <code>str()</code> <strong>function</strong>:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>an_integer <span class="op">=</span> <span class="dv">783473</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="bu">str</span>(an_integer)</span></code></pre></div>
<p>You can transform a numeric <strong>string</strong> to an <strong>integer</strong>:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>a_numeric_string <span class="op">=</span> <span class="st">&quot;256&quot;</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a><span class="bu">int</span>(a_numeric_string)</span></code></pre></div>
<p>You can also transform to a <strong>floating point</strong> using <code>float()</code>:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>a_float_string <span class="op">=</span> <span class="st">&quot;3.14&quot;</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="bu">float</span>(a_float_string)</span></code></pre></div>
</div>
<div id="why-so-many-code-cells" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Why so many code cells?</h2>
<p><img src="figures/cells.png" width="15%" style="display: block; margin: auto;" /></p>
<p>We are using a <strong>code cell</strong> per piece of code that gives an output. We do this as <code>jupyter-notebook</code> will normally only show the last output from a <strong>code cell</strong>.</p>
<p>Create and run the below <strong>code cells</strong> to see this in action.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="dv">1</span><span class="op">+</span><span class="dv">1</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="dv">2</span><span class="op">+</span><span class="dv">2</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="dv">1</span> <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="dv">2</span> <span class="op">&gt;</span> <span class="dv">4</span></span></code></pre></div>
<p>However, you can use the <code>print()</code> function to bypass this.
The output from every single <code>print()</code> function will be printed in <code>jupyter-notebook</code>.</p>
<p>Try it out with the below single <strong>code cell</strong>:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">1</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">2</span><span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">1</span> <span class="op">==</span> <span class="dv">1</span>)</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">2</span> <span class="op">&gt;</span> <span class="dv">4</span>)</span></code></pre></div>
<p>This is essential when writing longer pieces of code that need multiple outputs.
In this book we will stick with the multiple <strong>code cells</strong> approach as we find it easier than having to use <code>print()</code> constantly.
However, if you prefer using fewer <strong>code cells</strong> and more <code>print()</code> <strong>functions</strong> please feel free to do so.</p>
</div>
<div id="fundamentals-mcq-recap" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Fundamentals MCQ recap</h2>
<p><img src="figures/question_bubble_red.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Brilliant! That is the end of this chapter.
Have you saved your notebook?
It is good practice to save it regularly.</p>
<p>Choose the correct option to complete each sentence below:</p>
<ol style="list-style-type: decimal">
<li>All <strong>variables</strong> have a ________.
<div id="radio_FJYFZMOAXO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FJYFZMOAXO" value="answer"></input> <span><strong>Class</strong></span></label><label><input type="radio" autocomplete="off" name="radio_FJYFZMOAXO" value=""></input> <span><strong>Comments</strong></span></label><label><input type="radio" autocomplete="off" name="radio_FJYFZMOAXO" value=""></input> <span><strong>String</strong></span></label>
</div></li>
<li>The hashtag (<code>#</code>) can be used to add ________ to code.
<div id="radio_CZYKMPZYER" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_CZYKMPZYER" value=""></input> <span><strong>Class</strong></span></label><label><input type="radio" autocomplete="off" name="radio_CZYKMPZYER" value="answer"></input> <span><strong>Comments</strong></span></label><label><input type="radio" autocomplete="off" name="radio_CZYKMPZYER" value=""></input> <span><strong>String</strong></span></label>
</div></li>
<li>Quotes (‘single’ or “double”) are used to create ________ <strong>variables</strong>.
<div id="radio_XZKMOFRJPM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XZKMOFRJPM" value=""></input> <span><strong>Class</strong></span></label><label><input type="radio" autocomplete="off" name="radio_XZKMOFRJPM" value=""></input> <span><strong>Comments</strong></span></label><label><input type="radio" autocomplete="off" name="radio_XZKMOFRJPM" value="answer"></input> <span><strong>String</strong></span></label>
</div></li>
<li>________ is a numeric <strong>class</strong> which <strong>does not</strong> contain decimal points (whole numbers).
<div id="radio_RVFGYFAQNS" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RVFGYFAQNS" value=""></input> <span><strong>Boolean</strong></span></label><label><input type="radio" autocomplete="off" name="radio_RVFGYFAQNS" value=""></input> <span><strong>Float</strong></span></label><label><input type="radio" autocomplete="off" name="radio_RVFGYFAQNS" value="answer"></input> <span><strong>Integer</strong></span></label>
</div></li>
<li>________ is a numeric <strong>class</strong> which <strong>does</strong> contain decimal points (real numbers).
<div id="radio_BTQDBUAIAT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_BTQDBUAIAT" value=""></input> <span><strong>Boolean</strong></span></label><label><input type="radio" autocomplete="off" name="radio_BTQDBUAIAT" value="answer"></input> <span><strong>Float</strong></span></label><label><input type="radio" autocomplete="off" name="radio_BTQDBUAIAT" value=""></input> <span><strong>Integer</strong></span></label>
</div></li>
<li>________ is a <strong>class</strong> that stores <code>True</code> or <code>False</code>.
<div id="radio_WZSHJSOXHE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WZSHJSOXHE" value="answer"></input> <span><strong>Boolean</strong></span></label><label><input type="radio" autocomplete="off" name="radio_WZSHJSOXHE" value=""></input> <span><strong>Float</strong></span></label><label><input type="radio" autocomplete="off" name="radio_WZSHJSOXHE" value=""></input> <span><strong>Integer</strong></span></label>
</div></li>
</ol>

</div>
</div>
<div id="functions_methods" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Functions and methods</h1>
<p><img src="figures/function.png" width="20%" style="display: block; margin: auto;" /></p>
<p><strong>Functions</strong> and <strong>methods</strong> are groups of instructions that together perform a specific task.
This may be a task that you need to run repeatedly on your data.
By storing these instructions in a single <strong>function/method</strong>, you only need to enter the code once and simply re-use it each time.
A <strong>function/method</strong> returns a value after it has performed the specific task.</p>
<p>Use the same notebook (<strong>“01-Fundamentals”</strong>) and add the following <strong>markdown cell</strong>:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co">## Functions &amp; methods</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="co">### Functions</span></span></code></pre></div>
<div id="functions" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Functions</h2>
<p><img src="figures/dna.png" width="15%" style="display: block; margin: auto;" /></p>
<p>A <strong>function</strong> is a distinct piece of code which requires data for it to run.
To run a <strong>function</strong> you need the name of the <strong>function</strong> followed by a pair of braces (<code>()</code>) with the desired input within the braces.</p>
<p>We have already used some <strong>functions</strong>:</p>
<ul>
<li><strong><code>int()</code></strong></li>
<li><strong><code>str()</code></strong></li>
<li><strong><code>float()</code></strong></li>
<li><strong><code>type()</code></strong></li>
</ul>
<p>Imagine that we need to find the length of a <strong>string</strong> of nucleotides (i.e. how many bases are in a piece of DNA).
In this instance, we can use the built-in <code>len()</code> <strong>function</strong> on the <strong>string</strong>:</p>
<p><strong>Note</strong>: Use any <strong>string</strong> of ‘ACGT’ you like, no need to copy this one exactly.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="co">#Random DNA sequence</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>DNA1 <span class="op">=</span> <span class="st">&quot;ACGTGTTATATGCGCGTTAGTGTAGTCGATC&quot;</span></span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a><span class="co">#print the length of the DNA</span></span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a><span class="bu">len</span>(DNA1)</span></code></pre></div>
<p>Make another random length of DNA and check its length:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co">#Random DNA sequence</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>DNA2 <span class="op">=</span> <span class="st">&quot;AGCTGACTGCATGATTGCTGATCAACAGT&quot;</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a><span class="co">#print the length of the DNA</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a><span class="bu">len</span>(DNA2)</span></code></pre></div>
<p>You can use the <code>+</code> <strong>operator</strong> to paste 2 or more <strong>strings</strong> together which is useful.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>DNA3 <span class="op">=</span> DNA1 <span class="op">+</span> DNA2</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>DNA3</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="bu">len</span>(DNA3)</span></code></pre></div>
<p>The below code incorporates previously made <strong>variables</strong> and used <strong>functions</strong>.
Make a good attempt to understand it.
You can try running smaller parts of the code to more easily see what each part is doing (e.g. only run <code>str(X)</code>).
If you are unsure please ask a demonstrator, they are more than happy to help.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>maths_sentence <span class="op">=</span> <span class="bu">str</span>(X) <span class="op">+</span> <span class="st">&quot; + &quot;</span> <span class="op">+</span> <span class="bu">str</span>(V) <span class="op">+</span> <span class="st">&quot; = &quot;</span> <span class="op">+</span> <span class="bu">str</span>(X <span class="op">+</span> V)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>maths_sentence</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="bu">len</span>(maths_sentence)</span></code></pre></div>
<p>You’ll notice that each character (including spaces <code></code>) adds to the length.</p>
</div>
<div id="methods" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Methods</h2>
<p><img src="figures/percent.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>Methods</strong> are very similar to <strong>functions</strong> in that they process an input in some manner.
They differ in that <strong>methods</strong> are associated with a particular data <strong>class</strong> (<strong>string</strong>, for example) and are called via the data itself.</p>
<p><strong>Methods</strong> are called using a different syntax; the <strong>variable</strong> is followed by <strong><code>.</code></strong> and the name of the <strong>method</strong> with a pair of braces.</p>
<p>Create a new <strong>markdown cell</strong> with the following:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="co">### Methods</span></span></code></pre></div>
<p>Let’s try a couple of <strong>methods</strong> associated with manipulation of <strong>string</strong> data:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co">#Define a string called sequencers</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>sequencers <span class="op">=</span> <span class="st">&quot;illumina,oxford_nanopore,pac-bio&quot;</span></span></code></pre></div>
<p>The <code>upper()</code> <strong>method</strong> converts string variables to upper-case.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>sequencers.upper()</span></code></pre></div>
<p>The <code>split()</code> <strong>method</strong> chops a string up wherever the specified sub-string occurs (comma in this case).</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>sequencers.split(<span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>Multiple <strong>methods</strong> can be used in one line.
This is the main advantage of the <strong>method</strong> syntax.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>sequencers.upper().split(<span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>We can also use built-in <strong>methods</strong> for some simple analysis using the “DNA1” <strong>string</strong> generated earlier.
Use the <code>count()</code> <strong>method</strong> to count the number of each nucleotide in the string.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>DNA1.count(<span class="st">&quot;A&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>DNA1.count(<span class="st">&quot;C&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>DNA1.count(<span class="st">&quot;G&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>DNA1.count(<span class="st">&quot;T&quot;</span>)</span></code></pre></div>
<p>By using the <code>len()</code> <strong>function</strong> and the <code>count()</code> <strong>method</strong>, we can calculate the GC content of the DNA1 sequence:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co">#Count the number of Gs and Cs in the sequence</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>G_total <span class="op">=</span> DNA1.count(<span class="st">&quot;G&quot;</span>)</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>C_total <span class="op">=</span> DNA1.count(<span class="st">&quot;C&quot;</span>)</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a><span class="co">#Calculate the GC%</span></span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>((G_total <span class="op">+</span> C_total) <span class="op">/</span> <span class="bu">len</span>(DNA1)) <span class="op">*</span> <span class="dv">100</span></span></code></pre></div>
</div>
<div id="functions-and-methods-mcq-recap" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Functions and methods MCQ recap</h2>
<p><img src="figures/question_bubble_green.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Fabulous! We have explored <strong>functions</strong> (<code>function_name(variable)</code>) and <strong>methods</strong> (<code>variable.method_name()</code>), and can now apply them to <strong>variables</strong>.
You’ll learn more <strong>functions</strong> and <strong>methods</strong> throughout this course.</p>
<p>It is nigh impossible to learn all the <strong>function</strong> and <strong>methods</strong>.
During this course and afterwards you can refer to the <a href="#cheatsheet">cheatsheet in the appendix</a> to get a quick summary of all the <strong>functions</strong> and <strong>methods</strong> used in this book.</p>
<p>Choose the correct option to complete the below sentences:</p>
<ol style="list-style-type: decimal">
<li>________ are associated with a specific <strong>class</strong>.
<div id="radio_FDKPDKSJOM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FDKPDKSJOM" value=""></input> <span><strong>Functions</strong></span></label><label><input type="radio" autocomplete="off" name="radio_FDKPDKSJOM" value="answer"></input> <span><strong>Methods</strong></span></label><label><input type="radio" autocomplete="off" name="radio_FDKPDKSJOM" value=""></input> <span><strong>Operators</strong></span></label>
</div></li>
<li>The syntax of ________ are <code>command_name(data)</code>.
<div id="radio_YPFYAJLVZL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_YPFYAJLVZL" value="answer"></input> <span><strong>Functions</strong></span></label><label><input type="radio" autocomplete="off" name="radio_YPFYAJLVZL" value=""></input> <span><strong>Methods</strong></span></label><label><input type="radio" autocomplete="off" name="radio_YPFYAJLVZL" value=""></input> <span><strong>Operators</strong></span></label>
</div></li>
<li>The syntax of ________ are <code>data.command_name()</code>.
<div id="radio_HFTMOGYTCC" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HFTMOGYTCC" value=""></input> <span><strong>Functions</strong></span></label><label><input type="radio" autocomplete="off" name="radio_HFTMOGYTCC" value="answer"></input> <span><strong>Methods</strong></span></label><label><input type="radio" autocomplete="off" name="radio_HFTMOGYTCC" value=""></input> <span><strong>Operators</strong></span></label>
</div></li>
<li>The <strong>function</strong> ________ can count the total number of characters in a string.
<div id="radio_VVQHEZOEEO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VVQHEZOEEO" value=""></input> <span><strong><code>.count()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_VVQHEZOEEO" value="answer"></input> <span><strong><code>len()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_VVQHEZOEEO" value=""></input> <span><strong><code>.upper()</code></strong></span></label>
</div></li>
<li>The <strong>method</strong> ________ can count the number of instances of a pattern in a string <strong>variable</strong>.
<div id="radio_XOQLYMIHXW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XOQLYMIHXW" value="answer"></input> <span><strong><code>.count()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_XOQLYMIHXW" value=""></input> <span><strong><code>len()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_XOQLYMIHXW" value=""></input> <span><strong><code>.upper()</code></strong></span></label>
</div></li>
<li>The <strong>method</strong> ________ can convert a string <strong>variable</strong> to upper-case.
<div id="radio_VGLIPTLWHO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VGLIPTLWHO" value=""></input> <span><strong><code>.count()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_VGLIPTLWHO" value=""></input> <span><strong><code>len()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_VGLIPTLWHO" value="answer"></input> <span><strong><code>.upper()</code></strong></span></label>
</div></li>
</ol>

</div>
</div>
<div id="data_structures" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Data Structures</h1>
<p><img src="figures/python_data_structure.png" width="20%" style="display: block; margin: auto;" /></p>
<p>We now know the different types of data points that Python can hold, whether
they are <strong>integers</strong>, <strong>floats</strong>, <strong>strings</strong> of text, or <strong>boolean</strong> values.</p>
<p>Typically, data points do not exist in isolation but instead are in a group.
For example, consider a set of measurements of the peak day temperature over
a period of a week.
A group of data points such as these can be stored in a <strong>list</strong>.</p>
<p>Use the same notebook (<strong>“01-Fundamentals”</strong>) and add the following <strong>markdown cell</strong>:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="co">## Data structures</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="co">### Lists</span></span></code></pre></div>
<p>From now on you won’t be instructed to make <strong>markdown cells</strong>, instead use your judgement and make your own.</p>
<div id="lists" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Lists</h2>
<p><img src="figures/shopping_list.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>Lists</strong> are used to store multiple items within a single <strong>variable</strong>.
<strong>Lists</strong> allow duplicate values and once defined are always in the same order (<strong>ordered</strong>).
Additional items can be added to the <strong>list</strong> and by default will appear at the bottom.
Finally, <strong>lists</strong> are indexed meaning that we can easily retrieve the 1st, 2nd….nth item from the <strong>list</strong>.</p>
<p>We define a <strong>list</strong> like any other <strong>variable</strong>.
To add multiple values to the <strong>list</strong> we enclose them in square braces (<code>[]</code>) and include a comma between each value.</p>
<p>Create the <strong>list</strong> in the below code block.
It consists of made up fold-change values generated by an RNA-Seq type experiment.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>gene_fold_change <span class="op">=</span> [<span class="fl">0.25</span>, <span class="op">-</span><span class="fl">0.42</span>, <span class="fl">0.62</span>, <span class="fl">1.27</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="dv">0</span>]</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>gene_fold_change</span></code></pre></div>
<p>To add an additional value to the <strong>end</strong> of the <strong>list</strong>, we can use the <code>.append()</code> <strong>method</strong>:</p>
<p><strong>Reminder</strong>: Each unique <strong>method</strong> can only be used on one type of data. The <code>.append()</code> method can only be used with <strong>lists</strong>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>gene_fold_change.append(<span class="fl">0.33</span>)</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>gene_fold_change</span></code></pre></div>
<p>You can create <strong>lists</strong> containing strings.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>taxonomy_levels <span class="op">=</span> [<span class="st">&quot;Kingdom&quot;</span>, <span class="st">&quot;Phylum&quot;</span>, <span class="st">&quot;Class&quot;</span>, <span class="st">&quot;Order&quot;</span>, <span class="st">&quot;Family&quot;</span>, <span class="st">&quot;Genus&quot;</span>, <span class="st">&quot;Species&quot;</span>]</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>taxonomy_levels</span></code></pre></div>
<p>You can even create <strong>lists</strong> with multiple data <strong>classes</strong>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>numerals <span class="op">=</span> [<span class="st">&quot;I&quot;</span>, <span class="dv">1</span>, <span class="st">&quot;V&quot;</span>, <span class="dv">5</span>, <span class="va">True</span>]</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>numerals</span></code></pre></div>
</div>
<div id="subsetting-data" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Subsetting data</h2>
<p><img src="figures/noun-list-5537185.png" width="15%" style="display: block; margin: auto;" /></p>
<p>A value from a <strong>list</strong> can be retrieved by the <strong>position</strong> it occupies in the list.
This selection can be carried out using square braces (<code>[]</code>).</p>
<p>This process of selecting a certain portion of data is known as <strong>subsetting</strong>.</p>
<p>One of the most vital aspects to grasp for Python is that data structures start at position <strong>zero</strong>.
This can be confusing but is a common feature of many programming languages.</p>
<div id="single-values" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Single values</h3>
<p><img src="figures/one_hand.png" width="15%" style="display: block; margin: auto;" /></p>
<p>To select the first entry in a <strong>list</strong>, we therefore pass position “0” in the square braces:</p>
<p><strong>Reminder</strong>: Create your own informative <strong>markdown cells</strong>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="co">#Get the first value</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>gene_fold_change[<span class="dv">0</span>]</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="co">#Get the fifth value</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>gene_fold_change[<span class="dv">4</span>]</span></code></pre></div>
<p>We can also use a negative value to count from the other end of the <strong>list</strong>. I.e. to get the last value in the <strong>list</strong>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co">#Get the last value (without knowing the length of the list)</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>gene_fold_change[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
</div>
<div id="multiple-values" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Multiple values</h3>
<p><img src="figures/four_hand.png" width="15%" style="display: block; margin: auto;" /></p>
<p>The same technique also works to select a range of values from the <strong>list</strong>.
The upper and lower positions of the range to be selected.
These are given in square brackets, separated by a colon (<code>X:Y</code>).</p>
<p>When using a range in this manner:</p>
<ul>
<li>The first number (<code>X:</code>) is inclusive.</li>
<li>The last number (<code>:Y</code>) is exclusive.</li>
</ul>
<p>In other words all the positions except the last one will be selected.</p>
<p>Try out the following code blocks to see this in practice.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co">#Create a list containing the numbers 1 to 7</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>one_to_seven <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>]</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>one_to_seven</span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co">#Subset the third and fourth values</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>one_to_seven[<span class="dv">2</span>:<span class="dv">4</span>]</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="co">#Subset the first to fifth values</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>one_to_seven[<span class="dv">0</span>:<span class="dv">5</span>]</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co">#Subset the first value</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>one_to_seven[<span class="dv">0</span>:<span class="dv">1</span>]</span></code></pre></div>
<p>If you find this confusing you are not the only one so please don’t feel bad about it.
It will take time and effort for most people to get used to this.</p>
<p>To subset everything from a certain position onwards, leave the upper value blank. This also works to select everything before a certain position.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co">#Subset the sixth value to the end</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>one_to_seven[<span class="dv">5</span>:]</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co">#Subset everything up to (but excluding) the third value</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>one_to_seven[:<span class="dv">2</span>]</span></code></pre></div>
<p><strong>Lists</strong> are incredibly useful but have their limitations so it is good to learn other data structures.</p>
</div>
</div>
<div id="set" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Set</h2>
<p><img src="figures/uk_plants.png" width="20%" style="display: block; margin: auto;" /></p>
<p>A <strong>set</strong> is similar to a <strong>list</strong> except that it can only hold <strong>unique</strong> values.
A <strong>set</strong> also differs from a <strong>list</strong> in that they do not retain the order of the elements (unordered).</p>
<p><strong>Sets</strong> are defined using the curly braces (<code>{}</code>). Define a <strong>set</strong> containing the plants found on the one pound coin.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>plants_set <span class="op">=</span> {<span class="st">&quot;Leek&quot;</span>, <span class="st">&quot;Rose&quot;</span>, <span class="st">&quot;Shamrock&quot;</span>}</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>plants_set</span></code></pre></div>
<p>We forgot the Scottish thistle!
We can add a new element to our <strong>set</strong> using the <code>.add()</code> <strong>method</strong>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>plants_set.add(<span class="st">&quot;Thistle&quot;</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>plants_set</span></code></pre></div>
<p>In real world analysis combining data from more samples might mean that duplicate plants were detected in the data.
Adding values that are already in the <strong>set</strong> has no effect as it cannot hold duplicate values.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>plants_set.add(<span class="st">&quot;Shamrock&quot;</span>)</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>plants_set</span></code></pre></div>
</div>
<div id="convert-a-list-to-a-set" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Convert a list to a set</h2>
<p><img src="figures/list_to_set.png" width="65%" style="display: block; margin: auto;" /></p>
<p>Sometimes we have a <strong>list</strong> of non-unique values and it is useful to extract the unique values. We can do this by transforming a <strong>list</strong> into a <strong>set</strong>.</p>
<p>Add some gene IDs to a <strong>list</strong>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>gene_IDs <span class="op">=</span> [<span class="st">&quot;Agl&quot;</span>, <span class="st">&quot;Pygm&quot;</span>, <span class="st">&quot;Pgm2&quot;</span>, <span class="st">&quot;Ugp2&quot;</span>, <span class="st">&quot;Pygm&quot;</span>, <span class="st">&quot;Pgm2&quot;</span>]</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>gene_IDs</span></code></pre></div>
<p>We can transform the <strong>list</strong> into a <strong>set</strong> using the <strong>function</strong> <code>set()</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>gene_set <span class="op">=</span> <span class="bu">set</span>(gene_IDs)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>gene_set</span></code></pre></div>
</div>
<div id="dictionary" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Dictionary</h2>
<p><img src="figures/dictionary.png" width="15%" style="display: block; margin: auto;" /></p>
<p>The third data structure we will learn is the <strong>dictionary</strong>. A <strong>dictionary</strong> is an
ordered data structure which holds <strong>pairs</strong> of values; a <strong>key</strong> and a <strong>value</strong>.</p>
<p>For example, say we want to store the gene identifiers alongside our fold-change data
that we recorded earlier in a <strong>list</strong>.
Each gene identifier/fold-change pair is the <strong>key</strong>/<strong>value</strong> of the <strong>dictionary</strong>.</p>
<p><strong>Dictionaries</strong> are also defined using the curly braces but a pair of values are given each time, separated by a colon (<code>{key:value}</code>).</p>
<p>Enter the following.</p>
<p><strong>Note</strong>: You need to press enter after each line.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>gene_fold_change <span class="op">=</span> {</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>  <span class="st">&quot;Agl&quot;</span> : <span class="fl">0.25</span>,</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>  <span class="st">&quot;Pygm&quot;</span> : <span class="op">-</span><span class="fl">0.42</span>,</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>  <span class="st">&quot;Pgm2&quot;</span> : <span class="fl">0.62</span>,</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>  <span class="st">&quot;Ugp2&quot;</span> : <span class="fl">1.27</span>,</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>  <span class="st">&quot;Gys1&quot;</span> : <span class="op">-</span><span class="fl">0.5</span>,</span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>  <span class="st">&quot;Phka1&quot;</span> : <span class="dv">0</span>,</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a>  <span class="st">&quot;Phkg1&quot;</span> : <span class="fl">0.33</span></span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a>}</span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a>gene_fold_change</span></code></pre></div>
<p><strong>Dictionaries</strong> are <strong>indexed</strong> meaning that individual records can be retrieved
very quickly (important if you are working with very large dictionaries).</p>
<p>We can retrieve the information for “Gys1” by using the identifier as the <strong>key</strong>
and the <strong>dictionary</strong> will then return the <strong>value</strong>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>gene_fold_change[<span class="st">&quot;Gys1&quot;</span>]</span></code></pre></div>
<p>New values can be added to the <strong>dictionary</strong> in a similar way to how they are retrieved:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>gene_fold_change[<span class="st">&quot;ZT1&quot;</span>] <span class="op">=</span> <span class="fl">3.2</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>gene_fold_change[<span class="st">&quot;ZT1&quot;</span>]</span></code></pre></div>
<p>You <strong>cannot</strong> subset <strong>dictionaries</strong> with numbers like a <strong>list</strong>.</p>
<p>The pairing up of values in <strong>dictionaries</strong> is extremely useful if you are working with DNA sequence files (Fasta or FastQ).
It offers an easy way of matching up the read identifier with the DNA nucleotide data, for example.
Once indexed, the individual records can then be accessed extremely quickly.</p>
</div>
<div id="data-structures-mcq-recap" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Data structures MCQ recap</h2>
<p><img src="figures/question_bubble_purple.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Grand! You have learnt about different data structures in <strong>Python</strong>.</p>
<p>Try choosing the correct option in the below sentences to recap what you have learnt.</p>
<ol style="list-style-type: decimal">
<li>________ hold an ordered catalogue of values.
<div id="radio_TYGETIMFGW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TYGETIMFGW" value=""></input> <span><strong>Dictionaries</strong></span></label><label><input type="radio" autocomplete="off" name="radio_TYGETIMFGW" value="answer"></input> <span><strong>Lists</strong></span></label><label><input type="radio" autocomplete="off" name="radio_TYGETIMFGW" value=""></input> <span><strong>Sets</strong></span></label>
</div></li>
<li>________ can only hold unique values.
<div id="radio_JNMZQFHCWJ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_JNMZQFHCWJ" value=""></input> <span><strong>Dictionaries</strong></span></label><label><input type="radio" autocomplete="off" name="radio_JNMZQFHCWJ" value=""></input> <span><strong>Lists</strong></span></label><label><input type="radio" autocomplete="off" name="radio_JNMZQFHCWJ" value="answer"></input> <span><strong>Sets</strong></span></label>
</div></li>
<li>________ hold pairs of values (key and value). They can be used to quickly access individual records, even when they are extremely large.
<div id="radio_POZRQAUHML" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_POZRQAUHML" value="answer"></input> <span><strong>Dictionaries</strong></span></label><label><input type="radio" autocomplete="off" name="radio_POZRQAUHML" value=""></input> <span><strong>Lists</strong></span></label><label><input type="radio" autocomplete="off" name="radio_POZRQAUHML" value=""></input> <span><strong>Sets</strong></span></label>
</div></li>
<li>Data structures in Python start at position ________.
<div id="radio_UATOOGSJDR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UATOOGSJDR" value=""></input> <span><strong>-1</strong></span></label><label><input type="radio" autocomplete="off" name="radio_UATOOGSJDR" value="answer"></input> <span><strong>0</strong></span></label><label><input type="radio" autocomplete="off" name="radio_UATOOGSJDR" value=""></input> <span><strong>1</strong></span></label>
</div></li>
<li>When subsetting values in a <strong>list</strong> the first number (<code>[X:]</code>) is ________.
<div id="radio_FYGAJIRQRH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FYGAJIRQRH" value=""></input> <span><strong>Exclusive</strong></span></label><label><input type="radio" autocomplete="off" name="radio_FYGAJIRQRH" value="answer"></input> <span><strong>Inclusive</strong></span></label><label><input type="radio" autocomplete="off" name="radio_FYGAJIRQRH" value=""></input> <span><strong>Key</strong></span></label>
</div></li>
<li>When subsetting values in a <strong>list</strong> the last number (<code>[:Y]</code>) is ________.
<div id="radio_ZOVAHUDFYV" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ZOVAHUDFYV" value="answer"></input> <span><strong>Exclusive</strong></span></label><label><input type="radio" autocomplete="off" name="radio_ZOVAHUDFYV" value=""></input> <span><strong>Inclusive</strong></span></label><label><input type="radio" autocomplete="off" name="radio_ZOVAHUDFYV" value=""></input> <span><strong>Key</strong></span></label>
</div></li>
<li>You can access the <strong>value</strong> of a <strong>dictionary</strong> with its matching ________.
<div id="radio_DWENAVZFFB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_DWENAVZFFB" value=""></input> <span><strong>Exclusive</strong></span></label><label><input type="radio" autocomplete="off" name="radio_DWENAVZFFB" value=""></input> <span><strong>Inclusive</strong></span></label><label><input type="radio" autocomplete="off" name="radio_DWENAVZFFB" value="answer"></input> <span><strong>Key</strong></span></label>
</div></li>
<li>The ________ <strong>method</strong> can add a value to a <strong>list</strong>.
<div id="radio_LOTPGNVPDY" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LOTPGNVPDY" value=""></input> <span><strong><code>.add()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_LOTPGNVPDY" value="answer"></input> <span><strong><code>.append()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_LOTPGNVPDY" value=""></input> <span><strong><code>set()</code></strong></span></label>
</div></li>
<li>The ________ <strong>method</strong> can add a value to a <strong>set</strong>.
<div id="radio_WFMKIFEANN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WFMKIFEANN" value="answer"></input> <span><strong><code>.add()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_WFMKIFEANN" value=""></input> <span><strong><code>.append()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_WFMKIFEANN" value=""></input> <span><strong><code>set()</code></strong></span></label>
</div></li>
<li>The ________ <strong>function</strong> can create a <strong>set</strong> from a <strong>list</strong>.
<div id="radio_PEXPZUEYAX" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PEXPZUEYAX" value=""></input> <span><strong><code>.add()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_PEXPZUEYAX" value=""></input> <span><strong><code>.append()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_PEXPZUEYAX" value="answer"></input> <span><strong><code>set()</code></strong></span></label>
</div></li>
</ol>
<p>We are going to be using these data structures to look at and manipulate DNA sequence data specifically, but the principles apply to any datasets stored in these structures.</p>
<p>Ensure you save your notebook. However, don’t close it as you may find its contents useful for the next chapter of exercises.</p>

</div>
</div>
<div id="fundamental_exercise" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Fundamental exercise</h1>
<p><img src="figures/Mimas%20tiliae.png" width="15%" style="display: block; margin: auto;" /></p>
<p>To reinforce what you have learnt please try the challenges in this chapter.</p>
<p>Solutions are in the expandable boxes.
Try your best to solve the challenge but use the solutions for help if you would like.
Even if your solution works it can be good to check the solution as there are many ways to do the same thing in python.</p>
<p>In this exercise you are going to create, investigate, and manipulate data of UK moths found in light traps.</p>
<div id="fundamental-exercise-notebook" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Fundamental exercise notebook</h2>
<p><img src="figures/notebook.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Create a new notebook called “02-Fundamental_exercises”. Use this notebook to carry out the challenges.</p>
<p>Remember to use <strong>markdown cells</strong> to make headers.</p>
</div>
<div id="moth-light-trap-challenges" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Moth light trap challenges</h2>
<div id="moth-challenge-1" class="section level3 unnumbered">
<h3>Moth challenge 1</h3>
<p><img src="figures/moth_1.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Create a <strong>list variable</strong> called <strong>“moth_sightings_21sep”</strong> with the ordered <strong>string</strong> values:</p>
<ol style="list-style-type: decimal">
<li>“Poplar Hawk-moth”</li>
<li>“Elephant Hawk-moth”</li>
<li>“Elephant Hawk-moth”</li>
<li>“Cinnabar”</li>
<li>“Poplar Hawk-moth”</li>
<li>“Scarlet Tiger”</li>
<li>“Scalloped Oak”</li>
</ol>
<p>This is the species of the individual moths that visited the light trap on the 21st night of September.</p>
<p>Then view the <strong>list</strong>.</p>
<div class="webex-solution">
<button>
Moth 1 solution
</button>
<div class="sourceCode" id="cb105"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="co">#1</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>moth_sightings_21sep <span class="op">=</span> [<span class="st">&quot;Poplar Hawk-moth&quot;</span>, <span class="st">&quot;Elephant Hawk-moth&quot;</span>, <span class="st">&quot;Elephant Hawk-moth&quot;</span>,</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>                        <span class="st">&quot;Cinnabar&quot;</span>, <span class="st">&quot;Poplar Hawk-moth&quot;</span>, <span class="st">&quot;Scarlet Tiger&quot;</span>, <span class="st">&quot;Scalloped Oak&quot;</span>]</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>moth_sightings_21sep</span></code></pre></div>
</div>
</div>
<div id="moth-challenge-2" class="section level3 unnumbered">
<h3>Moth challenge 2</h3>
<p><img src="figures/moth_2.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Using python code calculate the percentage of individuals that were <strong>Elephant Hawk-moths</strong> in <strong>“moth_sightings_21sep”</strong>.</p>
<p><strong>Tip:</strong> Operators, the <strong>function</strong> <code>len()</code> and the <strong>method</strong> <code>.count()</code> (it can be used on string <strong>lists</strong>) will be useful.</p>
<div class="webex-solution">
<button>
Moth 2 solution
</button>
<div class="sourceCode" id="cb106"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="co">#2</span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>(moth_sightings_21sep.count(<span class="st">&quot;Elephant Hawk-moth&quot;</span>) <span class="op">/</span> <span class="bu">len</span>(moth_sightings_21sep)) <span class="op">*</span> <span class="dv">100</span></span></code></pre></div>
</div>
</div>
<div id="moth-challenge-3" class="section level3 unnumbered">
<h3>Moth challenge 3</h3>
<p><img src="figures/moth_3.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Create a <strong>set</strong> called <strong>unique_moths</strong> from the <strong>“moth_sightings_21sep”</strong> list.</p>
<div class="webex-solution">
<button>
Moth 3 solution
</button>
<div class="sourceCode" id="cb107"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co">#3</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>unique_moths <span class="op">=</span> <span class="bu">set</span>(moth_sightings_21sep)</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>unique_moths</span></code></pre></div>
</div>
</div>
<div id="moth-challenge-4" class="section level3 unnumbered">
<h3>Moth challenge 4</h3>
<p><img src="figures/moth_4.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Create a new <strong>list variable</strong> called <strong>“moth_sightings_22sep”</strong> with the ordered <strong>string</strong> values:</p>
<ol style="list-style-type: decimal">
<li>“Poplar Hawk-moth”</li>
<li>“Elephant Hawk-moth”</li>
<li>“Elephant Hawk-moth”</li>
<li>“Cinnabar”</li>
<li>“Feathered Thorn”</li>
<li>“Scarlet Tiger”</li>
<li>“Elephant Hawk-moth”</li>
</ol>
<p><strong>Tip</strong>: It can be useful to copy, paste, and edit previous code.</p>
<div class="webex-solution">
<button>
Moth 4 solution
</button>
<div class="sourceCode" id="cb108"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co">#4</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>moth_sightings_22sep <span class="op">=</span> [<span class="st">&quot;Poplar Hawk-moth&quot;</span>, <span class="st">&quot;Elephant Hawk-moth&quot;</span>, <span class="st">&quot;Elephant Hawk-moth&quot;</span>,</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>                        <span class="st">&quot;Cinnabar&quot;</span>, <span class="st">&quot;Feathered Thorn&quot;</span>, <span class="st">&quot;Scarlet Tiger&quot;</span>, <span class="st">&quot;Elephant Hawk-moth&quot;</span>]</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>moth_sightings_22sep</span></code></pre></div>
</div>
</div>
<div id="moth-challenge-5" class="section level3 unnumbered">
<h3>Moth challenge 5</h3>
<p><img src="figures/moth_5.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Add the string <strong>variable</strong> <strong>“Feathered Thorn”</strong> to the <strong>set</strong> <strong>“unique_moths”</strong>.</p>
<div class="webex-solution">
<button>
Moth 5 solution
</button>
<div class="sourceCode" id="cb109"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="co">#5</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>unique_moths.add(<span class="st">&quot;Feathered Thorn&quot;</span>)</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>unique_moths</span></code></pre></div>
</div>
</div>
<div id="moth-challenge-6" class="section level3 unnumbered">
<h3>Moth challenge 6</h3>
<p><img src="figures/moth_6.png" width="10%" style="display: block; margin: auto;" /></p>
<p>This is a multi stage challenge.
Subset the <strong>lists</strong> in the following ways:</p>
<ol style="list-style-type: decimal">
<li>Subset the 1st value of <strong>“moth_sightings_21sep”</strong>.</li>
<li>Subset the 3rd to 5th values of <strong>“moth_sightings_22sep”</strong>.</li>
<li>Subset the second last value of <strong>“moth_sightings_21sep”</strong>.</li>
<li>Subset the first 4 values of <strong>“moth_sightings_22sep”</strong>.</li>
<li>Subset the values from the 5th to the end of <strong>“moth_sightings_21sep”</strong>.</li>
<li>Subset the three last values of <strong>“moth_sightings_22sep”</strong>.</li>
</ol>
<div class="webex-solution">
<button>
Moth 6 solution
</button>
<div class="sourceCode" id="cb110"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co">#6.1</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>moth_sightings_21sep[<span class="dv">0</span>]</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="co">#6.2</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>moth_sightings_22sep[<span class="dv">2</span>:<span class="dv">5</span>]</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="co">#6.3</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>moth_sightings_21sep[<span class="op">-</span><span class="dv">2</span>]</span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="co">#6.4</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>moth_sightings_22sep[:<span class="dv">4</span>]</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="co">#6.5</span></span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>moth_sightings_21sep[<span class="dv">4</span>:]</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="co">#6.6</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>moth_sightings_22sep[<span class="op">-</span><span class="dv">3</span>:]</span></code></pre></div>
</div>
</div>
<div id="moth-challenge-7" class="section level3 unnumbered">
<h3>Moth challenge 7</h3>
<p><img src="figures/moth_7.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Create a <strong>dictionary</strong> called <strong>“moth_visits_sep”</strong> containing the following <strong>key</strong> &amp; <strong>value</strong> pairs:</p>
<ol style="list-style-type: decimal">
<li>“Poplar Hawk-moth” : 45</li>
<li>“Elephant Hawk-moth” : 72</li>
<li>“Cinnabar” : 23</li>
<li>“Scarlet Tiger” : 32</li>
<li>“Scalloped Oak” : 10</li>
</ol>
<div class="webex-solution">
<button>
Moth 7 solution
</button>
<div class="sourceCode" id="cb116"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="co">#7</span></span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>moth_visits_sep <span class="op">=</span> {</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>  <span class="st">&quot;Poplar Hawk-moth&quot;</span> :  <span class="dv">45</span>, </span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>  <span class="st">&quot;Elephant Hawk-moth&quot;</span> : <span class="dv">72</span>,</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>  <span class="st">&quot;Cinnabar&quot;</span> : <span class="dv">23</span>,</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>  <span class="st">&quot;Scarlet Tiger&quot;</span> : <span class="dv">32</span>,</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>  <span class="st">&quot;Scalloped Oak&quot;</span> : <span class="dv">10</span></span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a>}</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a>moth_visits_sep</span></code></pre></div>
</div>
</div>
<div id="moth-challenge-8" class="section level3 unnumbered">
<h3>Moth challenge 8</h3>
<p><img src="figures/moth_8.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Add the <strong>key/value</strong> pair <strong>“Feathered Thorn” : 13</strong> to the <strong>dictionary</strong> <strong>“moth_visits_sep”</strong>.</p>
<div class="webex-solution">
<button>
Moth 8 solution
</button>
<div class="sourceCode" id="cb117"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="co">#8</span></span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>moth_visits_sep[<span class="st">&quot;Feathered Thorn&quot;</span>] <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>moth_visits_sep</span></code></pre></div>
</div>
</div>
</div>
<div id="moth-exercise-conclusion" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Moth exercise conclusion</h2>
<p><img src="figures/finish.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Fantastic! Hopefully you found those challenges helpful in practising and solidifying your python skills and knowledge.</p>
<p>You can now save and <strong>close and halt</strong> your <strong>notebooks</strong>.</p>

</div>
</div>



<div id="python_conditions" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Python Conditions</h1>
<p><img src="figures/python_condition.png" width="20%" style="display: block; margin: auto;" /></p>
<p>In this section we are going to learn some programmatic <strong>Python</strong> coding including <strong>conditions</strong> and <strong>loops</strong>.</p>
<p>Create a new notebook called <strong>“03-Programmatic_coding”</strong>. Use this notebook in this chapter.</p>
<div id="logical-conditions" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Logical conditions</h2>
<p><img src="figures/logical.png" width="15%" style="display: block; margin: auto;" /></p>
<p>A powerful feature of most programming languages is the ability to compare values/<strong>variables</strong> and to make decisions based upon the outcome.
This type of behaviour is achieved using <strong>logical conditions</strong>.</p>
<p>The <strong>conditions</strong> allowed depends on the type of data you are comparing.
You cannot use greater than (<code>&gt;</code>) or less than (<code>&lt;</code>) on <strong>string variables</strong> directly (although you could compare their lengths).</p>
<p><strong>Python supports the following logical conditions:</strong></p>
<ul>
<li>Equals: <code>a == b</code></li>
<li>Does not equal: <code>a != b</code></li>
<li>Less than: <code>a &lt; b</code></li>
<li>Less than or equal to: <code>a &lt;= b</code></li>
<li>Greater than: <code>a &gt; b</code></li>
<li>Greater than or equal to: <code>a &gt;= b</code></li>
</ul>
<p>Try the following:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>a <span class="op">=</span> <span class="st">&quot;ATTGCG&quot;</span></span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>b <span class="op">=</span> <span class="st">&quot;AGCGAT&quot;</span></span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>a<span class="op">==</span>b</span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="bu">len</span>(a) <span class="op">==</span> <span class="bu">len</span>(b)</span></code></pre></div>
<p>These logical conditions are most typically used in <strong>if</strong> statements.</p>
</div>
<div id="if-statements" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> If statements</h2>
<p><img src="figures/switch.png" width="15%" style="display: block; margin: auto;" /></p>
<p>By testing whether certain comparisons evaluate as either <strong>True</strong> or <strong>False</strong>, we can change the flow of our programs.</p>
<p>An <strong>if statement</strong> is a programming statement which acts like a switch.
If the statement is <strong>True</strong>, the switch is activated.
If the statement is <strong>False</strong>, the switch remains inactivated.</p>
<p>A generic <strong>if statement</strong> using pseudocode would have the following structure: <br></p>
<ol style="list-style-type: decimal">
<li><p>If a condition is met:</p>
<ol start="2" style="list-style-type: decimal">
<li>Perform a task</li>
</ol></li>
</ol>
<p>Try out the examples below.
You will notice no results will appear when the conditions are <code>False</code>.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="cf">if</span> <span class="dv">1</span> <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;1 is 1&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="cf">if</span> <span class="st">&quot;team&quot;</span> <span class="op">!=</span> <span class="st">&quot;teaim&quot;</span>:</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;There is no I in team&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">2</span><span class="op">+</span><span class="dv">2</span>) <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;4 is equal to 5&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">8</span> <span class="op">*</span> <span class="dv">8</span></span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">4</span> <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a><span class="cf">if</span> x <span class="op">&lt;</span> y:</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>  <span class="bu">print</span>(<span class="bu">str</span>(<span class="dv">8</span><span class="op">*</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">&quot; is less than &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="dv">4</span><span class="op">**</span><span class="dv">3</span>))</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="cf">if</span> x <span class="op">&gt;=</span> y:</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>  <span class="bu">print</span>(<span class="bu">str</span>(<span class="dv">8</span><span class="op">*</span><span class="dv">8</span>) <span class="op">+</span> <span class="st">&quot; is greater or equal to  &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="dv">4</span><span class="op">**</span><span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="if-else-statements" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> If else statements</h2>
<p><img src="figures/wrong.png" width="15%" style="display: block; margin: auto;" /></p>
<p>We can also include an action for when the condition has not been met using <strong>else</strong>.
The <strong>else statement</strong> works in conjunction with the <strong>if</strong> and offers a different action if the condition evaluated to <strong>False</strong>.</p>
<ol style="list-style-type: decimal">
<li>If a condition is met:
<ul>
<li>Perform a task</li>
</ul></li>
<li>Else:
<ul>
<li>Do something else</li>
</ul></li>
</ol>
<p>For example, we might have a string of nucleotide data which we want to move through, translating any thymine (T) bases into uracil (U).
The other three bases (A, C, and G) do not require any processing.</p>
<p>The <strong>if</strong> and <strong>else statements</strong> to do this would look something like (again, using pseudocode):</p>
<ol style="list-style-type: decimal">
<li>If the current nucleotide is “T”:
<ul>
<li>Print “U”</li>
</ul></li>
<li>Else:
<ul>
<li>Print the current nucleotide</li>
</ul></li>
</ol>
<p>We will explore using <strong>loops</strong> to move through data more in the next chapter. For now, create the below <strong>variables</strong> which we will use for some <code>if else statements</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="co">#Create some DNA variables</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>a <span class="op">=</span> <span class="st">&quot;ATTGCG&quot;</span></span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>b <span class="op">=</span> <span class="st">&quot;AGCGAT&quot;</span></span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>c <span class="op">=</span> <span class="st">&quot;GGTCATtat&quot;</span></span></code></pre></div>
<div id="dna-length-comparison" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> DNA length comparison</h3>
<p><img src="figures/measuring_tape.png" width="15%" style="display: block; margin: auto;" /></p>
<p>In the below code we create new variables for the <strong>statement</strong> (<code>dna1</code> &amp; <code>dna2</code>).
This is so we only have to change the one set of <strong>variables</strong> if we change the input data.
This is a common technique with <strong>conditions</strong> and <strong>loops</strong>.
It is cumbersome and error prone to change all the <strong>variables</strong> within the <strong>statement</strong>.</p>
<p><strong>Tip</strong>: It is always useful to copy and paste code.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="co">#Compare lengths of a and b</span></span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>dna1 <span class="op">=</span> a</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>dna2 <span class="op">=</span> b</span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(dna1) <span class="op">==</span> <span class="bu">len</span>(dna2):</span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences are the same length&quot;</span>)</span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;Length difference is &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(dna1) <span class="op">-</span> <span class="bu">len</span>(dna2)))</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="co">#Compare lengths of a and c</span></span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a>dna1 <span class="op">=</span> a</span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a>dna2 <span class="op">=</span> c</span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(dna1) <span class="op">==</span> <span class="bu">len</span>(dna2):</span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences are the same length&quot;</span>)</span>
<span id="cb127-6"><a href="#cb127-6" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb127-7"><a href="#cb127-7" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;Length difference is &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(dna1) <span class="op">-</span> <span class="bu">len</span>(dna2)))</span></code></pre></div>
</div>
<div id="nucleotide-count-comparison" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Nucleotide count comparison</h3>
<p><img src="figures/abacus.png" width="15%" style="display: block; margin: auto;" /></p>
<p>In the below examples we’ll compare the number of specific nucleotides.
We’ll use the <strong>method</strong> <code>.count()</code>.
In this case we’ll calculate the nucleotide content outside of the <strong>condition</strong>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="co">#Compare A content of a and b</span></span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>nt <span class="op">=</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>nt_count_1 <span class="op">=</span> a.count(nt)</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>nt_count_2 <span class="op">=</span> b.count(nt)</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a><span class="cf">if</span> nt_count_1 <span class="op">==</span> nt_count_2:</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences have the same count of &quot;</span> <span class="op">+</span> nt)</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences do not have the same count of &quot;</span> <span class="op">+</span> nt)</span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="co">#Compare A content of c and b</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>nt <span class="op">=</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a>nt_count_1 <span class="op">=</span> c.count(nt)</span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>nt_count_2 <span class="op">=</span> b.count(nt)</span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a><span class="cf">if</span> nt_count_1 <span class="op">==</span> nt_count_2:</span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences have the same count of &quot;</span> <span class="op">+</span> nt)</span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences do not have the same count of &quot;</span> <span class="op">+</span> nt)</span></code></pre></div>
<p>You will notice both pieces of code say the compared sequences don’t have the same amounts of As.
However <code>b</code> &amp; <code>c</code> both have 2 As.
This result occurs as the <strong>method</strong> <code>.count()</code> is case sensitive.
Therefore, it’s counting 2 As for <code>b</code> and only 1 for <code>c</code>.</p>
<p>To fix this we’ll also use the <strong>method</strong> <code>.upper()</code>.
This is good practice with DNA sequences.</p>
<p>Edit your previous <strong>code cells</strong> to:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="co">#Compare A content of a and b</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>nt <span class="op">=</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>nt_count_1 <span class="op">=</span> a.upper().count(nt)</span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a>nt_count_2 <span class="op">=</span> b.upper().count(nt)</span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a><span class="cf">if</span> nt_count_1 <span class="op">==</span> nt_count_2:</span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences have the same count of &quot;</span> <span class="op">+</span> nt)</span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences do not have the same count of &quot;</span> <span class="op">+</span> nt)</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="co">#Compare A content of c and b</span></span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>nt <span class="op">=</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a>nt_count_1 <span class="op">=</span> c.upper().count(nt)</span>
<span id="cb131-4"><a href="#cb131-4" tabindex="-1"></a>nt_count_2 <span class="op">=</span> b.upper().count(nt)</span>
<span id="cb131-5"><a href="#cb131-5" tabindex="-1"></a><span class="cf">if</span> nt_count_1 <span class="op">==</span> nt_count_2:</span>
<span id="cb131-6"><a href="#cb131-6" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences have the same count of &quot;</span> <span class="op">+</span> nt)</span>
<span id="cb131-7"><a href="#cb131-7" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb131-8"><a href="#cb131-8" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;DNA sequences do not have the same count of &quot;</span> <span class="op">+</span> nt)</span></code></pre></div>
<p>When you run the above code, they will now be correct for our purposes.</p>
</div>
</div>
<div id="conditions-reflection" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Conditions reflection</h2>
<p><img src="figures/reflection.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Marvelous! <strong>If</strong> and <strong>else statements</strong> can be used to make decisions in our programs by comparing values.
This might be to check if two <strong>strings</strong> are the same, two <strong>lists</strong> contain the same number of items, or a <strong>string</strong> of nucleotide data has 100 or more bases.
We can think of them as switches.</p>
<p>Often we need to make these <strong>if</strong>/<strong>else</strong> comparisons for every item in a data structure and to do this we can use <strong>loops</strong>.</p>

</div>
</div>
<div id="loops" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Loops</h1>
<p><img src="figures/loopdeloo.png" width="20%" style="display: block; margin: auto;" /></p>
<p>We now have some knowledge of Python data structures (<strong>lists</strong>, <strong>sets</strong>, and <strong>dictionaries</strong>), what type of data they hold, and how we can access the elements within them.</p>
<p>How might we apply something to each element of a <strong>list</strong>? Perhaps we need to count the number of characters in each entry in the <strong>list</strong>?</p>
<p>Where we need to apply the same commands to every item in a data structure, we can use a <strong>loop</strong>. This means that we do not need to manually apply the commands to every item in the <strong>list</strong>, one at a time.</p>
<p>There are several types of <strong>loop</strong>; we will cover some of the most important in this section.</p>
<p><strong>Note</strong>: Continue using the notebook <strong>“03-Programmatic_coding”</strong> for this chapter.</p>
<div id="for-loops" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> For Loops</h2>
<p><img src="figures/assembly_line_robot.png" width="20%" style="display: block; margin: auto;" /></p>
<p>One of the most important and most common type of <strong>loops</strong> is the <strong>for</strong> <strong>loop</strong>.</p>
<p>The <strong>for</strong> <strong>loop</strong> runs through a set of <strong>variables</strong> (such as those in our list) and applies a <strong>command</strong> (or series of commands) to each element once. This is the <strong>loop</strong> that you will most often encounter.</p>
<p>Imagine you have a bag of 10 potatoes that you need to peel and put into a pot.</p>
<center>
<img src="figures/potatoes.jpg" style="width:20.0%" /><img src="figures/boiling_pot.webp" style="width:20.0%" />
</center>
<p>Using some pseudocode we can imagine how this script might look:</p>
<ol style="list-style-type: decimal">
<li>from bag_of_potatoes pick up potato_01</li>
<li>peel potato_01</li>
<li>put potato_01 into pot</li>
<li>from bag_of_potatoes pick up potato_02</li>
<li>peel potato_02</li>
<li>put potato_02 into pot ….(and so on)</li>
</ol>
<p>You can see how inefficient this code is, especially if it was a particularly large bag of potatoes!</p>
<p>Instead, we can use a <strong>for</strong> <strong>loop</strong> to recycle the code.</p>
<ol style="list-style-type: decimal">
<li><strong>for</strong> each potato in bag_of_potatoes:
<ol start="2" style="list-style-type: decimal">
<li>peel potato</li>
<li>put potato into pot</li>
</ol></li>
</ol>
<p>This <strong>loop</strong> would run until the bag of potatoes is empty, achieving the job in just three lines of code.</p>
<p>This pseudocode is actually very similar to the required Python syntax. The generic format of a <strong>for</strong> <strong>loop</strong> is:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="cf">for</span> <span class="op">&lt;</span>value<span class="op">&gt;</span> <span class="kw">in</span> <span class="op">&lt;</span>data_structure<span class="op">&gt;</span>:</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>  do something</span></code></pre></div>
<p>Note the colon (<code>:</code>) starting the loop and the tab indent of any commands inside the loop.</p>
<div id="loop-through-dna-nucleotides" class="section level3" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Loop through DNA nucleotides</h3>
<p><img src="figures/loop_thru_dna.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>For loops</strong> are extremely useful when we have a lot of values (for example, in a <strong>list</strong>) and we need to apply some commands to all of them.</p>
<p>For demonstrative purposes the first code we will use will move through the DNA string, printing each base to the screen.</p>
<p>Run the below code.</p>
<p><strong>Note</strong>: Ensure lines inside a <strong>for loop</strong> are indented.
Thankfully <code>jupyter-notebook</code> will automate a lot of this for you.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="co">#DNA string variable, yours does not need to be exactly the same</span></span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>DNA_string <span class="op">=</span> <span class="st">&quot;ATTCGAAGTCGTGTAGTACCGCGTATA&quot;</span></span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a><span class="co">#Loop through each base in the string</span></span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a><span class="cf">for</span> base <span class="kw">in</span> DNA_string:</span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>  <span class="co">#Print the current base</span></span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>  <span class="bu">print</span>(base)</span></code></pre></div>
<p>We can see from the output that the <strong>loop</strong> allows us to process each base in the string separately; in this case by printing them individually.</p>
<p><strong>Note</strong>: The <strong>loop variable name</strong> <code>base</code> is arbitrary and chosen by us.</p>
</div>
<div id="complement-a-dna-sequence" class="section level3" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Complement a DNA sequence</h3>
<p><img src="figures/complement.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Next, let’s use this <strong>loop</strong> functionality to do something useful to each base such as converting each nucleotide to the appropriate complement base.</p>
<p>For this, we will use a <strong>dictionary</strong> to swap each base for the complement. Recall that a <strong>dictionary</strong> has a <strong>key</strong> and <strong>value</strong> for each entry. We can define the ‘standard’ base as the <strong>key</strong>, and the ‘complement’ as the <strong>value</strong>.</p>
<p>Create and run the below code in a new <strong>code cell</strong>.
With the code we first create the <strong>dictionary</strong> holding the complementary pairs of bases.
This needs to come before the <strong>for loop</strong>.</p>
<p><strong>Note</strong>: Each of the four lines of the <strong>dictionary</strong> need to have a leading TAB character.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="co">#Complement</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a><span class="co">#DNA string variable, yours does not need to be exactly the same</span></span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>DNA_string <span class="op">=</span> <span class="st">&quot;ATTCGAAGTCGTGTAGTACCGCGTATA&quot;</span></span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a><span class="co">#Define our dictionary of complements</span></span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a>complements <span class="op">=</span> {</span>
<span id="cb134-7"><a href="#cb134-7" tabindex="-1"></a>  <span class="st">&quot;A&quot;</span> : <span class="st">&quot;T&quot;</span>,</span>
<span id="cb134-8"><a href="#cb134-8" tabindex="-1"></a>  <span class="st">&quot;T&quot;</span> : <span class="st">&quot;A&quot;</span>,</span>
<span id="cb134-9"><a href="#cb134-9" tabindex="-1"></a>  <span class="st">&quot;G&quot;</span> : <span class="st">&quot;C&quot;</span>,</span>
<span id="cb134-10"><a href="#cb134-10" tabindex="-1"></a>  <span class="st">&quot;C&quot;</span> : <span class="st">&quot;G&quot;</span></span>
<span id="cb134-11"><a href="#cb134-11" tabindex="-1"></a>}</span>
<span id="cb134-12"><a href="#cb134-12" tabindex="-1"></a></span>
<span id="cb134-13"><a href="#cb134-13" tabindex="-1"></a><span class="co">#Loop through each base in the string</span></span>
<span id="cb134-14"><a href="#cb134-14" tabindex="-1"></a><span class="cf">for</span> base <span class="kw">in</span> DNA_string:</span>
<span id="cb134-15"><a href="#cb134-15" tabindex="-1"></a>  <span class="co">#Print the complemented base</span></span>
<span id="cb134-16"><a href="#cb134-16" tabindex="-1"></a>  <span class="bu">print</span>(complements[base])</span></code></pre></div>
<p>The code will print out the complementary base for each iteration of the loop.</p>
<p>Most likely we won’t want our output to consist of separate bases on their own lines.
We can therefore build up an ‘output <strong>string</strong>’ to format the complemented sequence.
The complemented base is added to the <strong>variable</strong> <code>complement_DNA</code> each time and the whole <strong>string</strong> is printed at the end.</p>
<p>Edit, your previous code to the following:</p>
<p><strong>Note:</strong> The <strong>variable</strong> <code>complement_DNA</code> needs to be created before the <strong>for loop</strong> is run.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="co">#Complement</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a><span class="co">#DNA string variable, yours does not need to be exactly the same</span></span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a>DNA_string <span class="op">=</span> <span class="st">&quot;ATTCGAAGTCGTGTAGTACCGCGTATA&quot;</span></span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a><span class="co">#Define our dictionary of complements</span></span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a>complements <span class="op">=</span> {</span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a>  <span class="st">&quot;A&quot;</span> : <span class="st">&quot;T&quot;</span>,</span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a>  <span class="st">&quot;T&quot;</span> : <span class="st">&quot;A&quot;</span>,</span>
<span id="cb135-9"><a href="#cb135-9" tabindex="-1"></a>  <span class="st">&quot;G&quot;</span> : <span class="st">&quot;C&quot;</span>,</span>
<span id="cb135-10"><a href="#cb135-10" tabindex="-1"></a>  <span class="st">&quot;C&quot;</span> : <span class="st">&quot;G&quot;</span></span>
<span id="cb135-11"><a href="#cb135-11" tabindex="-1"></a>}</span>
<span id="cb135-12"><a href="#cb135-12" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" tabindex="-1"></a><span class="co">#Create an empty string to add the complemented bases to</span></span>
<span id="cb135-14"><a href="#cb135-14" tabindex="-1"></a>complement_DNA <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb135-15"><a href="#cb135-15" tabindex="-1"></a></span>
<span id="cb135-16"><a href="#cb135-16" tabindex="-1"></a><span class="co">#Loop through each base in the string</span></span>
<span id="cb135-17"><a href="#cb135-17" tabindex="-1"></a><span class="cf">for</span> base <span class="kw">in</span> DNA_string:</span>
<span id="cb135-18"><a href="#cb135-18" tabindex="-1"></a>  <span class="co">#Print the complemented base</span></span>
<span id="cb135-19"><a href="#cb135-19" tabindex="-1"></a>  <span class="co">#print(complements[base])</span></span>
<span id="cb135-20"><a href="#cb135-20" tabindex="-1"></a>  <span class="co">#Add the complemented base to the output string</span></span>
<span id="cb135-21"><a href="#cb135-21" tabindex="-1"></a>  complement_DNA <span class="op">=</span> complement_DNA <span class="op">+</span> complements[base]</span>
<span id="cb135-22"><a href="#cb135-22" tabindex="-1"></a></span>
<span id="cb135-23"><a href="#cb135-23" tabindex="-1"></a><span class="co">#Print the output string</span></span>
<span id="cb135-24"><a href="#cb135-24" tabindex="-1"></a><span class="bu">print</span>(complement_DNA)</span></code></pre></div>
<p>Now you have a <strong>variable</strong> containing the complemented sequences.</p>
</div>
<div id="reverse-complement-a-dna-sequence" class="section level3" number="11.1.3">
<h3><span class="header-section-number">11.1.3</span> Reverse-complement a DNA sequence</h3>
<p><img src="figures/reverse_complement.png" width="15%" style="display: block; margin: auto;" /></p>
<p>To generate the reverse complement we can use Python’s built in <code>reversed()</code> <strong>function</strong> to reverse the <strong>string</strong>.
This reversed <strong>string</strong> can then be used in the complementation.
Copy your previous complementation code into a new <strong>code cell</strong>.
Edit it to the below and run it.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="co">#Reverse complement</span></span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a><span class="co">#DNA string variable, yours does not need to be exactly the same</span></span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>DNA_string <span class="op">=</span> <span class="st">&quot;ATTCGAAGTCGTGTAGTACCGCGTATA&quot;</span></span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a><span class="co">#Define our dictionary of complements</span></span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>complements <span class="op">=</span> {</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a>  <span class="st">&quot;A&quot;</span> : <span class="st">&quot;T&quot;</span>,</span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>  <span class="st">&quot;T&quot;</span> : <span class="st">&quot;A&quot;</span>,</span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a>  <span class="st">&quot;G&quot;</span> : <span class="st">&quot;C&quot;</span>,</span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a>  <span class="st">&quot;C&quot;</span> : <span class="st">&quot;G&quot;</span></span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a>}</span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a></span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a><span class="co">#Create an empty string to add the complemented bases to</span></span>
<span id="cb136-14"><a href="#cb136-14" tabindex="-1"></a>rc_DNA <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb136-15"><a href="#cb136-15" tabindex="-1"></a></span>
<span id="cb136-16"><a href="#cb136-16" tabindex="-1"></a><span class="co">#Loop through each base in the reversed string</span></span>
<span id="cb136-17"><a href="#cb136-17" tabindex="-1"></a><span class="cf">for</span> base <span class="kw">in</span> <span class="bu">reversed</span>(DNA_string):</span>
<span id="cb136-18"><a href="#cb136-18" tabindex="-1"></a>  <span class="co">#Add the complemented base to the output string</span></span>
<span id="cb136-19"><a href="#cb136-19" tabindex="-1"></a>  rc_DNA <span class="op">=</span> rc_DNA <span class="op">+</span> complements[base]</span>
<span id="cb136-20"><a href="#cb136-20" tabindex="-1"></a></span>
<span id="cb136-21"><a href="#cb136-21" tabindex="-1"></a><span class="co">#Print the output string</span></span>
<span id="cb136-22"><a href="#cb136-22" tabindex="-1"></a><span class="bu">print</span>(rc_DNA)</span></code></pre></div>
<p>Running this new code will produce the reverse complement of our original DNA sequence.</p>
</div>
<div id="transcription-challenge" class="section level3" number="11.1.4">
<h3><span class="header-section-number">11.1.4</span> Transcription challenge</h3>
<p><img src="figures/transcription.png" width="25%" style="display: block; margin: auto;" /></p>
<p>In a new <strong>code cell</strong> create and run code to transcribe the DNA (<strong>“DNA_string”</strong>) to a RNA sequence.
When a single strand of DNA is transcribed the resulting RNA strand is complemented with the relevant RNA bases.
For example, the DNA sequence <strong>“ACGT”</strong> will become the RNA sequence <strong>“UGCA”</strong>.</p>
<p>Give this a good attempt, ensuring you copy and paste old code.</p>
<p>The solution is in the below expandable box if you want to check your code or you need a quick hint.</p>
<div class="webex-solution">
<button>
Transcribe loop
</button>
<div class="sourceCode" id="cb137"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="co">#Transcribe</span></span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a><span class="co">#DNA string variable, yours does not need to be exactly the same</span></span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>DNA_string <span class="op">=</span> <span class="st">&quot;ATTCGAAGTCGTGTAGTACCGCGTATA&quot;</span></span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a><span class="co">#Define our dictionary of transcripts</span></span>
<span id="cb137-6"><a href="#cb137-6" tabindex="-1"></a>transcripts <span class="op">=</span> {</span>
<span id="cb137-7"><a href="#cb137-7" tabindex="-1"></a>  <span class="st">&quot;A&quot;</span> : <span class="st">&quot;U&quot;</span>,</span>
<span id="cb137-8"><a href="#cb137-8" tabindex="-1"></a>  <span class="st">&quot;T&quot;</span> : <span class="st">&quot;A&quot;</span>,</span>
<span id="cb137-9"><a href="#cb137-9" tabindex="-1"></a>  <span class="st">&quot;G&quot;</span> : <span class="st">&quot;C&quot;</span>,</span>
<span id="cb137-10"><a href="#cb137-10" tabindex="-1"></a>  <span class="st">&quot;C&quot;</span> : <span class="st">&quot;G&quot;</span></span>
<span id="cb137-11"><a href="#cb137-11" tabindex="-1"></a>}</span>
<span id="cb137-12"><a href="#cb137-12" tabindex="-1"></a></span>
<span id="cb137-13"><a href="#cb137-13" tabindex="-1"></a><span class="co">#Create an empty string to add the RNA bases to</span></span>
<span id="cb137-14"><a href="#cb137-14" tabindex="-1"></a>RNA <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb137-15"><a href="#cb137-15" tabindex="-1"></a></span>
<span id="cb137-16"><a href="#cb137-16" tabindex="-1"></a><span class="co">#Loop through each base in the string</span></span>
<span id="cb137-17"><a href="#cb137-17" tabindex="-1"></a><span class="cf">for</span> base <span class="kw">in</span> DNA_string:</span>
<span id="cb137-18"><a href="#cb137-18" tabindex="-1"></a>  <span class="co">#Add the RNA base to the output string</span></span>
<span id="cb137-19"><a href="#cb137-19" tabindex="-1"></a>  RNA <span class="op">=</span> RNA <span class="op">+</span> transcripts[base]</span>
<span id="cb137-20"><a href="#cb137-20" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" tabindex="-1"></a><span class="co">#Print the output string</span></span>
<span id="cb137-22"><a href="#cb137-22" tabindex="-1"></a><span class="bu">print</span>(RNA)</span></code></pre></div>
</div>
</div>
</div>
<div id="while-loops" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> While loops</h2>
<p><img src="figures/while_loop.png" width="20%" style="display: block; margin: auto;" /></p>
<p>The other type of <strong>loop</strong> you might encounter is the <strong>while</strong> <strong>loop</strong>. A <strong>while</strong> <strong>loop</strong> continues to run <strong>while</strong> a statement remains <strong>True</strong>. For example, returning to our bag of potatoes, a <strong>while</strong> <strong>loop</strong> for the same job might look like this:</p>
<ol style="list-style-type: decimal">
<li>while bag_of_potatoes is not empty :
<ol start="2" style="list-style-type: decimal">
<li>peel potato</li>
<li>put potato into pot</li>
</ol></li>
</ol>
<p>This <strong>loop</strong> would run until the last potato has been prepared, at which point the <strong>while statement</strong> would return <strong>False</strong> and the <strong>loop</strong> would be stopped.</p>
<p>The generic format of a <strong>while</strong> <strong>loop</strong> is as follows:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="cf">while</span> <span class="op">&lt;</span>condition<span class="op">&gt;</span> :</span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>  do something</span></code></pre></div>
<p>Below are a few examples of <strong>while loops</strong> you can create and run.
Ensure you understand why the code is giving you the output.
If you are not sure please ask a demonstrator.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="co">#While loop</span></span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a><span class="cf">while</span> x <span class="op">&lt;</span> <span class="dv">10</span>:</span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>  x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a>x</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a><span class="co">#Create new list containing 1 to add loop data to</span></span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a>num_list <span class="op">=</span> [x]</span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a><span class="co">#While loop</span></span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a><span class="cf">while</span> x <span class="op">&gt;=</span> <span class="op">-</span><span class="dv">9</span>:</span>
<span id="cb140-6"><a href="#cb140-6" tabindex="-1"></a>  x <span class="op">=</span> x <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb140-7"><a href="#cb140-7" tabindex="-1"></a>  num_list.append(x)</span>
<span id="cb140-8"><a href="#cb140-8" tabindex="-1"></a>num_list</span></code></pre></div>
<div class="sourceCode" id="cb141"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="co">#Find first number after 101 that is divisible by 37</span></span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>x  <span class="op">=</span> <span class="dv">101</span></span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a><span class="co">#Use modulus operator to end loop when the remainder from division is 0</span></span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a><span class="cf">while</span> (x <span class="op">%</span> <span class="dv">37</span>) <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>  x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a>x</span></code></pre></div>
<p><strong>While</strong> <strong>loops</strong> are much less commonly used and we will not spend any more time on them in this book. Hopefully you can see the difference between a <strong>for</strong> <strong>loop</strong> and a <strong>while</strong> <strong>loop</strong> and have an idea of how they run.</p>
</div>
<div id="further-control-statements" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Further control statements</h2>
<p><img src="figures/controller.png" width="15%" style="display: block; margin: auto;" /></p>
<p>You can control <strong>loops</strong> further using <strong>break</strong>, <strong>continue</strong> and <strong>pass</strong> <strong>statements</strong>.
We won’t cover these in this tutorial as they are much less common.
You can find good resources covering <strong>Python control statements</strong> <a href="https://www.tutorialspoint.com/python/python_loop_control.htm">online</a>.</p>
</div>
<div id="loop-reflection" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Loop reflection</h2>
<p><img src="figures/reflection.png" width="20%" style="display: block; margin: auto;" /></p>
<p>Perfect! <strong>Loops</strong> are really useful when we need to perform the same task, or commands, over-and-over again.
Where we have data stored in a data structure such as a <strong>list</strong>, we can apply something to everything in the <strong>list</strong> using a <strong>for</strong> <strong>loop</strong>.
This is an efficient way to code as it means we do not need to duplicate the instructions.</p>

</div>
</div>



<div id="reading_seq_data" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Reading sequence data</h1>
<p><img src="figures/biopython_logo.png" width="20%" style="display: block; margin: auto;" /></p>
<p><strong>Biopython</strong> is a suite of <strong>libraries</strong> and tools designed for analysis of biological datasets in Python, largely centred around the processing of DNA sequence data.</p>
<p>You can find much more information about <strong>Biopython</strong> on the <a href="https://biopython.org/">website</a>.</p>
<p>During this section on <strong>Biopython</strong> we are going to be using the <strong>SeqIO</strong> <strong>module</strong>.</p>
<p>The knowledge and approaches from the previous chapters will now be used to process some genomic DNA sequence data.</p>
<p>Create a new notebook called <strong>“04-Practical_python”</strong>. Use this notebook in this chapter.</p>
<div id="seqio" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> SeqIO</h2>
<p><img src="figures/seqio.png" width="15%" style="display: block; margin: auto;" /></p>
<p>The <strong>SeqIO</strong> tools are the main Sequence Input/Output interface for <strong>Biopython</strong>. It provides a relatively simple, uniform interface for working with various types of DNA sequence files. The <strong>module</strong> reads raw sequence files (such as .FASTQ files you will likely receive from your sequencing facility) and converts them to a Python readable format; a <a href="https://biopython.org/wiki/SeqRecord">SeqRecord</a> <strong>class</strong>.</p>
</div>
<div id="the-fastq-format" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> The FASTQ format</h2>
<p><img src="figures/fastq.png" width="10%" style="display: block; margin: auto;" /></p>
<p>One of the most common types of DNA sequence data files you will be working with is the <a href="https://en.wikipedia.org/wiki/FASTQ_format">FASTQ</a> file. FASTQ files contain multiple DNA sequences. Each one might be a single short read from an Illumina sequencer. The file can contain thousands or millions of sequences depending on which sequencer was used to produce it.</p>
<p>FASTQ files have a very specific format and hold three important pieces of information.</p>
<p>The file has a repetitive structure of four distinct components:</p>
<ul>
<li>A unique sequence identifier (ID)
<ul>
<li>Always starts with the <strong>“@”</strong> symbol followed by a string of numbers and letters</li>
<li>This contains details such as the sequencer that produced the data, the run number, and an index adapter used on the sample.</li>
</ul></li>
<li>The DNA nucleotide sequence
<ul>
<li>Shown as a string of ATGC characters</li>
</ul></li>
<li>A small spacer
<ul>
<li>Consisting of the <strong>“+”</strong> character which separates the sequence from the quality scores</li>
</ul></li>
<li>The quality score associated with each nucleotide
<ul>
<li>The quality score associated with each nucleotide above is ASCII encoded with each symbol representing a quality score from 0 to 40 (higher being better).</li>
<li>This line is not meant to be easily human-readable.</li>
</ul></li>
</ul>
<p>Below is an example of a single FASTQ entry:</p>
<!-- -->
<pre><code>@MISEQ:42:000000000-A8DD3:1:1101:15046:1468
TTCACATCCTGACCATTCAGTTGAGCAAAATAGTTCTTCAGT
+
CCFFFFFGHHHHJIJJJJIJJJIIJJJJIIIJJGFIIIJEDD</code></pre>
</div>
<div id="read-a-fastq-file-into-python" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Read a FASTQ file into Python</h2>
<p><img src="figures/Leucoraja%20erinacea.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>Scenario:</strong> You have just received some FASTQ formatted data back from your sequencing facility. The data was generated using a shotgun, whole-genome sequencing approach to sequence the genome of the undulate ray (<em>Raja undulata</em>).</p>
<p>We are going to read the data into Python, ready to do some data processing and analyses.</p>
<div id="loading-the-python-library" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Loading the python library</h3>
<p><img src="figures/library_1.png" width="15%" style="display: block; margin: auto;" /></p>
<p>We need to load a <strong>Python library</strong>:</p>
<ul>
<li><strong>Biopython</strong> (<code>Bio</code>): a suite of bioinformatics focused Python tools.
<ul>
<li>From this <strong>library</strong> we will import the <strong>module</strong> <code>SeqIO</code></li>
</ul></li>
</ul>
<p>To load (<strong>import</strong>) this <strong>library</strong> and <strong>module</strong> add the following towards the top of your notebook.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="co">#Import libraries and modules</span></span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span></code></pre></div>
<p>It is also good to create a <strong>variable</strong> called “wd” that contains your working directory when working with files. Set this <strong>variable</strong> to your <strong>“Python_course_data”</strong> filepath by adding a version of the following:</p>
<p><strong>Note</strong>: The below code is an instructor’s directory. Ensure to set your own. A <a href="#working-directory">previous command</a> may be useful.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="co">#Working directory</span></span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>wd <span class="op">=</span> <span class="st">&quot;/pub14/tea/nsc201/Python_course_data&quot;</span></span></code></pre></div>
</div>
<div id="read-a-file-of-sequence-data" class="section level3" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Read a file of sequence data</h3>
<p><img src="figures/mobile_read.png" width="10%" style="display: block; margin: auto;" /></p>
<p>We are going to use <code>SeqIO</code>’s (which stands for sequence in/out) <code>parse()</code> <strong>function</strong> which splits the FASTQ file into its separate components.</p>
<p>We’ll store the information in the variable called <code>R_undulata_data</code>.</p>
<p><code>SeqIO.parse</code> requires two arguments:</p>
<ul>
<li>The filepath of the file to be read.</li>
<li>The format of that file.</li>
</ul>
<div class="sourceCode" id="cb145"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="co">#Parse file</span></span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span></code></pre></div>
</div>
<div id="fastq-record-elements" class="section level3" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Fastq record elements</h3>
<p><img src="figures/elements.png" width="15%" style="display: block; margin: auto;" /></p>
<p>We can then look through the file using a <strong>for loop</strong>. Each of the four-unit repeats of the FASTQ file is read as a separate ‘record element’ and we can access them in the script.</p>
<p>When looping through the data the different record elements are called by using the <strong>loop variable</strong> and a suffix for the type of element. The suffixes of interest are:</p>
<ul>
<li><strong><code>.id</code></strong>: The sequence identifier.</li>
<li><strong><code>.seq</code></strong>: The sequence.</li>
<li><strong><code>.letter_annotations["phred_quality"]</code></strong>: A list of the phred quality scores (numbers).</li>
</ul>
<p>We can print this information for each record with the following <strong>for loop</strong>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="co">#Print IDs and sequences</span></span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>  <span class="bu">print</span>(record.<span class="bu">id</span>)</span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>  <span class="bu">print</span>(record.seq)</span></code></pre></div>
</div>
</div>
<div id="reading-and-using-files" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Reading and using files</h2>
<p><img src="figures/disappear.png" width="15%" style="display: block; margin: auto;" /></p>
<p>A peculiarity of <strong>Python</strong> is that when a file has been read and then used it is removed from memory.</p>
<p>To demonstrate, create and run the three below <strong>code cells</strong>:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a><span class="co">#Parse file</span></span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="co">#Print IDs</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>  <span class="bu">print</span>(record.<span class="bu">id</span>)</span></code></pre></div>
<div class="sourceCode" id="cb149"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="co">#Print sequences</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a>  <span class="bu">print</span>(record.seq)</span></code></pre></div>
<p>Running them from top to bottom you will find that only the second <strong>code cell</strong> gives you output. The data in the variable <strong>R_undulata_data</strong> was used by the <strong>for loop</strong> in the 2nd code cell. Because it is a <strong>python variable</strong> created by <strong>reading</strong> a file the information is then removed. Once you have <strong>read</strong> information and used it once you need to <strong>reread</strong> the information to use it again.</p>
<p>Try running the code from the 3 <strong>code cells</strong> in 1 <strong>code cell</strong>.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="co">#Parse file</span></span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb150-3"><a href="#cb150-3" tabindex="-1"></a><span class="co">#Print IDs</span></span>
<span id="cb150-4"><a href="#cb150-4" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb150-5"><a href="#cb150-5" tabindex="-1"></a>  <span class="bu">print</span>(record.<span class="bu">id</span>)</span>
<span id="cb150-6"><a href="#cb150-6" tabindex="-1"></a><span class="co">#Print sequences</span></span>
<span id="cb150-7"><a href="#cb150-7" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb150-8"><a href="#cb150-8" tabindex="-1"></a>  <span class="bu">print</span>(record.seq)</span></code></pre></div>
<p>Again, you will only get the <strong>ID</strong> information.</p>
<p>However, if you read the file again after using the <strong>ID</strong> information you can get both.</p>
<p><strong>Note</strong>: After running the below you will need to scroll through a lot of <strong>IDs</strong> to see the <strong>Sequences</strong>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="co">#Parse file</span></span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb151-3"><a href="#cb151-3" tabindex="-1"></a><span class="co">#Print IDs</span></span>
<span id="cb151-4"><a href="#cb151-4" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb151-5"><a href="#cb151-5" tabindex="-1"></a>  <span class="bu">print</span>(record.<span class="bu">id</span>)</span>
<span id="cb151-6"><a href="#cb151-6" tabindex="-1"></a><span class="co">#Parse file</span></span>
<span id="cb151-7"><a href="#cb151-7" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb151-8"><a href="#cb151-8" tabindex="-1"></a><span class="co">#Print sequences</span></span>
<span id="cb151-9"><a href="#cb151-9" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb151-10"><a href="#cb151-10" tabindex="-1"></a>  <span class="bu">print</span>(record.seq)</span></code></pre></div>
<p>This is an important concept so we’ll touch on it again later.</p>
</div>
<div id="modifying-reads" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Modifying reads</h2>
<p><img src="figures/DNA_translation.png" width="15%" style="display: block; margin: auto;" /></p>
<p>We can perform operations on each of the record elements.</p>
<p><strong>Biopython</strong> has a built in <code>.translate()</code> <strong>method</strong> to convert nucleotide sequences into protein sequences. In this case we are not considering reading frames and we’ll likely have lots of non-coding data.</p>
<p>See this in action with the below code.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a><span class="co">#Translate</span></span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a><span class="co">#Parse file</span></span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a><span class="co">#Print IDs and translated sequences</span></span>
<span id="cb152-5"><a href="#cb152-5" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb152-6"><a href="#cb152-6" tabindex="-1"></a>  <span class="bu">print</span>(record.<span class="bu">id</span>)</span>
<span id="cb152-7"><a href="#cb152-7" tabindex="-1"></a>  <span class="bu">print</span>(record.seq.translate())</span></code></pre></div>
</div>
<div id="count-reads" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Count reads</h2>
<p><img src="figures/count.png" width="15%" style="display: block; margin: auto;" /></p>
<p>We can implement a counter to tally the total number of reads in the file.</p>
<p>Create the below <strong>for</strong> <strong>loop</strong> to count the number of reads/records:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a><span class="co">#Count reads/records</span></span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a><span class="co">#Parse file</span></span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a></span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a><span class="co">#Start a counter to track the number of reads/records</span></span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a>counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb153-7"><a href="#cb153-7" tabindex="-1"></a></span>
<span id="cb153-8"><a href="#cb153-8" tabindex="-1"></a><span class="co">#Count reads/records</span></span>
<span id="cb153-9"><a href="#cb153-9" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb153-10"><a href="#cb153-10" tabindex="-1"></a>  <span class="co">#Increase the counter by 1 each time it sees a new read</span></span>
<span id="cb153-11"><a href="#cb153-11" tabindex="-1"></a>  counter <span class="op">=</span> counter <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb153-12"><a href="#cb153-12" tabindex="-1"></a></span>
<span id="cb153-13"><a href="#cb153-13" tabindex="-1"></a><span class="co">#Save the number of reads/records for later use</span></span>
<span id="cb153-14"><a href="#cb153-14" tabindex="-1"></a>num_raw_reads <span class="op">=</span> counter</span>
<span id="cb153-15"><a href="#cb153-15" tabindex="-1"></a></span>
<span id="cb153-16"><a href="#cb153-16" tabindex="-1"></a><span class="co">#Print the information</span></span>
<span id="cb153-17"><a href="#cb153-17" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Raw sequence file has &quot;</span> <span class="op">+</span> <span class="bu">str</span>(num_raw_reads) <span class="op">+</span> <span class="st">&quot; sequence records.&quot;</span>)</span></code></pre></div>
</div>
<div id="reading-sequence-data-mcq-recap" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> Reading sequence data MCQ recap</h2>
<p><img src="figures/question_bubble_orange.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Superb! That is the end of this chapter. Ensure you are saving your <strong>notebook</strong> regularly.</p>
<p>For a quick recap, choose the correct option to complete the below sentences:</p>
<ol style="list-style-type: decimal">
<li>________ is a suite of Python <strong>libraries</strong> and tools, useful for analysing biological datasets.
<div id="radio_SRCEBQQFDK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_SRCEBQQFDK" value="answer"></input> <span><strong>Biopython</strong></span></label><label><input type="radio" autocomplete="off" name="radio_SRCEBQQFDK" value=""></input> <span><strong>Fastq</strong></span></label><label><input type="radio" autocomplete="off" name="radio_SRCEBQQFDK" value=""></input> <span><strong>Read</strong></span></label>
</div></li>
<li>Information on ________ files is lost once used.
<div id="radio_MHQJHHISJB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MHQJHHISJB" value=""></input> <span><strong>Biopython</strong></span></label><label><input type="radio" autocomplete="off" name="radio_MHQJHHISJB" value=""></input> <span><strong>Fastq</strong></span></label><label><input type="radio" autocomplete="off" name="radio_MHQJHHISJB" value="answer"></input> <span><strong>Read</strong></span></label>
</div></li>
<li>________ files have 4 elements per record/entry.
<div id="radio_LUPUCVLMVH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LUPUCVLMVH" value=""></input> <span><strong>Biopython</strong></span></label><label><input type="radio" autocomplete="off" name="radio_LUPUCVLMVH" value="answer"></input> <span><strong>Fastq</strong></span></label><label><input type="radio" autocomplete="off" name="radio_LUPUCVLMVH" value=""></input> <span><strong>Read</strong></span></label>
</div></li>
<li>The <strong>function</strong> ________ can read/parse fastq files.
<div id="radio_FZSCXKOZTD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FZSCXKOZTD" value=""></input> <span><strong><code>.seq</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_FZSCXKOZTD" value="answer"></input> <span><strong><code>SeqIO.parse()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_FZSCXKOZTD" value=""></input> <span><strong><code>.translate()</code></strong></span></label>
</div></li>
<li>The <code>SeqIO</code> <strong>method</strong> ________ can be used to translate DNA sequences to amino acid sequences.
<div id="radio_OZSEINSQKF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_OZSEINSQKF" value=""></input> <span><strong><code>.seq</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_OZSEINSQKF" value=""></input> <span><strong><code>SeqIO.parse()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_OZSEINSQKF" value="answer"></input> <span><strong><code>.translate()</code></strong></span></label>
</div></li>
<li>The sequence element in a parsed fastq file is referred to by the suffix ________.
<div id="radio_QGHUMLAXWE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QGHUMLAXWE" value="answer"></input> <span><strong><code>.seq</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_QGHUMLAXWE" value=""></input> <span><strong><code>SeqIO.parse()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_QGHUMLAXWE" value=""></input> <span><strong><code>.translate()</code></strong></span></label>
</div></li>
</ol>

</div>
</div>
<div id="modify_dna_data" class="section level1" number="13">
<h1><span class="header-section-number">13</span> Modifying DNA Data</h1>
<p><img src="figures/modify_dna.png" width="20%" style="display: block; margin: auto;" /></p>
<p>Suppose we want to filter raw sequence reads by some parameter.
For example, we could:</p>
<ul>
<li>Remove reads of a certain length.</li>
<li>Remove sections of a sequence such as PCR primers.</li>
</ul>
<p>In this chapter we will use our knowledge of <strong>loops</strong> and <strong>conditions</strong> to perform these tasks. Continue using <strong>“04-Practical_python”</strong> notebook.</p>
<div id="length-filtering" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Length filtering</h2>
<p><img src="figures/filter_2.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Using what we know, we will create code to remove/filter reads shorter than a specified read-length threshold from a FastQ file.</p>
<p>Write, run, and try to understand the below code.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a><span class="co">#Read in the fastq data</span></span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb154-3"><a href="#cb154-3" tabindex="-1"></a></span>
<span id="cb154-4"><a href="#cb154-4" tabindex="-1"></a><span class="co">#Initialise an empty list to hold the records that we want to keep</span></span>
<span id="cb154-5"><a href="#cb154-5" tabindex="-1"></a>wanted_sequences <span class="op">=</span> []</span>
<span id="cb154-6"><a href="#cb154-6" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" tabindex="-1"></a><span class="co">#Variable for choice of minimum length</span></span>
<span id="cb154-8"><a href="#cb154-8" tabindex="-1"></a><span class="co">#in this case we will choose 100</span></span>
<span id="cb154-9"><a href="#cb154-9" tabindex="-1"></a>min_len <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb154-10"><a href="#cb154-10" tabindex="-1"></a></span>
<span id="cb154-11"><a href="#cb154-11" tabindex="-1"></a><span class="co">#Loop through the fastq records</span></span>
<span id="cb154-12"><a href="#cb154-12" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb154-13"><a href="#cb154-13" tabindex="-1"></a>  <span class="co">#If condition to determine if sequence length is greater or equal to minimum length</span></span>
<span id="cb154-14"><a href="#cb154-14" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">len</span>(record.seq) <span class="op">&gt;=</span> min_len:</span>
<span id="cb154-15"><a href="#cb154-15" tabindex="-1"></a>    <span class="co">#Add the record to the list of records that meet the minimum length threshold</span></span>
<span id="cb154-16"><a href="#cb154-16" tabindex="-1"></a>    wanted_sequences.append(record)</span>
<span id="cb154-17"><a href="#cb154-17" tabindex="-1"></a></span>
<span id="cb154-18"><a href="#cb154-18" tabindex="-1"></a><span class="co">#Print statement to show number of reads retained after length filtering</span></span>
<span id="cb154-19"><a href="#cb154-19" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Found &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(wanted_sequences)) <span class="op">+</span> <span class="st">&quot; reads &gt;= &quot;</span> <span class="op">+</span> <span class="bu">str</span>(min_len) <span class="op">+</span> <span class="st">&quot;bp in length.&quot;</span>)</span></code></pre></div>
</div>
<div id="remove-pcr-primers" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Remove PCR primers</h2>
<p><img src="figures/scissors_2.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Often you may want to check your sequence file for PCR primers, and remove them when they are found.
Using a <strong>for</strong> <strong>loop</strong> to move through the sequence file, we can check each DNA sequence read for the presence of a pre-defined primer sequence.
If it is present, we’ll remove it.</p>
<p>We are going to check for the presence of the 13 nucleotide PCR primer “ACACTGCTGATCG” at the start of the reads using the <code>.startswith()</code> <strong>method</strong>.
This <strong>method</strong> checks whether a <strong>string</strong> starts with a particular sub-string and returns <strong>True</strong> or <strong>False</strong>.
It is very useful for checking for primer sequences in our data.</p>
<p>The input for this primer removal step will be the ‘wanted_sequences’ <strong>variable</strong> from the read filtering code (those of &gt;=100bp in length).</p>
<p>For demonstration purposes we will first run code that will tell us the number of sequences which have the PCR sequence present.</p>
<p><strong>Note</strong>: Below is the primer in triplet bases for ease of reading. Ensure you type it as one string with no spaces.</p>
<p><strong>ACA CTG CTG ATC G</strong></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a><span class="co">#Assign PCR sequence variable</span></span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a>pcr_seq <span class="op">=</span> <span class="st">&quot;ACACTGCTGATCG&quot;</span></span>
<span id="cb155-3"><a href="#cb155-3" tabindex="-1"></a><span class="co">#Initialise variable to sum number of records with PCR primer present</span></span>
<span id="cb155-4"><a href="#cb155-4" tabindex="-1"></a>pcr_records <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb155-5"><a href="#cb155-5" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" tabindex="-1"></a><span class="co">#Loop through the sequence records</span></span>
<span id="cb155-7"><a href="#cb155-7" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> wanted_sequences:</span>
<span id="cb155-8"><a href="#cb155-8" tabindex="-1"></a>  <span class="co">#Check whether the sequence starts with the primer sequence</span></span>
<span id="cb155-9"><a href="#cb155-9" tabindex="-1"></a>  <span class="cf">if</span> record.seq.startswith(pcr_seq):</span>
<span id="cb155-10"><a href="#cb155-10" tabindex="-1"></a>    pcr_records <span class="op">=</span> pcr_records <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb155-11"><a href="#cb155-11" tabindex="-1"></a></span>
<span id="cb155-12"><a href="#cb155-12" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Number of sequences with the PCR sequence present: &quot;</span> <span class="op">+</span> <span class="bu">str</span>(pcr_records))</span></code></pre></div>
<p>We have found that there are lots of sequences with the primer sequence present.
Now that we have identified their presence, let’s trim them off the start of the reads.</p>
<p>Create and run the below code in a new <strong>cell</strong>.
This will create a new <strong>variable</strong> “trimmed_sequences”.
This will contain records that have been:</p>
<ul>
<li>Filtered to remove sequences shorter than 100bp.</li>
<li>Trimmed to remove the PCR sequence (“ACACTGCTGATCG”).
<ul>
<li>Note, we are also keeping the untrimmed sequences that did not contain the PCR sequence.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb156"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a><span class="co">#Define a list to hold the trimmed sequences</span></span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>trimmed_sequences <span class="op">=</span> []</span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a><span class="co">#Assign PCR sequence variable</span></span>
<span id="cb156-4"><a href="#cb156-4" tabindex="-1"></a>pcr_seq <span class="op">=</span> <span class="st">&quot;ACACTGCTGATCG&quot;</span></span>
<span id="cb156-5"><a href="#cb156-5" tabindex="-1"></a><span class="co">#Initialise variable to sum number of records with PCR primer present</span></span>
<span id="cb156-6"><a href="#cb156-6" tabindex="-1"></a>pcr_records <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb156-7"><a href="#cb156-7" tabindex="-1"></a></span>
<span id="cb156-8"><a href="#cb156-8" tabindex="-1"></a><span class="co">#Loop through the sequence records</span></span>
<span id="cb156-9"><a href="#cb156-9" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> wanted_sequences:</span>
<span id="cb156-10"><a href="#cb156-10" tabindex="-1"></a>  <span class="co">#Check whether the sequence starts with the primer sequence</span></span>
<span id="cb156-11"><a href="#cb156-11" tabindex="-1"></a>  <span class="cf">if</span> record.seq.startswith(pcr_seq):</span>
<span id="cb156-12"><a href="#cb156-12" tabindex="-1"></a>    <span class="co">#Subset read from position 14 onwards and add to trimmed_sequences</span></span>
<span id="cb156-13"><a href="#cb156-13" tabindex="-1"></a>    <span class="co">#This will remove the first 13 bases, the PCR sequence</span></span>
<span id="cb156-14"><a href="#cb156-14" tabindex="-1"></a>    trimmed_sequences.append(record[<span class="dv">13</span>:])</span>
<span id="cb156-15"><a href="#cb156-15" tabindex="-1"></a>    pcr_records <span class="op">=</span> pcr_records <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb156-16"><a href="#cb156-16" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb156-17"><a href="#cb156-17" tabindex="-1"></a>    <span class="co">#Add untrimmed sequence to trimmed_sequences</span></span>
<span id="cb156-18"><a href="#cb156-18" tabindex="-1"></a>    <span class="co">#this is because there is no PCR sequence present to trim off</span></span>
<span id="cb156-19"><a href="#cb156-19" tabindex="-1"></a>    trimmed_sequences.append(record)</span>
<span id="cb156-20"><a href="#cb156-20" tabindex="-1"></a></span>
<span id="cb156-21"><a href="#cb156-21" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Number of sequences with the PCR sequence removed: &quot;</span> <span class="op">+</span> <span class="bu">str</span>(pcr_records))</span>
<span id="cb156-22"><a href="#cb156-22" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total number of filtered and trimmed reads: &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(trimmed_sequences)))</span></code></pre></div>
</div>
<div id="modifying-dna-reflection" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Modifying DNA reflection</h2>
<p><img src="figures/reflection.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Outstanding! In this chapter we used your knowledge of reading FASTQ files, to:</p>
<ul>
<li>Loop through the data.</li>
<li>Use conditions to check certain characteristics of the data.</li>
<li>Filter out short reads.</li>
<li>Trim off PCR primers.</li>
</ul>
<p>With this we’ve created a pipeline.</p>
<p>In the next chapter we’ll learn how to write data out and store it in a new file.</p>

</div>
</div>
<div id="reading_writing" class="section level1" number="14">
<h1><span class="header-section-number">14</span> Reading and writing files</h1>
<p><img src="figures/contract.png" width="20%" style="display: block; margin: auto;" /></p>
<p>Often we want to <strong>read</strong> from a data file, perform some task with the data, and <strong>write</strong> out
another file.</p>
<p>To <strong>read/write</strong> a file in Python we <strong>open</strong> a data stream using a statement such as:</p>
<p>(don’t add this line to the notebook)</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(path_to_file, <span class="st">&#39;open_mode&#39;</span>) <span class="im">as</span> input_file:</span></code></pre></div>
<p>There are two parts to consider:</p>
<ul>
<li><p>open(path_to_file, mode)</p></li>
<li><p>with(…<code>&lt;input-file&gt;</code>…) as input_file:</p></li>
</ul>
<p>Create a new notebook with the name <strong>“05-Reading_and_writing”</strong>. We’ll learn to <strong>open</strong>, <strong>read</strong>, and <strong>write</strong> files with it.</p>
<div id="open" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> ‘open’</h2>
<p><img src="figures/open_file.png" width="15%" style="display: block; margin: auto;" /></p>
<p>The <code>open</code> <strong>function</strong> asks the Python interpreter to make a link to the specified file and <strong>open</strong> a data stream.
We need to specify the <strong>mode</strong> by which the file is <strong>opened</strong>.
The most common <strong>modes</strong> are:</p>
<ul>
<li><strong>‘w’ - WRITE</strong>: <strong>Open</strong> for writing. If the file doesn’t exist, it will be created. If it does exist, it will be replaced by a new, empty file.</li>
<li><strong>‘r’ - READ</strong>: <strong>Open</strong> an existing file for reading.</li>
<li><strong>‘a’ - APPEND</strong>: <strong>Open</strong> for reading and writing. If the file doesn’t exist, it will be created. If it does exist, new data will be added to the end of the existing file.</li>
</ul>
<p>There are other modes but these three cover the majority of file tasks.</p>
</div>
<div id="read-a-data-file" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Read a data file</h2>
<p><img src="figures/reading_glasses.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Create your first coding <strong>cell</strong> in your <strong>“05-Reading_and_writing”</strong> notebook. Add the location of your working directory and load the <strong>SeqIO library</strong>.</p>
<p><strong>Note</strong>: Ensure <code>wd =</code> is set to <strong>your</strong> working directory (not <code>nsc201</code>).</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a>wd <span class="op">=</span> <span class="st">&quot;/pub14/tea/nsc201/Python_course_data&quot;</span></span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span></code></pre></div>
<p>Add the below code to <strong>read</strong> the provided file <strong>“patients_data.csv”</strong>.
We have 2 new python words in the code:</p>
<ul>
<li><strong><code>with</code></strong>: This python <strong>statement</strong> allows us to carry out further tasks <strong>with</strong> some data.
<ul>
<li>In this case we are using data <strong>read</strong> from the file <strong>“patients_gut_data.csv”</strong>.</li>
<li>This is then passed to a <strong>for loop statement</strong> to print each line of the file.</li>
<li>This is known as a <strong>data stream</strong>.</li>
</ul></li>
<li><strong><code>as</code></strong>: This python <strong>keyword</strong> creates an alias for our <code>with</code> <strong>statement</strong>.
<ul>
<li>In the below code we <strong>open</strong> a file and store the read information as a <strong>variable</strong> called <code>input_file</code>.</li>
<li>This variable name is arbitrary and chosen by the user.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a><span class="co">#Open input file for reading and add to a data stream</span></span>
<span id="cb159-2"><a href="#cb159-2" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(wd <span class="op">+</span> <span class="st">&quot;/patients_gut_data.csv&quot;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb159-3"><a href="#cb159-3" tabindex="-1"></a>  <span class="co">#Loop through lines/rows of input_file</span></span>
<span id="cb159-4"><a href="#cb159-4" tabindex="-1"></a>  <span class="cf">for</span> row <span class="kw">in</span> input_file:</span>
<span id="cb159-5"><a href="#cb159-5" tabindex="-1"></a>    <span class="bu">print</span>(row)</span></code></pre></div>
<p>When you run the code the file contents will be printed. We will learn to organise this output in a more usable way in the supplementary material.</p>
</div>
<div id="write-data-to-a-file" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Write data to a file</h2>
<p><img src="figures/write_feather.png" width="10%" style="display: block; margin: auto;" /></p>
<p>Copy, paste, and edit your code to add a second <strong>data stream</strong>.
This is done by first opening a new file for <strong>write</strong> access.</p>
<p>Looping through the <code>input_file</code>, for each row/line, we’ll add the string “Study_2022,” to the start.
This modified line/row will be <strong>written</strong> to the output file using the <code>.write()</code> <strong>method</strong>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="co">#Create output file for writing and add to a data stream</span></span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(wd <span class="op">+</span> <span class="st">&quot;/patients_modified.csv&quot;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> output_file:</span>
<span id="cb160-3"><a href="#cb160-3" tabindex="-1"></a>  <span class="co">#Open input file for reading and add to a data stream</span></span>
<span id="cb160-4"><a href="#cb160-4" tabindex="-1"></a>  <span class="cf">with</span> <span class="bu">open</span>(wd <span class="op">+</span> <span class="st">&quot;/patients_gut_data.csv&quot;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb160-5"><a href="#cb160-5" tabindex="-1"></a>    <span class="co">#Loop through lines/rows of input_file</span></span>
<span id="cb160-6"><a href="#cb160-6" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> input_file:</span>
<span id="cb160-7"><a href="#cb160-7" tabindex="-1"></a>      <span class="co">#Write row/line to output_file</span></span>
<span id="cb160-8"><a href="#cb160-8" tabindex="-1"></a>      output_file.write(<span class="st">&quot;Study_2022,&quot;</span> <span class="op">+</span> row)</span></code></pre></div>
<p>Open your new file (<strong>“patients_modified.csv”</strong>) in the <code>jupyter-notebook</code> file navigator by clicking on it.
You will see that each row in the data now starts with the “Study_2022” <strong>string</strong>.</p>
</div>
<div id="write-out-the-filtered-undulate-ray-sequence-data" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Write out the filtered Undulate ray sequence data</h2>
<p><img src="figures/Leucoraja%20erinacea.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Returning to our example data relating to the undulate ray, we have a list of sequence records (trimmed_sequences).
These have passed our filters and we now want to write out the FASTQ file so that it might be further analysed using another piece of software.</p>
<p><b>Return to your “04-Practical_python” notebook.</b></p>
<p>At the bottom of the notebook, we’ll <strong>write</strong> the trimmed data to a new fastq file.
We can carry this out with <code>SeqIO's</code> built in <code>write()</code> <strong>method</strong>, specifying we want a FASTQ format file.</p>
<p><strong>Note:</strong> Ensure the <strong>cells</strong> above your new <strong>cell</strong> have been run.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a><span class="co">#Open a new file for writing and add it to a data stream</span></span>
<span id="cb161-2"><a href="#cb161-2" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_filtered_seqs.fastq&quot;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> output_file:</span>
<span id="cb161-3"><a href="#cb161-3" tabindex="-1"></a>  <span class="co">#Write the previously created trimmed_sequence data to the output file as a fastq file</span></span>
<span id="cb161-4"><a href="#cb161-4" tabindex="-1"></a>  SeqIO.write(trimmed_sequences, output_file, <span class="st">&quot;fastq&quot;</span>)</span></code></pre></div>
<p>This trimmed, filtered file would now be ready to go into whichever subsequent analysis was desired.</p>
<p>Use your <code>jupyter-notebook</code> file navigator to check that the file exists and that it is approximately 3MBs in size.</p>
</div>
<div id="reading-and-writing-mcq-recap" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Reading and writing MCQ recap</h2>
<p><img src="figures/question_bubble_red.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Sublime! You’ve successfully finished this chapter.</p>
<p>For a quick recap, choose the correct option to complete the below sentences:</p>
<ol style="list-style-type: decimal">
<li>The ________ <strong>function</strong> is used to <strong>read</strong>, <strong>write</strong>, or <strong>append</strong> data from/to files.
<div id="radio_NFQBODTYXQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_NFQBODTYXQ" value="answer"></input> <span><strong><code>open()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_NFQBODTYXQ" value=""></input> <span><strong><code>SeqIO.write()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_NFQBODTYXQ" value=""></input> <span><strong><code>.write()</code></strong></span></label>
</div></li>
<li>The ________ <strong>method</strong> is used to <strong>write</strong> data to a file.
<div id="radio_GIHGHRJKDG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GIHGHRJKDG" value=""></input> <span><strong><code>open()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_GIHGHRJKDG" value=""></input> <span><strong><code>SeqIO.write()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_GIHGHRJKDG" value="answer"></input> <span><strong><code>.write()</code></strong></span></label>
</div></li>
<li>The ________ <strong>function</strong> is used to write biological data (such as fastq) to files.
<div id="radio_GIZQZHOZBV" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GIZQZHOZBV" value=""></input> <span><strong><code>open()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_GIZQZHOZBV" value="answer"></input> <span><strong><code>SeqIO.write()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_GIZQZHOZBV" value=""></input> <span><strong><code>.write()</code></strong></span></label>
</div></li>
<li>The ________ <strong>statement</strong> opens a data stream allowing you to carry out more tasks with opened data.
<div id="radio_UQVPWIRUFZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UQVPWIRUFZ" value=""></input> <span><strong><code>&gt;=</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_UQVPWIRUFZ" value=""></input> <span><strong><code>.startswith()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_UQVPWIRUFZ" value="answer"></input> <span><strong><code>with</code></strong></span></label>
</div></li>
<li>In chapter 13 we checked the lengths of reads with the logical comparison ________.
<div id="radio_UVBNBROKGM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UVBNBROKGM" value="answer"></input> <span><strong><code>&gt;=</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_UVBNBROKGM" value=""></input> <span><strong><code>.startswith()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_UVBNBROKGM" value=""></input> <span><strong><code>with</code></strong></span></label>
</div></li>
<li>In chapter 13 we checked for the presence of a PCR sequence at the start of each sequence with the <strong>method</strong> ________.
<div id="radio_TWOFPGHSZC" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TWOFPGHSZC" value=""></input> <span><strong><code>&gt;=</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_TWOFPGHSZC" value="answer"></input> <span><strong><code>.startswith()</code></strong></span></label><label><input type="radio" autocomplete="off" name="radio_TWOFPGHSZC" value=""></input> <span><strong><code>with</code></strong></span></label>
</div></li>
</ol>

</div>
</div>
<div id="logical_operators" class="section level1" number="15">
<h1><span class="header-section-number">15</span> Logical operators</h1>
<p><img src="figures/logic.png" width="15%" style="display: block; margin: auto;" /></p>
<p>In this chapter you will learn how to use 2 different <strong>logical operators</strong>:</p>
<ul>
<li><code>and</code></li>
<li><code>or</code></li>
</ul>
<p>With these <strong>operators</strong> you will:</p>
<ul>
<li>Filter reads by GC% ranges.</li>
<li>Detect the presence of 1 or more amino acids.</li>
</ul>
<p>This will further solidify your use of <strong>loops</strong> and <strong>conditions</strong>.</p>
<p>Use a new notebook called <strong>“06-Logical_operators”</strong>. Add the following code to the top of this notebook to load the required <strong>library</strong>.</p>
<p><strong>Note</strong>: Ensure <code>wd =</code> is set to <strong>your</strong> working directory (not <code>nsc201</code>).</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a>wd <span class="op">=</span> <span class="st">&quot;/pub14/tea/nsc201/Python_course_data&quot;</span></span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span></code></pre></div>
<div id="and-logical-operator" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> and logical operator</h2>
<p><img src="figures/and.png" width="15%" style="display: block; margin: auto;" /></p>
<p>We will first look at the <code>and</code> <strong>logical operator</strong>.
This allows us to compare two comparisons.
<strong>If</strong> both are <code>True</code> the <strong>conditional statement</strong> will return as <code>True</code>.
<strong>If</strong> either/both are <code>False</code> the <strong>conditional statement</strong> will return as <code>False</code>.
Lets show a few examples.</p>
<p>First create a few demonstration variables.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" tabindex="-1"></a>num_list <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]</span>
<span id="cb163-2"><a href="#cb163-2" tabindex="-1"></a>string_list <span class="op">=</span> [<span class="st">&quot;one&quot;</span>,<span class="st">&quot;two&quot;</span>,<span class="st">&quot;three&quot;</span>,<span class="st">&quot;four&quot;</span>,<span class="st">&quot;five&quot;</span>,<span class="st">&quot;six&quot;</span>,<span class="st">&quot;seven&quot;</span>,<span class="st">&quot;eight&quot;</span>,<span class="st">&quot;nine&quot;</span>]</span></code></pre></div>
<p>Print numbers between 3 <strong>and</strong> 7.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="co">#Loop through numbers</span></span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a><span class="cf">for</span> num <span class="kw">in</span> num_list:</span>
<span id="cb164-3"><a href="#cb164-3" tabindex="-1"></a>  <span class="co">#If number is greater than 3 and less than 7</span></span>
<span id="cb164-4"><a href="#cb164-4" tabindex="-1"></a>  <span class="cf">if</span> num <span class="op">&gt;</span> <span class="dv">3</span> <span class="kw">and</span> num <span class="op">&lt;</span> <span class="dv">7</span>:</span>
<span id="cb164-5"><a href="#cb164-5" tabindex="-1"></a>    <span class="co">#Print number</span></span>
<span id="cb164-6"><a href="#cb164-6" tabindex="-1"></a>    <span class="bu">print</span>(num)</span></code></pre></div>
<p>Print numbers divisible by 2 that are also greater than 5.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a><span class="co">#Loop through numbers</span></span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a><span class="cf">for</span> num <span class="kw">in</span> num_list:</span>
<span id="cb165-3"><a href="#cb165-3" tabindex="-1"></a>  <span class="co">#If number is divisible by 2 and greater than 5</span></span>
<span id="cb165-4"><a href="#cb165-4" tabindex="-1"></a>  <span class="cf">if</span> num<span class="op">%</span><span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> num <span class="op">&gt;</span> <span class="dv">5</span>:</span>
<span id="cb165-5"><a href="#cb165-5" tabindex="-1"></a>    <span class="co">#Print number</span></span>
<span id="cb165-6"><a href="#cb165-6" tabindex="-1"></a>    <span class="bu">print</span>(num)</span></code></pre></div>
<p>Print strings longer than three characters <strong>and</strong> has at least one letter <strong>e</strong>.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a><span class="co">#Loop through strings</span></span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a><span class="cf">for</span> string <span class="kw">in</span> string_list:</span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a>  <span class="co">#If string length is greater than 3 and the &quot;e&quot; count is greater than 0</span></span>
<span id="cb166-4"><a href="#cb166-4" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">len</span>(string) <span class="op">&gt;</span> <span class="dv">3</span> <span class="kw">and</span> string.count(<span class="st">&quot;e&quot;</span>) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb166-5"><a href="#cb166-5" tabindex="-1"></a>    <span class="co">#Print the string</span></span>
<span id="cb166-6"><a href="#cb166-6" tabindex="-1"></a>    <span class="bu">print</span>(string)</span></code></pre></div>
<p>Print strings shorter or equal to 3 characters <strong>and</strong> that have no <strong>e</strong>.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="co">#Loop through strings</span></span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a><span class="cf">for</span> string <span class="kw">in</span> string_list:</span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a>  <span class="co">#If string length is less than or equal to 3 and the &quot;e&quot; count is 0</span></span>
<span id="cb167-4"><a href="#cb167-4" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">len</span>(string) <span class="op">&lt;=</span> <span class="dv">3</span> <span class="kw">and</span> string.count(<span class="st">&quot;e&quot;</span>) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb167-5"><a href="#cb167-5" tabindex="-1"></a>    <span class="co">#Print the string</span></span>
<span id="cb167-6"><a href="#cb167-6" tabindex="-1"></a>    <span class="bu">print</span>(string)</span></code></pre></div>
<p>In the above examples we have only used one <code>and</code> <strong>operator</strong>. You can use multiple but of course the more you use the more complex your <strong>statement</strong> becomes.</p>
</div>
<div id="filter-by-gc-range" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Filter by GC% range</h2>
<p><img src="figures/40_60_range.png" width="40%" style="display: block; margin: auto;" /></p>
<p>With the <code>and</code> <strong>logical operator</strong> we can filter by a GC% range.</p>
<p>The next bit of coding will retain reads with a GC% between 40% and 60%. This is not normally something you would do but instead we’ve included it for demonstrative purposes.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a><span class="co">#Read in the fastq data</span></span>
<span id="cb168-2"><a href="#cb168-2" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb168-3"><a href="#cb168-3" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" tabindex="-1"></a><span class="co">#Initialise an empty list to hold the records that we want to keep</span></span>
<span id="cb168-5"><a href="#cb168-5" tabindex="-1"></a>gc_sequences <span class="op">=</span> []</span>
<span id="cb168-6"><a href="#cb168-6" tabindex="-1"></a></span>
<span id="cb168-7"><a href="#cb168-7" tabindex="-1"></a><span class="co">#Variables for choice of min and max gc%</span></span>
<span id="cb168-8"><a href="#cb168-8" tabindex="-1"></a>min_gc <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb168-9"><a href="#cb168-9" tabindex="-1"></a>max_gc <span class="op">=</span> <span class="dv">60</span></span>
<span id="cb168-10"><a href="#cb168-10" tabindex="-1"></a></span>
<span id="cb168-11"><a href="#cb168-11" tabindex="-1"></a><span class="co">#Loop through the fastq records</span></span>
<span id="cb168-12"><a href="#cb168-12" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb168-13"><a href="#cb168-13" tabindex="-1"></a>  <span class="co">#Calculate GC%</span></span>
<span id="cb168-14"><a href="#cb168-14" tabindex="-1"></a>  gc_count <span class="op">=</span> record.seq.upper().count(<span class="st">&quot;G&quot;</span>) <span class="op">+</span> record.seq.upper().count(<span class="st">&quot;C&quot;</span>)</span>
<span id="cb168-15"><a href="#cb168-15" tabindex="-1"></a>  gc_perc <span class="op">=</span> (gc_count <span class="op">/</span> <span class="bu">len</span>(record.seq)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb168-16"><a href="#cb168-16" tabindex="-1"></a>  <span class="co">#If GC percent is greater than min and less than max</span></span>
<span id="cb168-17"><a href="#cb168-17" tabindex="-1"></a>  <span class="cf">if</span> gc_perc <span class="op">&gt;</span> min_gc <span class="kw">and</span> gc_perc <span class="op">&lt;</span> max_gc:</span>
<span id="cb168-18"><a href="#cb168-18" tabindex="-1"></a>    <span class="co">#Add the record to the list of records</span></span>
<span id="cb168-19"><a href="#cb168-19" tabindex="-1"></a>    gc_sequences.append(record)</span>
<span id="cb168-20"><a href="#cb168-20" tabindex="-1"></a></span>
<span id="cb168-21"><a href="#cb168-21" tabindex="-1"></a><span class="co">#Print statement to show number of reads retained after length filtering</span></span>
<span id="cb168-22"><a href="#cb168-22" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Found &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(gc_sequences)) <span class="op">+</span> <span class="st">&quot; reads with GC</span><span class="sc">% r</span><span class="st">ange between &quot;</span> <span class="op">+</span> </span>
<span id="cb168-23"><a href="#cb168-23" tabindex="-1"></a>  <span class="bu">str</span>(min_gc) <span class="op">+</span> <span class="st">&quot;% and &quot;</span> <span class="op">+</span> <span class="bu">str</span>(max_gc) <span class="op">+</span> <span class="st">&quot;%.&quot;</span>)</span></code></pre></div>
<p>Ensure you understand the above code before continuing.
Please ask a demonstrator if you are unsure.</p>
</div>
<div id="or-logical-operator" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> or logical operator</h2>
<p><img src="figures/oar.png" width="15%" style="display: block; margin: auto;" /></p>
<p>For this we will use the <code>or</code> <strong>logical operator</strong>. This allows us to test two comparisons and <strong>if</strong> the first <strong>or</strong> second is <code>True</code> the <strong>condition</strong> will return the output. Lets go through a few examples.</p>
<p>We will use the same variables as our <code>and</code> <strong>operator</strong> examples.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a>num_list <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a>string_list <span class="op">=</span> [<span class="st">&quot;one&quot;</span>,<span class="st">&quot;two&quot;</span>,<span class="st">&quot;three&quot;</span>,<span class="st">&quot;four&quot;</span>,<span class="st">&quot;five&quot;</span>,<span class="st">&quot;six&quot;</span>,<span class="st">&quot;seven&quot;</span>,<span class="st">&quot;eight&quot;</span>,<span class="st">&quot;nine&quot;</span>]</span></code></pre></div>
<p>Print numbers greater than 4 <strong>or</strong> if they are odd.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="co">#Loop through numbers</span></span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a><span class="cf">for</span> num <span class="kw">in</span> num_list:</span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a>  <span class="co">#If number is greater than 4 or odd</span></span>
<span id="cb170-4"><a href="#cb170-4" tabindex="-1"></a>  <span class="cf">if</span> num <span class="op">&gt;</span> <span class="dv">4</span> <span class="kw">or</span> num<span class="op">%</span><span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb170-5"><a href="#cb170-5" tabindex="-1"></a>    <span class="co">#Print number</span></span>
<span id="cb170-6"><a href="#cb170-6" tabindex="-1"></a>    <span class="bu">print</span>(num)</span></code></pre></div>
<p>Print numbers less than or equal to 2 <strong>or</strong> greater than or equal to 8.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a><span class="co">#Loop through numbers</span></span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a><span class="cf">for</span> num <span class="kw">in</span> num_list:</span>
<span id="cb171-3"><a href="#cb171-3" tabindex="-1"></a>  <span class="co">#If number is less than or equal to 2 or greater than or equal to 8</span></span>
<span id="cb171-4"><a href="#cb171-4" tabindex="-1"></a>  <span class="cf">if</span> num <span class="op">&lt;=</span> <span class="dv">2</span> <span class="kw">or</span> num <span class="op">&gt;=</span> <span class="dv">8</span>:</span>
<span id="cb171-5"><a href="#cb171-5" tabindex="-1"></a>    <span class="co">#Print number</span></span>
<span id="cb171-6"><a href="#cb171-6" tabindex="-1"></a>    <span class="bu">print</span>(num)</span></code></pre></div>
<p>Print strings shorter than 4 characters <strong>or</strong> longer than 4 characters.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a><span class="co">#Loop through strings</span></span>
<span id="cb172-2"><a href="#cb172-2" tabindex="-1"></a><span class="cf">for</span> string <span class="kw">in</span> string_list:</span>
<span id="cb172-3"><a href="#cb172-3" tabindex="-1"></a>  <span class="co">#If string length is less than or greater than 4</span></span>
<span id="cb172-4"><a href="#cb172-4" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">len</span>(string) <span class="op">&lt;</span> <span class="dv">4</span> <span class="kw">or</span> <span class="bu">len</span>(string) <span class="op">&gt;</span> <span class="dv">4</span>:</span>
<span id="cb172-5"><a href="#cb172-5" tabindex="-1"></a>    <span class="co">#Print the string</span></span>
<span id="cb172-6"><a href="#cb172-6" tabindex="-1"></a>    <span class="bu">print</span>(string)</span></code></pre></div>
<p>Print strings with an <strong>n</strong> count of more than 1 <strong>or</strong> an <strong>e</strong> count of 0.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a><span class="co">#Loop through strings</span></span>
<span id="cb173-2"><a href="#cb173-2" tabindex="-1"></a><span class="cf">for</span> string <span class="kw">in</span> string_list:</span>
<span id="cb173-3"><a href="#cb173-3" tabindex="-1"></a>  <span class="co">#If n count is greater than 0 or e count is 0</span></span>
<span id="cb173-4"><a href="#cb173-4" tabindex="-1"></a>  <span class="cf">if</span> string.count(<span class="st">&quot;n&quot;</span>) <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> string.count(<span class="st">&quot;e&quot;</span>) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb173-5"><a href="#cb173-5" tabindex="-1"></a>    <span class="co">#Print the string</span></span>
<span id="cb173-6"><a href="#cb173-6" tabindex="-1"></a>    <span class="bu">print</span>(string)</span></code></pre></div>
</div>
<div id="amino-acid-detection" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> Amino acid detection</h2>
<p><img src="figures/amino_acid.png" width="15%" style="display: block; margin: auto;" /></p>
<p>In this part you will translate part of each sequence with <code>.translate()</code>.
Then you will count the number of sequences that have at least one translated <strong>Glutamine (Q)</strong> or <strong>Serine (S)</strong>.
This will be carried out with the <code>or</code> <strong>logical operator</strong>.</p>
<p>When translating the sequence length needs to be divisible by three to match codon lengths. We will only translate the first 10 codons (30 bases) to check.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a><span class="co">#Read in the fastq data</span></span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a>R_undulata_data <span class="op">=</span> SeqIO.parse(wd <span class="op">+</span> <span class="st">&quot;/R_undulata_WGS.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a></span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a><span class="co">#Initialise a variable for the counter</span></span>
<span id="cb174-5"><a href="#cb174-5" tabindex="-1"></a>counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb174-6"><a href="#cb174-6" tabindex="-1"></a></span>
<span id="cb174-7"><a href="#cb174-7" tabindex="-1"></a><span class="co">#Variables for amino acids</span></span>
<span id="cb174-8"><a href="#cb174-8" tabindex="-1"></a>aa_1 <span class="op">=</span> <span class="st">&quot;S&quot;</span></span>
<span id="cb174-9"><a href="#cb174-9" tabindex="-1"></a>aa_2 <span class="op">=</span> <span class="st">&quot;Q&quot;</span></span>
<span id="cb174-10"><a href="#cb174-10" tabindex="-1"></a></span>
<span id="cb174-11"><a href="#cb174-11" tabindex="-1"></a><span class="co">#Loop through the fastq records</span></span>
<span id="cb174-12"><a href="#cb174-12" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> R_undulata_data:</span>
<span id="cb174-13"><a href="#cb174-13" tabindex="-1"></a>  <span class="co">#If condition so we only analyse reads that are 30bps or longer</span></span>
<span id="cb174-14"><a href="#cb174-14" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">len</span>(record.seq) <span class="op">&gt;=</span> <span class="dv">30</span>:</span>
<span id="cb174-15"><a href="#cb174-15" tabindex="-1"></a>    <span class="co">#Extract the first 30 bases</span></span>
<span id="cb174-16"><a href="#cb174-16" tabindex="-1"></a>    subset_seq <span class="op">=</span> record.seq[:<span class="dv">30</span>]</span>
<span id="cb174-17"><a href="#cb174-17" tabindex="-1"></a>    <span class="co">#Translate sequence</span></span>
<span id="cb174-18"><a href="#cb174-18" tabindex="-1"></a>    aa_seq <span class="op">=</span> subset_seq.translate()</span>
<span id="cb174-19"><a href="#cb174-19" tabindex="-1"></a>    <span class="co">#Amino acid counts</span></span>
<span id="cb174-20"><a href="#cb174-20" tabindex="-1"></a>    aa_1_count <span class="op">=</span> aa_seq.upper().count(aa_1)</span>
<span id="cb174-21"><a href="#cb174-21" tabindex="-1"></a>    aa_2_count <span class="op">=</span> aa_seq.upper().count(aa_2)</span>
<span id="cb174-22"><a href="#cb174-22" tabindex="-1"></a>    <span class="co">#If aa_1 is present or aa_2 is present</span></span>
<span id="cb174-23"><a href="#cb174-23" tabindex="-1"></a>    <span class="cf">if</span> aa_1_count <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">or</span> aa_2_count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb174-24"><a href="#cb174-24" tabindex="-1"></a>      <span class="co">#Add 1 to counter</span></span>
<span id="cb174-25"><a href="#cb174-25" tabindex="-1"></a>      counter <span class="op">=</span> counter <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb174-26"><a href="#cb174-26" tabindex="-1"></a></span>
<span id="cb174-27"><a href="#cb174-27" tabindex="-1"></a><span class="co">#Print statement to show number translated sequences with either of the amino acids</span></span>
<span id="cb174-28"><a href="#cb174-28" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Found &quot;</span> <span class="op">+</span> <span class="bu">str</span>(counter) <span class="op">+</span> <span class="st">&quot; reads with a translated &quot;</span> <span class="op">+</span> </span>
<span id="cb174-29"><a href="#cb174-29" tabindex="-1"></a>  aa_1 <span class="op">+</span> <span class="st">&quot; or &quot;</span> <span class="op">+</span> aa_2 <span class="op">+</span> <span class="st">&quot; in the first 10 codons.&quot;</span>)</span></code></pre></div>
</div>
<div id="logical-operators-reflection" class="section level2" number="15.5">
<h2><span class="header-section-number">15.5</span> Logical operators reflection</h2>
<p><img src="figures/reflection.png" width="20%" style="display: block; margin: auto;" /></p>
<p>Excellent! You have learnt how to use the <code>and</code> and <code>or</code> <strong>logical operators</strong>.
You now have a good tool kit to carry out a lot of different python coding and be able to learn more yourself.</p>
<p>We’ll finish this book with some challenges to give you practice with all you have learnt.</p>

</div>
</div>



<div id="fundrecapexercise" class="section level1" number="16">
<h1><span class="header-section-number">16</span> Fundamental recap exercise</h1>
<p><img src="figures/exercise_2.png" width="15%" style="display: block; margin: auto;" /></p>
<p>In this section you’ll be going through multiple exercises.
These will try to bring in everything you have learnt throughout the course.</p>
<p>Solutions are in the expandable boxes. Try your best to solve the challenge but use the solutions for help if you would like. Even if your solution works it can be good to check the solution as there are many ways to do the same thing in python.</p>
<p>This exercise will primarily focus on the fundamentals you learnt in chapters 5 to 9.</p>
<p>Create a new notebook called <strong>“07-Fundamental_recap_exercise”</strong> to carry out the below challenges.</p>
<p><strong>Tip:</strong> The Appendix will be useful for quick lookup of various python <strong>functions</strong>, <strong>methods</strong>, etc..</p>
<div id="fre-challenge-1" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> FRE challenge 1</h2>
<p><img src="figures/header_footbal.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Create a <strong>markdown</strong> cell with the 1st level header “Fundamental recap exercise”.</p>
<div class="webex-solution">
<button>
FREC1 solution
</button>
<div class="sourceCode" id="cb175"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a><span class="co"># Fundamental recap exercise</span></span></code></pre></div>
</div>
</div>
<div id="fre-challenge-2" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> FRE challenge 2</h2>
<p><img src="figures/calculator_2.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Carry out the following calculations with python.
Ensure each answer is displayed on your notebook.</p>
<ol style="list-style-type: decimal">
<li>Add 1 and 17.</li>
<li>Divide 17 by 6.</li>
<li>Subtract 5 from 9.</li>
<li>Multiply 0.1 by 60.</li>
<li>Find the remainder when dividing 7 by 0.6.</li>
</ol>
<div class="webex-solution">
<button>
FREC2 solution
</button>
<div class="sourceCode" id="cb176"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a><span class="co">#FREC2.1</span></span>
<span id="cb176-2"><a href="#cb176-2" tabindex="-1"></a><span class="dv">1</span><span class="op">+</span><span class="dv">17</span></span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a><span class="co">#FREC2.2</span></span>
<span id="cb177-2"><a href="#cb177-2" tabindex="-1"></a><span class="dv">17</span><span class="op">/</span><span class="dv">6</span></span></code></pre></div>
<div class="sourceCode" id="cb178"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a><span class="co">#FREC2.3</span></span>
<span id="cb178-2"><a href="#cb178-2" tabindex="-1"></a><span class="dv">5</span><span class="op">-</span><span class="dv">9</span></span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a><span class="co">#FREC2.4</span></span>
<span id="cb179-2"><a href="#cb179-2" tabindex="-1"></a><span class="fl">0.1</span><span class="op">*</span><span class="dv">60</span></span></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a><span class="co">#FREC2.5</span></span>
<span id="cb180-2"><a href="#cb180-2" tabindex="-1"></a><span class="dv">7</span><span class="op">%</span><span class="fl">0.6</span></span></code></pre></div>
</div>
</div>
<div id="fre-challenge-3" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> FRE challenge 3</h2>
<p><img src="figures/apple.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Write and run the below code to create some <strong>variables</strong></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a><span class="co">#Variables</span></span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a>fruit <span class="op">=</span> <span class="st">&quot;apples&quot;</span></span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a>vegetable <span class="op">=</span> <span class="st">&quot;potatoes&quot;</span></span>
<span id="cb181-4"><a href="#cb181-4" tabindex="-1"></a>money <span class="op">=</span> <span class="st">&quot;POUNDS&quot;</span></span>
<span id="cb181-5"><a href="#cb181-5" tabindex="-1"></a>seven_int <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb181-6"><a href="#cb181-6" tabindex="-1"></a>eight_string <span class="op">=</span> <span class="st">&quot;8&quot;</span></span></code></pre></div>
<p>Using these <strong>variables</strong> <strong>print</strong> out the below sentences. Ensure the <strong>bold words</strong> are made with one or more of the above <strong>variables</strong>.</p>
<p><strong>Note</strong>: Ensure you are matching the case (upper/lower) of the sentences.</p>
<ol style="list-style-type: decimal">
<li>“I have <strong>7</strong> <strong>apples</strong> in a bushel”.</li>
<li>“You have <strong>8</strong> <strong>POTATOES</strong> in a sack”.</li>
<li>“We have <strong>56</strong> <strong>pounds</strong> in a wallet”.</li>
</ol>
<p><strong>Tip</strong>: 8 * 7 = 56</p>
<div class="webex-solution">
<button>
FREC3 solution
</button>
<div class="sourceCode" id="cb182"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a><span class="co">#FREC3.1</span></span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;I have &quot;</span> <span class="op">+</span> <span class="bu">str</span>(seven_int) <span class="op">+</span> <span class="st">&quot; &quot;</span> <span class="op">+</span> fruit <span class="op">+</span> <span class="st">&quot; in a bushel&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb183"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a><span class="co">#FREC3.2</span></span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;You have &quot;</span> <span class="op">+</span> eight_string <span class="op">+</span> <span class="st">&quot; &quot;</span> <span class="op">+</span> vegetable.upper() <span class="op">+</span> <span class="st">&quot; in a sack&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a><span class="co">#FREC3.3</span></span>
<span id="cb184-2"><a href="#cb184-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;We have &quot;</span> <span class="op">+</span> <span class="bu">str</span>(seven_int <span class="op">*</span> <span class="bu">int</span>(eight_string)) <span class="op">+</span> <span class="st">&quot; &quot;</span> <span class="op">+</span> money.lower() <span class="op">+</span> <span class="st">&quot; in a wallet&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="fre-challenge-4" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> FRE challenge 4</h2>
<p><img src="figures/distance.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Write and run the below code to create a <strong>dictionary variable</strong>.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a><span class="co">#Dictionary</span></span>
<span id="cb185-2"><a href="#cb185-2" tabindex="-1"></a><span class="co">#This shows how many metres are in various units of length measurement</span></span>
<span id="cb185-3"><a href="#cb185-3" tabindex="-1"></a>length_dict <span class="op">=</span> {</span>
<span id="cb185-4"><a href="#cb185-4" tabindex="-1"></a>  <span class="st">&quot;metre&quot;</span> : <span class="dv">1</span>,</span>
<span id="cb185-5"><a href="#cb185-5" tabindex="-1"></a>  <span class="st">&quot;inch&quot;</span> : <span class="fl">0.0254</span>,</span>
<span id="cb185-6"><a href="#cb185-6" tabindex="-1"></a>  <span class="st">&quot;mile&quot;</span> : <span class="fl">1609.34</span>,</span>
<span id="cb185-7"><a href="#cb185-7" tabindex="-1"></a>  <span class="st">&quot;yard&quot;</span> : <span class="fl">0.9144</span>,</span>
<span id="cb185-8"><a href="#cb185-8" tabindex="-1"></a>  <span class="st">&quot;foot&quot;</span> : <span class="fl">0.3048</span>,</span>
<span id="cb185-9"><a href="#cb185-9" tabindex="-1"></a>  <span class="st">&quot;league&quot;</span> : <span class="dv">4800</span>,</span>
<span id="cb185-10"><a href="#cb185-10" tabindex="-1"></a>  <span class="st">&quot;nautical mile&quot;</span> : <span class="dv">1852</span>,</span>
<span id="cb185-11"><a href="#cb185-11" tabindex="-1"></a>  <span class="st">&quot;fathom&quot;</span> : <span class="fl">1.8288</span></span>
<span id="cb185-12"><a href="#cb185-12" tabindex="-1"></a>}</span>
<span id="cb185-13"><a href="#cb185-13" tabindex="-1"></a><span class="co">#Print the dictionary to check it</span></span>
<span id="cb185-14"><a href="#cb185-14" tabindex="-1"></a><span class="bu">print</span>(length_dict)</span></code></pre></div>
<p>Using python coding carry out the following tasks:</p>
<ol style="list-style-type: decimal">
<li>Add a new entry to the <strong>dictionary</strong> with the <strong>key</strong> of <strong>“furlong”</strong> and the <strong>value</strong> of <strong>201.168</strong>. Then <strong>print</strong> the dictionary to check it.</li>
<li>Check if a <strong>mile</strong> is <strong>equal</strong> to a <strong>nautical mile</strong>.</li>
<li>Check if a <strong>furlong</strong> is <strong>less</strong> than a <strong>league</strong>.</li>
<li>Check if an <strong>inch</strong> is <strong>greater than or equal</strong> to a <strong>yard divided by 36</strong> (yard/36).</li>
<li>Check if a <strong>foot</strong> is not equal to a <strong>fathom</strong>.</li>
</ol>
<p><strong>Tip</strong>: This will require the retrieval of values from the <strong>dictionary</strong> (dict[“key”]) and the use of <strong>logical operators</strong> (<code>&gt;</code>, <code>&lt;</code>, etc.)</p>
<div class="webex-solution">
<button>
FREC4 solution
</button>
<div class="sourceCode" id="cb186"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a><span class="co">#FREC4.1</span></span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a>length_dict[<span class="st">&quot;furlong&quot;</span>] <span class="op">=</span> <span class="fl">201.168</span></span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a><span class="bu">print</span>(length_dict)</span></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a><span class="co">#FREC4.2</span></span>
<span id="cb187-2"><a href="#cb187-2" tabindex="-1"></a>length_dict[<span class="st">&quot;mile&quot;</span>] <span class="op">==</span> length_dict[<span class="st">&quot;nautical mile&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="co">#FREC4.3</span></span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a>length_dict[<span class="st">&quot;furlong&quot;</span>] <span class="op">&lt;</span> length_dict[<span class="st">&quot;league&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" tabindex="-1"></a><span class="co">#FREC4.4</span></span>
<span id="cb189-2"><a href="#cb189-2" tabindex="-1"></a>length_dict[<span class="st">&quot;inch&quot;</span>] <span class="op">&gt;=</span> (length_dict[<span class="st">&quot;yard&quot;</span>] <span class="op">/</span> <span class="dv">36</span>)</span></code></pre></div>
<div class="sourceCode" id="cb190"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a><span class="co">#FREC4.5</span></span>
<span id="cb190-2"><a href="#cb190-2" tabindex="-1"></a>length_dict[<span class="st">&quot;foot&quot;</span>] <span class="op">!=</span> length_dict[<span class="st">&quot;fathom&quot;</span>]</span></code></pre></div>
</div>
</div>
<div id="fre-challenge-5" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> FRE challenge 5</h2>
<p><img src="figures/clock.png" width="15%" style="display: block; margin: auto;" /></p>
<p>In this challenge you will create 3 <strong>lists</strong> related to time.
The <strong>variable names</strong> and contents of these <strong>lists</strong> are:</p>
<ol style="list-style-type: decimal">
<li><strong><code>hours</code></strong>: Numbers 1 to 9.</li>
<li><strong><code>minutes</code></strong>: Number of minutes in 1 hour to 9 hours.</li>
<li><strong><code>seconds</code></strong>: Number of seconds in 1 hour to 9 hours.</li>
</ol>
<p>Once created <strong>print</strong> all these <strong>lists</strong>.</p>
<p><strong>Note</strong>: A <strong>for loop</strong> will be useful to create <code>minutes</code> and <code>seconds</code> using the <code>hours</code> <strong>list</strong>.</p>
<div class="webex-solution">
<button>
FREC5 solution
</button>
<div class="sourceCode" id="cb191"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a><span class="co">#FRE5</span></span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a>hours <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]</span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a>minutes <span class="op">=</span> []</span>
<span id="cb191-4"><a href="#cb191-4" tabindex="-1"></a>seconds <span class="op">=</span> []</span>
<span id="cb191-5"><a href="#cb191-5" tabindex="-1"></a><span class="cf">for</span> hour <span class="kw">in</span> hours:</span>
<span id="cb191-6"><a href="#cb191-6" tabindex="-1"></a>  minute <span class="op">=</span> hour <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb191-7"><a href="#cb191-7" tabindex="-1"></a>  minutes.append(minute)</span>
<span id="cb191-8"><a href="#cb191-8" tabindex="-1"></a>  seconds.append(minute <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb191-9"><a href="#cb191-9" tabindex="-1"></a><span class="bu">print</span>(hours)</span>
<span id="cb191-10"><a href="#cb191-10" tabindex="-1"></a><span class="bu">print</span>(minutes)</span>
<span id="cb191-11"><a href="#cb191-11" tabindex="-1"></a><span class="bu">print</span>(seconds)</span></code></pre></div>
</div>
</div>
<div id="exercise-1-conclusion" class="section level2" number="16.6">
<h2><span class="header-section-number">16.6</span> Exercise 1 conclusion</h2>
<p><img src="figures/finish.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Great going! You can save, and close and halt your notebook.</p>
<p>Through the challenges you got more practice of:</p>
<ul>
<li><strong><code>Jupyter-notebook</code></strong> headers.</li>
<li>Arithmetic <strong>operators</strong>.</li>
<li><strong>Printing</strong> multiple <strong>strings</strong> together.</li>
<li>Conversion of <strong>variables</strong> to different <strong>classes</strong> and <strong>cases</strong>.</li>
<li>Logical <strong>comparisons</strong>.</li>
<li>Retrieval of <strong>values</strong> from a <strong>dictionary</strong> using their <strong>key</strong>.</li>
<li>Creating <strong>lists</strong> and using a <strong>for loop</strong> with it.</li>
</ul>
<p>The next chapter will have some harder challenges.</p>

</div>
</div>
<div id="national-animals-exercise" class="section level1" number="17">
<h1><span class="header-section-number">17</span> National animals exercise</h1>
<p><img src="figures/tiger.png" width="25%" style="display: block; margin: auto;" /></p>
<p>In this chapter you’ll be going through a set of challenges which will involves a file containing information on the national animals of different countries. It contains two columns; <strong>Country</strong> and <strong>National Animal</strong>. This dataset was found in <a href="https://www.kaggle.com/datasets/rambomind/countries-and-their-national-animals">kaggle</a>.</p>
<p>Along with using the skills and knowledge you have gained you will also learn a few new things.</p>
<p>Some of the challenges have hidden <strong>tips</strong> (expandable boxes). For these exercises use the tip first before looking at the solution if you are having difficulty.</p>
<p>Please check the solution in the box even if your solution works. There are many ways to do the same thing in python and its good to see many different methods.</p>
<p>Create a new <code>jupyter-notebook</code> called <strong>“08-National_animals_challenges”</strong> to attempt the challenges.</p>
<div id="na-challenge-1" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> NA challenge 1</h2>
<p><img src="figures/Momotus_aequatorialis.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Read in the file <strong>“national-animals.csv”</strong> in your <strong>“Python_course_data”</strong> directory. Then <strong>print</strong> the line “The national animal of &lt;country&gt; is the &lt;animal&gt;” for each line in the file.</p>
<div class="webex-solution">
<button>
National animals 1 solution
</button>
<div class="sourceCode" id="cb192"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a><span class="co">#NAC1</span></span>
<span id="cb192-2"><a href="#cb192-2" tabindex="-1"></a><span class="co">#Read in the file using with statement</span></span>
<span id="cb192-3"><a href="#cb192-3" tabindex="-1"></a><span class="co">#If your jupyter notebook is in the same directory as the file you only need to provide the file name</span></span>
<span id="cb192-4"><a href="#cb192-4" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;national-animals.csv&quot;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb192-5"><a href="#cb192-5" tabindex="-1"></a>  <span class="co">#Loop through the lines of input_file</span></span>
<span id="cb192-6"><a href="#cb192-6" tabindex="-1"></a>  <span class="cf">for</span> row <span class="kw">in</span> input_file:</span>
<span id="cb192-7"><a href="#cb192-7" tabindex="-1"></a>    <span class="co">#Set country and animal to variables using .split() method</span></span>
<span id="cb192-8"><a href="#cb192-8" tabindex="-1"></a>    country <span class="op">=</span> row.split(<span class="st">&quot;,&quot;</span>)[<span class="dv">0</span>]</span>
<span id="cb192-9"><a href="#cb192-9" tabindex="-1"></a>    animal <span class="op">=</span> row.split(<span class="st">&quot;,&quot;</span>)[<span class="dv">1</span>]</span>
<span id="cb192-10"><a href="#cb192-10" tabindex="-1"></a>    <span class="co">#Print function</span></span>
<span id="cb192-11"><a href="#cb192-11" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;The national animal of &quot;</span> <span class="op">+</span> country <span class="op">+</span> <span class="st">&quot; is the &quot;</span> <span class="op">+</span> animal)</span></code></pre></div>
</div>
<p>You will notice that there are spaces between the lines. This is because there is a newline character (<code>\n</code>) at the end of each line in the file. You can remove these with the <strong>method</strong> <code>.strip()</code>. It removes any leading (start of sentence) and trailing (end of sentence) white spaces (including <code>\n</code>). It’s very useful to quickly clean the input from files.</p>
<p><strong>Note:</strong> The <code>.strip()</code><strong>method</strong> works on <strong>strings</strong>, not data from files. See the below solution for an example on how to use it.</p>
<div class="webex-solution">
<button>
National animals 1 solution with .strip()
</button>
<div class="sourceCode" id="cb193"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" tabindex="-1"></a><span class="co">#NAC1 fixed</span></span>
<span id="cb193-2"><a href="#cb193-2" tabindex="-1"></a><span class="co">#Read in the file using with statement</span></span>
<span id="cb193-3"><a href="#cb193-3" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;national-animals.csv&quot;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb193-4"><a href="#cb193-4" tabindex="-1"></a>  <span class="co">#Loop through the lines of input_file</span></span>
<span id="cb193-5"><a href="#cb193-5" tabindex="-1"></a>  <span class="co">#Can&#39;t strip input_file as it&#39;s a file object</span></span>
<span id="cb193-6"><a href="#cb193-6" tabindex="-1"></a>  <span class="cf">for</span> row <span class="kw">in</span> input_file:</span>
<span id="cb193-7"><a href="#cb193-7" tabindex="-1"></a>    <span class="co">#Set country and animal to variables using .split() method</span></span>
<span id="cb193-8"><a href="#cb193-8" tabindex="-1"></a>    country <span class="op">=</span> row.split(<span class="st">&quot;,&quot;</span>)[<span class="dv">0</span>]</span>
<span id="cb193-9"><a href="#cb193-9" tabindex="-1"></a>    <span class="co">#Can strip the row variable as it is a string variable extracted from the file object</span></span>
<span id="cb193-10"><a href="#cb193-10" tabindex="-1"></a>    animal <span class="op">=</span> row.strip().split(<span class="st">&quot;,&quot;</span>)[<span class="dv">1</span>]</span>
<span id="cb193-11"><a href="#cb193-11" tabindex="-1"></a>    <span class="co">#Print function</span></span>
<span id="cb193-12"><a href="#cb193-12" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;The national animal of &quot;</span> <span class="op">+</span> country <span class="op">+</span> <span class="st">&quot; is the &quot;</span> <span class="op">+</span> animal)</span></code></pre></div>
</div>
<p><strong>Ensure</strong> you use <code>.strip()</code> in this challenge and the next to remove the <code>\n</code> characters.</p>
</div>
<div id="na-challenge-2" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> NA challenge 2</h2>
<p><img src="figures/Rhizoprionodon_terraenovae.png" width="25%" style="display: block; margin: auto;" /></p>
<p>Read in the file <strong>“national-animals.csv”</strong>. Then convert the data into a dictionary called <strong>“national_animals”</strong>. Ensure the <strong>key</strong> is the <strong>country</strong> and the <strong>value</strong> is the <strong>animal</strong>.</p>
<p>Once created <strong>print</strong> the <strong>dictionary’s</strong> contents.</p>
<p><strong>Tip</strong>: You may be able to copy and edit the <strong>loop</strong> you made in the first challenge.</p>
<div class="webex-solution">
<button>
National animals 2 solution
</button>
<div class="sourceCode" id="cb194"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" tabindex="-1"></a><span class="co">#NAC2</span></span>
<span id="cb194-2"><a href="#cb194-2" tabindex="-1"></a><span class="co">#Create empty dictionary</span></span>
<span id="cb194-3"><a href="#cb194-3" tabindex="-1"></a>national_animals <span class="op">=</span> {}</span>
<span id="cb194-4"><a href="#cb194-4" tabindex="-1"></a><span class="co">#Read in the file using with statement</span></span>
<span id="cb194-5"><a href="#cb194-5" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;national-animals.csv&quot;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb194-6"><a href="#cb194-6" tabindex="-1"></a>  <span class="co">#Loop through the lines of input_file</span></span>
<span id="cb194-7"><a href="#cb194-7" tabindex="-1"></a>  <span class="cf">for</span> row <span class="kw">in</span> input_file:</span>
<span id="cb194-8"><a href="#cb194-8" tabindex="-1"></a>    <span class="co">#Set country and animal to variables using .split() method</span></span>
<span id="cb194-9"><a href="#cb194-9" tabindex="-1"></a>    country <span class="op">=</span> row.split(<span class="st">&quot;,&quot;</span>)[<span class="dv">0</span>]</span>
<span id="cb194-10"><a href="#cb194-10" tabindex="-1"></a>    animal <span class="op">=</span> row.strip().split(<span class="st">&quot;,&quot;</span>)[<span class="dv">1</span>]</span>
<span id="cb194-11"><a href="#cb194-11" tabindex="-1"></a>    <span class="co">#Set key and value</span></span>
<span id="cb194-12"><a href="#cb194-12" tabindex="-1"></a>    national_animals[country] <span class="op">=</span> animal</span>
<span id="cb194-13"><a href="#cb194-13" tabindex="-1"></a><span class="co">#Print dictionary</span></span>
<span id="cb194-14"><a href="#cb194-14" tabindex="-1"></a><span class="bu">print</span>(national_animals)</span></code></pre></div>
</div>
<p>You may have noticed that the first <strong>pair</strong> is <code>'Country': 'National Animal'</code>. This is the header of the file and we do not want to keep it.</p>
<p>There are various ways to not include the header when <strong>reading</strong> in a file. One straightforward method is to create your data and then remove the header. This can be carried out in different ways for different <strong>data structures</strong>:</p>
<ul>
<li><strong>List</strong>: Subset to only include all the values except the first one
<ul>
<li>E.g <code>list = list[1:]</code>.</li>
</ul></li>
<li><strong>Dictionary</strong>: Use the <code>del</code> <strong>keyword</strong> to delete a pair.
<ul>
<li>E.g: <code>del dictionary[key]</code>.</li>
</ul></li>
</ul>
<p>Try this yourself or see the edited solution below.</p>
<div class="webex-solution">
<button>
National animals 2 solution with del
</button>
<div class="sourceCode" id="cb195"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" tabindex="-1"></a><span class="co">#NAC2 with del</span></span>
<span id="cb195-2"><a href="#cb195-2" tabindex="-1"></a><span class="co">#Create empty dictionary</span></span>
<span id="cb195-3"><a href="#cb195-3" tabindex="-1"></a>national_animals <span class="op">=</span> {}</span>
<span id="cb195-4"><a href="#cb195-4" tabindex="-1"></a><span class="co">#Read in the file using with statement</span></span>
<span id="cb195-5"><a href="#cb195-5" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;national-animals.csv&quot;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb195-6"><a href="#cb195-6" tabindex="-1"></a>  <span class="co">#Loop through the lines of input_file</span></span>
<span id="cb195-7"><a href="#cb195-7" tabindex="-1"></a>  <span class="cf">for</span> row <span class="kw">in</span> input_file:</span>
<span id="cb195-8"><a href="#cb195-8" tabindex="-1"></a>    <span class="co">#Set country and animal to variables using .split() method</span></span>
<span id="cb195-9"><a href="#cb195-9" tabindex="-1"></a>    country <span class="op">=</span> row.split(<span class="st">&quot;,&quot;</span>)[<span class="dv">0</span>]</span>
<span id="cb195-10"><a href="#cb195-10" tabindex="-1"></a>    animal <span class="op">=</span> row.strip().split(<span class="st">&quot;,&quot;</span>)[<span class="dv">1</span>]</span>
<span id="cb195-11"><a href="#cb195-11" tabindex="-1"></a>    <span class="co">#Set key and value</span></span>
<span id="cb195-12"><a href="#cb195-12" tabindex="-1"></a>    national_animals[country] <span class="op">=</span> animal</span>
<span id="cb195-13"><a href="#cb195-13" tabindex="-1"></a><span class="co">#Remove the pair from the header</span></span>
<span id="cb195-14"><a href="#cb195-14" tabindex="-1"></a><span class="kw">del</span> national_animals[<span class="st">&quot;Country&quot;</span>]</span>
<span id="cb195-15"><a href="#cb195-15" tabindex="-1"></a><span class="co">#Print dictionary</span></span>
<span id="cb195-16"><a href="#cb195-16" tabindex="-1"></a><span class="bu">print</span>(national_animals)</span></code></pre></div>
</div>
<p>What if you what to automate this so you don’t have to manually enter the <strong>key</strong> from the first <strong>pair</strong>?</p>
<p>You can extract the first line of a file with the <strong>method</strong> <code>.readline()</code>. You can then get the string of the first column of the first line with:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a>fstring <span class="op">=</span> <span class="bu">open</span>(<span class="st">&quot;national-animals.csv&quot;</span>, <span class="st">&#39;r&#39;</span>).readline().strip().split(<span class="st">&quot;,&quot;</span>)[<span class="dv">0</span>]</span></code></pre></div>
<p>This can then be used with <code>del</code>. I encourage you to attempt this before looking at the below solution.</p>
<div class="webex-solution">
<button>
National animals 2 solution with del automated
</button>
<div class="sourceCode" id="cb197"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" tabindex="-1"></a><span class="co">#NAC2 with automated del</span></span>
<span id="cb197-2"><a href="#cb197-2" tabindex="-1"></a><span class="co">#Create empty dictionary</span></span>
<span id="cb197-3"><a href="#cb197-3" tabindex="-1"></a>national_animals <span class="op">=</span> {}</span>
<span id="cb197-4"><a href="#cb197-4" tabindex="-1"></a><span class="co">#Read in the file using with statement</span></span>
<span id="cb197-5"><a href="#cb197-5" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;national-animals.csv&quot;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> input_file:</span>
<span id="cb197-6"><a href="#cb197-6" tabindex="-1"></a>  <span class="co">#Loop through the lines of input_file</span></span>
<span id="cb197-7"><a href="#cb197-7" tabindex="-1"></a>  <span class="cf">for</span> row <span class="kw">in</span> input_file:</span>
<span id="cb197-8"><a href="#cb197-8" tabindex="-1"></a>    <span class="co">#Set country and animal to variables using .split() method</span></span>
<span id="cb197-9"><a href="#cb197-9" tabindex="-1"></a>    country <span class="op">=</span> row.split(<span class="st">&quot;,&quot;</span>)[<span class="dv">0</span>]</span>
<span id="cb197-10"><a href="#cb197-10" tabindex="-1"></a>    animal <span class="op">=</span> row.strip().split(<span class="st">&quot;,&quot;</span>)[<span class="dv">1</span>]</span>
<span id="cb197-11"><a href="#cb197-11" tabindex="-1"></a>    <span class="co">#Set key and value</span></span>
<span id="cb197-12"><a href="#cb197-12" tabindex="-1"></a>    national_animals[country] <span class="op">=</span> animal</span>
<span id="cb197-13"><a href="#cb197-13" tabindex="-1"></a><span class="co">#Get key from first line</span></span>
<span id="cb197-14"><a href="#cb197-14" tabindex="-1"></a>fstring <span class="op">=</span> <span class="bu">open</span>(<span class="st">&quot;national-animals.csv&quot;</span>, <span class="st">&#39;r&#39;</span>).readline().strip().split()[<span class="dv">0</span>]</span>
<span id="cb197-15"><a href="#cb197-15" tabindex="-1"></a><span class="co">#Remove the pair from the header</span></span>
<span id="cb197-16"><a href="#cb197-16" tabindex="-1"></a><span class="kw">del</span> national_animals[fstring]</span>
<span id="cb197-17"><a href="#cb197-17" tabindex="-1"></a><span class="co">#Print dictionary</span></span>
<span id="cb197-18"><a href="#cb197-18" tabindex="-1"></a><span class="bu">print</span>(national_animals)</span></code></pre></div>
</div>
<p>There are many other ways to do this, but I will let you discover these yourself in your future python coding. You could also remove the header line with a text editor or bash before reading it in.</p>
<p><strong>Ensure</strong> your <strong>dictionary</strong> <strong>“national_animals”</strong> does not have the header information before continuing.</p>
</div>
<div id="na-challenge-3" class="section level2" number="17.3">
<h2><span class="header-section-number">17.3</span> NA challenge 3</h2>
<p><img src="figures/Giraffa_camelopardalis.png" width="15%" style="display: block; margin: auto;" /></p>
<p><strong>Print</strong> out the national animals of the following countries:</p>
<ul>
<li><strong>Bangladesh</strong></li>
<li><strong>Nicaragua</strong></li>
<li><strong>Marshall Islands</strong></li>
<li><strong>Niger</strong></li>
</ul>
<p>Use the <strong>dictionary</strong> <strong>“national_animals”</strong> and carry out this challenge in one <strong>coding cell</strong>.</p>
<div class="webex-solution">
<button>
National animals 3 solution
</button>
<div class="sourceCode" id="cb198"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a><span class="co">#NAC3</span></span>
<span id="cb198-2"><a href="#cb198-2" tabindex="-1"></a><span class="bu">print</span>(national_animals[<span class="st">&quot;Bangladesh&quot;</span>])</span>
<span id="cb198-3"><a href="#cb198-3" tabindex="-1"></a><span class="bu">print</span>(national_animals[<span class="st">&quot;Nicaragua&quot;</span>])</span>
<span id="cb198-4"><a href="#cb198-4" tabindex="-1"></a><span class="bu">print</span>(national_animals[<span class="st">&quot;Marshall Islands&quot;</span>])</span>
<span id="cb198-5"><a href="#cb198-5" tabindex="-1"></a><span class="bu">print</span>(national_animals[<span class="st">&quot;Niger&quot;</span>])</span></code></pre></div>
</div>
</div>
<div id="na-challenge-4" class="section level2" number="17.4">
<h2><span class="header-section-number">17.4</span> NA challenge 4</h2>
<p><img src="figures/Iguana_iguana.png" width="20%" style="display: block; margin: auto;" /></p>
<p>Create a <strong>list</strong> of the animals using the <strong>values</strong> from the <strong>dictionary</strong> <strong>“national_animals”</strong>. Call the <strong>list “animals_list”</strong>. Then <strong>print</strong> the <strong>list</strong>.</p>
<p>Additionally, create and print a <strong>set</strong> of the animals called <strong>“animals_set”</strong>.</p>
<p><strong>Tip</strong>: Looping through a <strong>dictionary</strong> will provide the <strong>key</strong> as the <strong>loop variable</strong>. This can be used to extract the <strong>value</strong> from the <strong>dictionary</strong>. You can try the example code below.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" tabindex="-1"></a><span class="co">#Loop dictionary and print values</span></span>
<span id="cb199-2"><a href="#cb199-2" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> national_animals:</span>
<span id="cb199-3"><a href="#cb199-3" tabindex="-1"></a>  value <span class="op">=</span> national_animals[key]</span>
<span id="cb199-4"><a href="#cb199-4" tabindex="-1"></a>  <span class="bu">print</span>(value)</span></code></pre></div>
<div class="webex-solution">
<button>
National animals 4 solution
</button>
<div class="sourceCode" id="cb200"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" tabindex="-1"></a><span class="co">#NAC4.1</span></span>
<span id="cb200-2"><a href="#cb200-2" tabindex="-1"></a><span class="co">#Create empty list</span></span>
<span id="cb200-3"><a href="#cb200-3" tabindex="-1"></a>animals_list <span class="op">=</span> []</span>
<span id="cb200-4"><a href="#cb200-4" tabindex="-1"></a><span class="co">#Loop through keys</span></span>
<span id="cb200-5"><a href="#cb200-5" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> national_animals:</span>
<span id="cb200-6"><a href="#cb200-6" tabindex="-1"></a>  animals_list.append(national_animals[key])</span>
<span id="cb200-7"><a href="#cb200-7" tabindex="-1"></a><span class="co">#Print list</span></span>
<span id="cb200-8"><a href="#cb200-8" tabindex="-1"></a><span class="bu">print</span>(animals_list)</span></code></pre></div>
<div class="sourceCode" id="cb201"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" tabindex="-1"></a><span class="co">#NAC4.2</span></span>
<span id="cb201-2"><a href="#cb201-2" tabindex="-1"></a><span class="co">#Create set from list</span></span>
<span id="cb201-3"><a href="#cb201-3" tabindex="-1"></a>animals_set <span class="op">=</span> <span class="bu">set</span>(animals_list)</span>
<span id="cb201-4"><a href="#cb201-4" tabindex="-1"></a><span class="co">#Print</span></span>
<span id="cb201-5"><a href="#cb201-5" tabindex="-1"></a><span class="bu">print</span>(animals_set)</span></code></pre></div>
</div>
</div>
<div id="na-challenge-5" class="section level2" number="17.5">
<h2><span class="header-section-number">17.5</span> NA challenge 5</h2>
<p><img src="figures/Aquila%20nipalensis.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Carry out the below tasks with python coding.</p>
<ol style="list-style-type: decimal">
<li>Print out the 5th to 7th animals in <strong>animals_list</strong>.</li>
<li>Print out the first 3 animals in <strong>animals_list</strong>.</li>
<li>Print out the last 5 animals in <strong>animals_list</strong>.</li>
<li>Print out all the animals except the first 190 in <strong>animals_list</strong>.</li>
<li>Print out all the animals except the last 180 in <strong>animals_list</strong>.</li>
<li>How many more countries are there compared to the number of unique national animals?</li>
</ol>
<div class="webex-solution">
<button>
National animals 5 solution
</button>
<div class="sourceCode" id="cb202"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" tabindex="-1"></a><span class="co">#NAC5</span></span>
<span id="cb202-2"><a href="#cb202-2" tabindex="-1"></a><span class="co">#5 to 7</span></span>
<span id="cb202-3"><a href="#cb202-3" tabindex="-1"></a><span class="bu">print</span>(animals_list[<span class="dv">4</span>:<span class="dv">7</span>])</span>
<span id="cb202-4"><a href="#cb202-4" tabindex="-1"></a><span class="co">#First 3</span></span>
<span id="cb202-5"><a href="#cb202-5" tabindex="-1"></a><span class="bu">print</span>(animals_list[:<span class="dv">3</span>])</span>
<span id="cb202-6"><a href="#cb202-6" tabindex="-1"></a><span class="co">#Last 5</span></span>
<span id="cb202-7"><a href="#cb202-7" tabindex="-1"></a><span class="bu">print</span>(animals_list[<span class="op">-</span><span class="dv">5</span>:])</span>
<span id="cb202-8"><a href="#cb202-8" tabindex="-1"></a><span class="co">#All except first 190</span></span>
<span id="cb202-9"><a href="#cb202-9" tabindex="-1"></a><span class="bu">print</span>(animals_list[<span class="dv">190</span>:])</span>
<span id="cb202-10"><a href="#cb202-10" tabindex="-1"></a><span class="co">#All except last 180</span></span>
<span id="cb202-11"><a href="#cb202-11" tabindex="-1"></a><span class="bu">print</span>(animals_list[:<span class="op">-</span><span class="dv">180</span>])</span>
<span id="cb202-12"><a href="#cb202-12" tabindex="-1"></a><span class="co">#How many more countries compared to unique national animals</span></span>
<span id="cb202-13"><a href="#cb202-13" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(national_animals) <span class="op">-</span> <span class="bu">len</span>(animals_set))</span></code></pre></div>
</div>
</div>
<div id="na-challenge-6" class="section level2" number="17.6">
<h2><span class="header-section-number">17.6</span> NA challenge 6</h2>
<p><img src="figures/Crocodylus_porosus.png" width="20%" style="display: block; margin: auto;" /></p>
<p>Create a <strong>dictionary</strong> where the <strong>key</strong> is the animal and the <strong>value</strong> is the number of countries it is a national animal for. Call it <strong>“animal_popularity”</strong>.</p>
<p><strong>Print</strong> <strong>“animal_popularity”</strong>.</p>
<div class="webex-solution">
<button>
National animals 6 tip
</button>
<p>You can count the number of times a <strong>string</strong> appears as <strong>value</strong> in a <strong>list</strong> with <code>.count()</code>. Try out the below code.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" tabindex="-1"></a><span class="co">#Will give zero as there is no value that is just an &quot;a&quot;</span></span>
<span id="cb203-2"><a href="#cb203-2" tabindex="-1"></a><span class="bu">print</span>(animals_list.count(<span class="st">&quot;a&quot;</span>))</span>
<span id="cb203-3"><a href="#cb203-3" tabindex="-1"></a><span class="co">#Will give 19 as there are 19 countries with the Eagle as the national animal</span></span>
<span id="cb203-4"><a href="#cb203-4" tabindex="-1"></a><span class="bu">print</span>(animals_list.count(<span class="st">&quot;Eagle&quot;</span>))</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
National animals 6 solution
</button>
<div class="sourceCode" id="cb204"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" tabindex="-1"></a><span class="co">#NAC6</span></span>
<span id="cb204-2"><a href="#cb204-2" tabindex="-1"></a><span class="co">#Create empty dictionary</span></span>
<span id="cb204-3"><a href="#cb204-3" tabindex="-1"></a>animal_popularity <span class="op">=</span> {}</span>
<span id="cb204-4"><a href="#cb204-4" tabindex="-1"></a><span class="co">#Loop through animal set made in NAC4</span></span>
<span id="cb204-5"><a href="#cb204-5" tabindex="-1"></a><span class="cf">for</span> animal <span class="kw">in</span> animals_set:</span>
<span id="cb204-6"><a href="#cb204-6" tabindex="-1"></a>  <span class="co">#Count the number of times the animal appears in the animal list made in NAC4</span></span>
<span id="cb204-7"><a href="#cb204-7" tabindex="-1"></a>  animal_count <span class="op">=</span> animals_list.count(animal)</span>
<span id="cb204-8"><a href="#cb204-8" tabindex="-1"></a>  <span class="co">#Add animal and count to animal_popularity dictionary</span></span>
<span id="cb204-9"><a href="#cb204-9" tabindex="-1"></a>  animal_popularity[animal] <span class="op">=</span> animal_count</span>
<span id="cb204-10"><a href="#cb204-10" tabindex="-1"></a><span class="co">#Print</span></span>
<span id="cb204-11"><a href="#cb204-11" tabindex="-1"></a><span class="bu">print</span>(animal_popularity)</span></code></pre></div>
</div>
</div>
<div id="na-challenge-7" class="section level2" number="17.7">
<h2><span class="header-section-number">17.7</span> NA challenge 7</h2>
<p><img src="figures/Panthera_leo.png" width="20%" style="display: block; margin: auto;" /></p>
<p>This challenge is difficult. Please, try your best to make a solution before looking at my solution. You can solve this with the <strong>fuctions, methods</strong>, etcs that you have learnt in this course. Optionally, I encourage you to search online for help, this is what normal day to day bioinformatics involves.</p>
<p>Using the <strong>“animal_popularity” dictionary</strong> answer the question “What animal represents the most countries as their national animal?”</p>
<p>With this information print the statement “The most popular animal is the &lt;animal&gt; which represents &lt;country count&gt; countries as their national animal.”</p>
<p>Do not simply look through the <strong>dictionary</strong> <strong>“animal_popularity”</strong>. Create code that could be reused for any <strong>dictionary</strong> containing <strong>integer</strong> <strong>values</strong>.</p>
<div class="webex-solution">
<button>
National animals 7 tip
</button>
<p>First create 2 <strong>variables</strong> to then be used in a <strong>for loop</strong>. Use an <strong>if</strong> statement in your <strong>for loop</strong>.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" tabindex="-1"></a>highest_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb205-2"><a href="#cb205-2" tabindex="-1"></a>most_popular_animal <span class="op">=</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
</div>
<div class="webex-solution">
<button>
National animals 7 solution
</button>
<div class="sourceCode" id="cb206"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" tabindex="-1"></a><span class="co">#NAC7</span></span>
<span id="cb206-2"><a href="#cb206-2" tabindex="-1"></a><span class="co">#Set variable of highest count and most popular animal</span></span>
<span id="cb206-3"><a href="#cb206-3" tabindex="-1"></a>highest_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb206-4"><a href="#cb206-4" tabindex="-1"></a>most_popular_animal <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb206-5"><a href="#cb206-5" tabindex="-1"></a><span class="co">#Loop through animal set made in NAC4</span></span>
<span id="cb206-6"><a href="#cb206-6" tabindex="-1"></a><span class="cf">for</span> animal <span class="kw">in</span> animals_set:</span>
<span id="cb206-7"><a href="#cb206-7" tabindex="-1"></a>  <span class="co">#If statement checking if animal count is greater than highest_count</span></span>
<span id="cb206-8"><a href="#cb206-8" tabindex="-1"></a>  <span class="cf">if</span> animal_popularity[animal] <span class="op">&gt;</span> highest_count:</span>
<span id="cb206-9"><a href="#cb206-9" tabindex="-1"></a>    <span class="co">#Set highest_count and most_popular_animal to current info in loop</span></span>
<span id="cb206-10"><a href="#cb206-10" tabindex="-1"></a>    highest_count <span class="op">=</span> animal_popularity[animal]</span>
<span id="cb206-11"><a href="#cb206-11" tabindex="-1"></a>    most_popular_animal <span class="op">=</span> animal</span>
<span id="cb206-12"><a href="#cb206-12" tabindex="-1"></a><span class="co">#Print statement</span></span>
<span id="cb206-13"><a href="#cb206-13" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The most popular animal is the &quot;</span> <span class="op">+</span> most_popular_animal <span class="op">+</span> <span class="st">&quot; which represents &quot;</span> <span class="op">+</span></span>
<span id="cb206-14"><a href="#cb206-14" tabindex="-1"></a>      <span class="bu">str</span>(highest_count) <span class="op">+</span> <span class="st">&quot; countries as their national animal.&quot;</span>)</span></code></pre></div>
</div>
<p>If you looked for help online you may have found the solution in the below box.</p>
<div class="webex-solution">
<button>
National animals 7 solution with online help
</button>
<div class="sourceCode" id="cb207"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" tabindex="-1"></a><span class="co">#NAC7 with online help</span></span>
<span id="cb207-2"><a href="#cb207-2" tabindex="-1"></a><span class="co">#Max value</span></span>
<span id="cb207-3"><a href="#cb207-3" tabindex="-1"></a>max_value <span class="op">=</span> <span class="bu">max</span>(animal_popularity.values())</span>
<span id="cb207-4"><a href="#cb207-4" tabindex="-1"></a><span class="co">#Max key</span></span>
<span id="cb207-5"><a href="#cb207-5" tabindex="-1"></a>max_key <span class="op">=</span> <span class="bu">max</span>(animal_popularity, key<span class="op">=</span>animal_popularity.get)</span>
<span id="cb207-6"><a href="#cb207-6" tabindex="-1"></a><span class="co">#Print statement</span></span>
<span id="cb207-7"><a href="#cb207-7" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The most popular animal is the &quot;</span> <span class="op">+</span> max_key <span class="op">+</span> <span class="st">&quot; which represents &quot;</span> <span class="op">+</span></span>
<span id="cb207-8"><a href="#cb207-8" tabindex="-1"></a>      <span class="bu">str</span>(max_value) <span class="op">+</span> <span class="st">&quot; countries as their national animal.&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="na-challenge-8" class="section level2" number="17.8">
<h2><span class="header-section-number">17.8</span> NA challenge 8</h2>
<p><img src="figures/Pteropus_medius.png" width="20%" style="display: block; margin: auto;" /></p>
<p>For the last challenge use the <strong>dictionary</strong> <strong>“animal_popularity”</strong> to <strong>write</strong> to a new file called <strong>“popular_national_animals.csv”</strong>.</p>
<p>Make sure this file has the following features:</p>
<ol style="list-style-type: decimal">
<li>The fields/columns are comma separated (<code>,</code>).</li>
<li>The first line is the header with the following text: “Animal,popularity_count”</li>
<li>There is a line for each animal with a count of 2 or more.</li>
</ol>
<ul>
<li>An example line would be: “Pelican,2”</li>
</ul>
<div class="webex-solution">
<button>
National animals 8 tip
</button>
<p>Add <code>\n</code> to the end of your file lines so each entry is on a new line.</p>
</div>
<div class="webex-solution">
<button>
National animals 8 solution
</button>
<div class="sourceCode" id="cb208"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" tabindex="-1"></a><span class="co">#NAC8</span></span>
<span id="cb208-2"><a href="#cb208-2" tabindex="-1"></a><span class="co">#Create file, open for writing, and put into data stream</span></span>
<span id="cb208-3"><a href="#cb208-3" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;popular_national_animals.csv&quot;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> output_file:</span>
<span id="cb208-4"><a href="#cb208-4" tabindex="-1"></a>  <span class="co">#Write header</span></span>
<span id="cb208-5"><a href="#cb208-5" tabindex="-1"></a>  output_file.write(<span class="st">&quot;Animal,popularity_count</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb208-6"><a href="#cb208-6" tabindex="-1"></a>  <span class="co">#Loop through animal set made in NAC4</span></span>
<span id="cb208-7"><a href="#cb208-7" tabindex="-1"></a>  <span class="cf">for</span> animal <span class="kw">in</span> animals_set:</span>
<span id="cb208-8"><a href="#cb208-8" tabindex="-1"></a>    <span class="co">#Determine if animal count is greater than 1</span></span>
<span id="cb208-9"><a href="#cb208-9" tabindex="-1"></a>    <span class="cf">if</span> animal_popularity[animal] <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb208-10"><a href="#cb208-10" tabindex="-1"></a>      <span class="co">#Write line to file</span></span>
<span id="cb208-11"><a href="#cb208-11" tabindex="-1"></a>      output_file.write(animal <span class="op">+</span> <span class="st">&quot;,&quot;</span> <span class="op">+</span> <span class="bu">str</span>(animal_popularity[animal]) <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="national-animals-conclusion" class="section level2" number="17.9">
<h2><span class="header-section-number">17.9</span> National animals conclusion</h2>
<p><img src="figures/Gallus_gallus_domesticus.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Superlative! That is the end of the national animals exercise. Throughout it you have:</p>
<ul>
<li><strong>Read</strong> in a file and created a <strong>dictionary</strong> with the data.</li>
<li>Extracted <strong>values</strong> using the <strong>keys</strong> of a <strong>dictionary</strong>.</li>
<li>Created a <strong>list</strong> from the <strong>values</strong> of a <strong>dictionary</strong>.</li>
<li>Created a <strong>set</strong> from a <strong>list</strong>.</li>
<li>Extracted <strong>values</strong> from a <strong>list</strong>.</li>
<li>Created a <strong>dictionary</strong> with <strong>integer</strong> values.</li>
<li>Discovered what is the most popular animal.</li>
<li>Created a new file with the most popular animals.</li>
</ul>
<p>One last set of exercises awaits you.</p>

</div>
</div>
<div id="fastq-exercise" class="section level1" number="18">
<h1><span class="header-section-number">18</span> Fastq exercise</h1>
<p><img src="figures/Coriobacteriia.png" width="20%" style="display: block; margin: auto;" /></p>
<p>In this exercise you will read in a fastq file, carry out some filtering, and then write the filtered data to a new fastq file.</p>
<p>The data comes from the paper: <a href="https://www.nature.com/articles/s41598-020-74180-z">“Identification of plastic-associated species in the Mediterranean Sea using DNA metabarcoding with Nanopore MinION”</a>.</p>
<p>They had a lot of different samples but our sample (<a href="https://www.ncbi.nlm.nih.gov/sra/SRX8124700%5Baccn%5D">SRR11554953</a>) contains 16S sequences from a polyethylene food bag that has been in the Mediterranean sea for a month. The researchers carried this out as they were interested in the organisms present in the “plastisphere biota”.</p>
<p>The researchers used MinION sequencing to target the full 1.5 kb-long 16S rRNA gene for bacterial profiling.</p>
<p>To have a smaller dataset the fastq file you will be using only contains the first 10,000 sequences from the sample. The file is called <strong>“SRR11554953.10k.fastq”</strong>.</p>
<p>For this exercise create and use a new <strong>notebook</strong> called <strong>“09-Fastq_exercise”</strong>.</p>
<div id="fastq-challenge-1" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> Fastq challenge 1</h2>
<p><img src="figures/bacillus_subtilis.png" width="15%" style="display: block; margin: auto;" /></p>
<p>For your first challenge, <strong>read</strong> in the fastq file (<strong>“SRR11554953.10k.fastq”</strong>) and count the number of sequences there are. <strong>Print</strong> this number.</p>
<p><strong>Tip:</strong> Remember to load the <strong>module</strong> and <strong>library</strong> for <strong>reading/parsing</strong> the fastq file into python.</p>
<div class="webex-solution">
<button>
Fastq 1 solution
</button>
<div class="sourceCode" id="cb209"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" tabindex="-1"></a><span class="co">#FC1</span></span>
<span id="cb209-2"><a href="#cb209-2" tabindex="-1"></a><span class="co">#Read in data</span></span>
<span id="cb209-3"><a href="#cb209-3" tabindex="-1"></a>seq_data <span class="op">=</span> SeqIO.parse(<span class="st">&quot;SRR11554953.10k.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb209-4"><a href="#cb209-4" tabindex="-1"></a><span class="co">#Set count to zero</span></span>
<span id="cb209-5"><a href="#cb209-5" tabindex="-1"></a>count<span class="op">=</span><span class="dv">0</span></span>
<span id="cb209-6"><a href="#cb209-6" tabindex="-1"></a><span class="co">#Loop through records</span></span>
<span id="cb209-7"><a href="#cb209-7" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> seq_data:</span>
<span id="cb209-8"><a href="#cb209-8" tabindex="-1"></a>  count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb209-9"><a href="#cb209-9" tabindex="-1"></a><span class="co">#Print final count</span></span>
<span id="cb209-10"><a href="#cb209-10" tabindex="-1"></a><span class="bu">print</span>(count)</span></code></pre></div>
</div>
</div>
<div id="fastq-challenge-2" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> Fastq challenge 2</h2>
<p><img src="figures/Nitriliruptoria.png" width="15%" style="display: block; margin: auto;" /></p>
<p>In the paper they remove reads with an average/mean quality that is less than 10. Therefore you will do the same thing.</p>
<p>Carry out the following steps:</p>
<ul>
<li><strong>Read</strong> in the fastq file (<strong>“SRR11554953.10k.fastq”</strong>) as a <strong>variable</strong> called <strong>“seq_data”</strong>.</li>
<li>Use a minimum average phred quality of 10 to filter reads. I.e. retain reads with an average quality that is equal to or greater than 10.</li>
<li>Create a <strong>variable</strong> called <strong>“q10_filtered_records”</strong> to contain the reads that passed the filter.</li>
<li>At the end of the code <strong>print</strong> the statement:
<ul>
<li>“The number of retained sequences after filtering reads with a mean quality less than 10 is: &lt;number&gt;”.</li>
</ul></li>
<li>Ensure you can easily change the minimum quality.</li>
</ul>
<p><strong>Tip</strong>: You can extract the quality scores from a record as a <strong>list</strong> with:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> seq_data:</span>
<span id="cb210-2"><a href="#cb210-2" tabindex="-1"></a>  phred_score_list <span class="op">=</span> record.letter_annotations[<span class="st">&quot;phred_quality&quot;</span>]</span></code></pre></div>
<div class="webex-solution">
<button>
Fastq 2 solution
</button>
<div class="sourceCode" id="cb211"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" tabindex="-1"></a><span class="co">#FC2</span></span>
<span id="cb211-2"><a href="#cb211-2" tabindex="-1"></a><span class="co">#Read in data</span></span>
<span id="cb211-3"><a href="#cb211-3" tabindex="-1"></a>seq_data <span class="op">=</span> SeqIO.parse(<span class="st">&quot;SRR11554953.10k.fastq&quot;</span>, <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb211-4"><a href="#cb211-4" tabindex="-1"></a></span>
<span id="cb211-5"><a href="#cb211-5" tabindex="-1"></a><span class="co">#Set minimum mean quality threshold</span></span>
<span id="cb211-6"><a href="#cb211-6" tabindex="-1"></a>min_qual <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb211-7"><a href="#cb211-7" tabindex="-1"></a><span class="co">#List for filtered sequences</span></span>
<span id="cb211-8"><a href="#cb211-8" tabindex="-1"></a>q10_filtered_records <span class="op">=</span> []</span>
<span id="cb211-9"><a href="#cb211-9" tabindex="-1"></a></span>
<span id="cb211-10"><a href="#cb211-10" tabindex="-1"></a><span class="co">#Loop through records</span></span>
<span id="cb211-11"><a href="#cb211-11" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> seq_data:</span>
<span id="cb211-12"><a href="#cb211-12" tabindex="-1"></a>  <span class="co">#Set phred score list</span></span>
<span id="cb211-13"><a href="#cb211-13" tabindex="-1"></a>  phred_score_list <span class="op">=</span> record.letter_annotations[<span class="st">&quot;phred_quality&quot;</span>]</span>
<span id="cb211-14"><a href="#cb211-14" tabindex="-1"></a>  <span class="co">#Calculate average/mean phred</span></span>
<span id="cb211-15"><a href="#cb211-15" tabindex="-1"></a>  mean_phred <span class="op">=</span> <span class="bu">sum</span>(phred_score_list)<span class="op">/</span><span class="bu">len</span>(phred_score_list)</span>
<span id="cb211-16"><a href="#cb211-16" tabindex="-1"></a>  <span class="co">#If to determine if quality higher or equal to 10</span></span>
<span id="cb211-17"><a href="#cb211-17" tabindex="-1"></a>  <span class="cf">if</span> mean_phred <span class="op">&gt;=</span> min_qual:</span>
<span id="cb211-18"><a href="#cb211-18" tabindex="-1"></a>    <span class="co">#Add threshold passing record to filtered list</span></span>
<span id="cb211-19"><a href="#cb211-19" tabindex="-1"></a>    q10_filtered_records.append(record)</span>
<span id="cb211-20"><a href="#cb211-20" tabindex="-1"></a><span class="co">#Print</span></span>
<span id="cb211-21"><a href="#cb211-21" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The number of retained sequences after filtering reads with a mean quality less than &quot;</span> <span class="op">+</span></span>
<span id="cb211-22"><a href="#cb211-22" tabindex="-1"></a>      <span class="bu">str</span>(min_qual) <span class="op">+</span> <span class="st">&quot; is: &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(q10_filtered_records)))</span></code></pre></div>
</div>
<p>In this case none of the reads were removed as they were all high quality.</p>
</div>
<div id="fastq-challenge-3" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> Fastq challenge 3</h2>
<p><img src="figures/Verrucomicrobiae.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Our previous filtering step didn’t remove any reads so prior to length filtering we will check the lengths of the reads.</p>
<p>Carry out the following tasks:</p>
<ol style="list-style-type: decimal">
<li>With your <strong>variable “q10_filtered_records”</strong> create a <strong>list</strong> called <strong>“seq_lengths”</strong> which contains all the lengths of all the sequences.</li>
<li><strong>Print</strong> the length of the shortest read and longest read.
<ul>
<li><strong>Tip</strong>: The <strong>functions</strong> <code>min()</code> and <code>max()</code> can be used on an <strong>intger list</strong>.</li>
</ul></li>
<li>Calculate the number of sequences with length ranges of: 1150-1199, 1200-1249, 1250-1299, 1300-1349, 1350-1399, 1400-1449, &amp; 1500-1549.
<ul>
<li>Save these values in a <strong>list</strong> called <strong>“range_counts”</strong>.</li>
<li>Creating the following list may prove useful: <code>range_starts = [1150,1200,1250,1300,1350,1400,1450,1500]</code></li>
<li>Print the <strong>“range_counts”</strong>.</li>
</ul></li>
</ol>
<div class="webex-solution">
<button>
Fastq 3 solution
</button>
<div class="sourceCode" id="cb212"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" tabindex="-1"></a><span class="co">#FC3.1</span></span>
<span id="cb212-2"><a href="#cb212-2" tabindex="-1"></a><span class="co">#Create empty list of seq lengths</span></span>
<span id="cb212-3"><a href="#cb212-3" tabindex="-1"></a>seq_lengths <span class="op">=</span> []</span>
<span id="cb212-4"><a href="#cb212-4" tabindex="-1"></a><span class="co">#Loop through records</span></span>
<span id="cb212-5"><a href="#cb212-5" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> q10_filtered_records:</span>
<span id="cb212-6"><a href="#cb212-6" tabindex="-1"></a>  <span class="co">#Add seqeunce length to list</span></span>
<span id="cb212-7"><a href="#cb212-7" tabindex="-1"></a>  length <span class="op">=</span> <span class="bu">len</span>(record.seq)</span>
<span id="cb212-8"><a href="#cb212-8" tabindex="-1"></a>  seq_lengths.append(length)</span>
<span id="cb212-9"><a href="#cb212-9" tabindex="-1"></a><span class="co">#Print</span></span>
<span id="cb212-10"><a href="#cb212-10" tabindex="-1"></a><span class="bu">print</span>(seq_lengths)</span></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" tabindex="-1"></a><span class="co">#FC3.2</span></span>
<span id="cb213-2"><a href="#cb213-2" tabindex="-1"></a><span class="co">#Discover min and max lengths</span></span>
<span id="cb213-3"><a href="#cb213-3" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">min</span>(seq_lengths))</span>
<span id="cb213-4"><a href="#cb213-4" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">max</span>(seq_lengths))</span></code></pre></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" tabindex="-1"></a><span class="co">#FC3.3</span></span>
<span id="cb214-2"><a href="#cb214-2" tabindex="-1"></a><span class="co">#Create list of range starts</span></span>
<span id="cb214-3"><a href="#cb214-3" tabindex="-1"></a>range_starts <span class="op">=</span> [<span class="dv">1150</span>,<span class="dv">1200</span>,<span class="dv">1250</span>,<span class="dv">1300</span>,<span class="dv">1350</span>,<span class="dv">1400</span>,<span class="dv">1450</span>,<span class="dv">1500</span>]</span>
<span id="cb214-4"><a href="#cb214-4" tabindex="-1"></a><span class="co">#Create empty list for counts</span></span>
<span id="cb214-5"><a href="#cb214-5" tabindex="-1"></a>range_counts <span class="op">=</span> []</span>
<span id="cb214-6"><a href="#cb214-6" tabindex="-1"></a><span class="co">#Loop through range starts</span></span>
<span id="cb214-7"><a href="#cb214-7" tabindex="-1"></a><span class="cf">for</span> start <span class="kw">in</span> range_starts:</span>
<span id="cb214-8"><a href="#cb214-8" tabindex="-1"></a>  <span class="co">#Create count variable</span></span>
<span id="cb214-9"><a href="#cb214-9" tabindex="-1"></a>  count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb214-10"><a href="#cb214-10" tabindex="-1"></a>  <span class="co">#Loop through list of lengths</span></span>
<span id="cb214-11"><a href="#cb214-11" tabindex="-1"></a>  <span class="cf">for</span> length <span class="kw">in</span> seq_lengths:</span>
<span id="cb214-12"><a href="#cb214-12" tabindex="-1"></a>    <span class="co">#If length in range add to current count</span></span>
<span id="cb214-13"><a href="#cb214-13" tabindex="-1"></a>    <span class="cf">if</span> length <span class="op">&gt;=</span>start <span class="kw">and</span> length <span class="op">&lt;</span> (start <span class="op">+</span> <span class="dv">50</span>):</span>
<span id="cb214-14"><a href="#cb214-14" tabindex="-1"></a>      count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb214-15"><a href="#cb214-15" tabindex="-1"></a>    <span class="co">#Add count to count list</span></span>
<span id="cb214-16"><a href="#cb214-16" tabindex="-1"></a>    range_counts.append(count)</span>
<span id="cb214-17"><a href="#cb214-17" tabindex="-1"></a><span class="co">#Print</span></span>
<span id="cb214-18"><a href="#cb214-18" tabindex="-1"></a><span class="bu">print</span>(range_starts)</span>
<span id="cb214-19"><a href="#cb214-19" tabindex="-1"></a><span class="bu">print</span>(range_counts)</span></code></pre></div>
</div>
<p>You’ll notice that the majority of reads are in the length range of 1350-1449. However, there is a range of lengths.</p>
</div>
<div id="fastq-challenge-4" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> Fastq challenge 4</h2>
<p><img src="figures/Vicinamibacteria.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Its time to filter the sequences (<strong>“q10_filtered_records”</strong>) by lengths. Use a minimum length of 1250 and a maximum length of 1450 (these lengths are chosen arbitrarily for this example). Create a <strong>variable</strong> called <strong>“q10_length_filtered_records”</strong> to contain the length filtered reads.</p>
<p>Then <strong>print</strong> the statement: “The number of retained sequences after filtering reads shorter than 1250bps and longer than 1450bps is: &lt;number&gt;”</p>
<div class="webex-solution">
<button>
Fastq 4 solution
</button>
<div class="sourceCode" id="cb215"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" tabindex="-1"></a><span class="co">#FC4</span></span>
<span id="cb215-2"><a href="#cb215-2" tabindex="-1"></a><span class="co">#Set min and max length thresholds</span></span>
<span id="cb215-3"><a href="#cb215-3" tabindex="-1"></a>min_length <span class="op">=</span> <span class="dv">1250</span></span>
<span id="cb215-4"><a href="#cb215-4" tabindex="-1"></a>max_length <span class="op">=</span> <span class="dv">1450</span></span>
<span id="cb215-5"><a href="#cb215-5" tabindex="-1"></a><span class="co">#List for retained sequences</span></span>
<span id="cb215-6"><a href="#cb215-6" tabindex="-1"></a>q10_length_filtered_records <span class="op">=</span> []</span>
<span id="cb215-7"><a href="#cb215-7" tabindex="-1"></a></span>
<span id="cb215-8"><a href="#cb215-8" tabindex="-1"></a><span class="co">#Loop through records</span></span>
<span id="cb215-9"><a href="#cb215-9" tabindex="-1"></a><span class="cf">for</span> record <span class="kw">in</span> q10_filtered_records:</span>
<span id="cb215-10"><a href="#cb215-10" tabindex="-1"></a>  <span class="co">#If condition for length thresholds</span></span>
<span id="cb215-11"><a href="#cb215-11" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">len</span>(record.seq) <span class="op">&gt;=</span> min_length <span class="kw">and</span> <span class="bu">len</span>(record.seq) <span class="op">&lt;=</span> max_length:</span>
<span id="cb215-12"><a href="#cb215-12" tabindex="-1"></a>    <span class="co">#Add record to retained records</span></span>
<span id="cb215-13"><a href="#cb215-13" tabindex="-1"></a>    q10_length_filtered_records.append(record)</span>
<span id="cb215-14"><a href="#cb215-14" tabindex="-1"></a><span class="co">#Print</span></span>
<span id="cb215-15"><a href="#cb215-15" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The number of retained sequences after filtering reads shorter than &quot;</span> <span class="op">+</span></span>
<span id="cb215-16"><a href="#cb215-16" tabindex="-1"></a>      <span class="bu">str</span>(min_length) <span class="op">+</span> <span class="st">&quot;bps and longer than &quot;</span> <span class="op">+</span> <span class="bu">str</span>(max_length) <span class="op">+</span></span>
<span id="cb215-17"><a href="#cb215-17" tabindex="-1"></a>      <span class="st">&quot;bps is: &quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(q10_length_filtered_records)))</span></code></pre></div>
</div>
</div>
<div id="fastq-challenge-5" class="section level2" number="18.5">
<h2><span class="header-section-number">18.5</span> Fastq challenge 5</h2>
<p><img src="figures/Chlorobium_clathratiforme.png" width="15%" style="display: block; margin: auto;" /></p>
<p>For the last challenge, write the data in <strong>“q10_length_filtered_records”</strong> to a fastq file called <strong>“SRR11554953.10k.filtered.fastq”</strong>.</p>
<div class="webex-solution">
<button>
Fastq 5 solution
</button>
<div class="sourceCode" id="cb216"><pre class="sourceCode python Rchunk"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" tabindex="-1"></a><span class="co">#FC5</span></span>
<span id="cb216-2"><a href="#cb216-2" tabindex="-1"></a><span class="co">#Open file</span></span>
<span id="cb216-3"><a href="#cb216-3" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;SRR11554953.10k.filtered&quot;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> output_file:</span>
<span id="cb216-4"><a href="#cb216-4" tabindex="-1"></a>  <span class="co">#Write fastq file</span></span>
<span id="cb216-5"><a href="#cb216-5" tabindex="-1"></a>  SeqIO.write(q10_length_filtered_records, output_file, <span class="st">&quot;fastq&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="fastq-exercise-conclusion" class="section level2" number="18.6">
<h2><span class="header-section-number">18.6</span> Fastq exercise conclusion</h2>
<p><img src="figures/Flexibacter_flexilis.png" width="15%" style="display: block; margin: auto;" /></p>
<p>Stupendous! You have finished the last exercise of this workshop.</p>
<p>In these challenges you learnt how to <strong>read</strong> in a fastq file, interrogate the lengths of the sequences, carry out some filtering, and finally write the filtered data to a new file.</p>
<p>Thanks for your hard work. You have learnt a lot throughout this course but there is always more python to learn. There is the <a href="#further_resources">appendix</a> in this book which points to more resources and there is also a supplementary book with some more things you can learn. I hope this book has given you a good foundation for this language.</p>

</div>
</div>



<div id="further_resources" class="section level1" number="19">
<h1><span class="header-section-number">A</span> Further resources</h1>
<p><img src="figures/further_resources.png" width="20%" style="display: block; margin: auto;" /></p>
<ul>
<li><a href="https://python.swaroopch.com/">A Byte of Python</a></li>
<li><a href="https://docs.python-guide.org/">The Hitchhiker’s Guide to Python!</a></li>
<li><a href="https://docs.python.org/3/">Python documentation</a></li>
<li><a href="https://biopython.org/">Biopython</a>: Set of tools for biological computation written in python.
-<a href="http://biopython.org/DIST/docs/tutorial/Tutorial.html">Biopython tutorial</a>
-<a href="https://biopython.org/wiki/SeqIO">SeqIO website</a>: Interface for input and output of sequence files in python.</li>
</ul>
</div>
<div id="mamba-installs" class="section level1" number="20">
<h1><span class="header-section-number">B</span> Mamba installs</h1>
<p><img src="figures/mamba_logo.png" width="20%" style="display: block; margin: auto;" /></p>
<div id="mamba_install" class="section level2" number="20.1">
<h2><span class="header-section-number">B.1</span> Mamba installation and environment</h2>
<p>Mamba is a reimplementation of conda. It is a great tool for installing bioinformatic packages including R packages.</p>
<p>Mamba github: <a href="https://github.com/mamba-org/mamba" class="uri">https://github.com/mamba-org/mamba</a></p>
<p>The best way to use Mamba is to install Miniforge. It has both Conda and Mamba commands.</p>
<p>Miniforge installation: <a href="https://github.com/conda-forge/miniforge" class="uri">https://github.com/conda-forge/miniforge</a></p>
<p>Mamba guide: <a href="https://mamba.readthedocs.io/en/latest/user_guide/mamba.html" class="uri">https://mamba.readthedocs.io/en/latest/user_guide/mamba.html</a></p>
<p>To create the mamba environment <code>python</code> run the below commands in your bash. You will need to have installed <code>mamba</code> first.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode bash Rchunk"><code class="sourceCode bash"><span id="cb217-1"><a href="#cb217-1" tabindex="-1"></a><span class="co">#Python</span></span>
<span id="cb217-2"><a href="#cb217-2" tabindex="-1"></a><span class="ex">mamba</span> create <span class="at">-n</span> python</span>
<span id="cb217-3"><a href="#cb217-3" tabindex="-1"></a><span class="ex">mamba</span> activate python</span>
<span id="cb217-4"><a href="#cb217-4" tabindex="-1"></a><span class="ex">mamba</span> install <span class="at">-c</span> anaconda jupyter</span>
<span id="cb217-5"><a href="#cb217-5" tabindex="-1"></a><span class="ex">mamba</span> install <span class="at">-c</span> conda-forge biopython</span>
<span id="cb217-6"><a href="#cb217-6" tabindex="-1"></a><span class="ex">mamba</span> install <span class="at">-c</span> anaconda pandas</span>
<span id="cb217-7"><a href="#cb217-7" tabindex="-1"></a><span class="ex">mamba</span> install <span class="at">-c</span> conda-forge matplotlib</span></code></pre></div>
</div>
</div>
<div id="cheatsheet" class="section level1" number="21">
<h1><span class="header-section-number">C</span> Cheatsheet</h1>
<div id="operators-1" class="section level2" number="21.1">
<h2><span class="header-section-number">C.1</span> Operators</h2>
<div id="arithmetic-operators" class="section level3" number="21.1.1">
<h3><span class="header-section-number">C.1.1</span> Arithmetic operators</h3>
<ul>
<li><strong><code>+</code></strong> (addition)</li>
<li><strong><code>-</code></strong> (subtraction)</li>
<li><strong><code>*</code></strong> (multiplication)</li>
<li><strong><code>/</code></strong> (division)</li>
<li><strong><code>**</code></strong> (power/exponent)</li>
<li><strong><code>//</code></strong> (Floor division)</li>
<li><strong><code>%</code></strong> (modulo operator. Find the remainder after dividing 2 numbers)</li>
</ul>
</div>
<div id="comparison-operators" class="section level3" number="21.1.2">
<h3><span class="header-section-number">C.1.2</span> Comparison operators</h3>
<ul>
<li><strong><code>==</code></strong>: Equals logical operator.</li>
<li><strong><code>!=</code></strong>: Does not equal logical operator.</li>
<li><strong><code>&lt;</code></strong>: Less than logical operator.</li>
<li><strong><code>&lt;=</code></strong>: Less than or equal to logical operator.</li>
<li><strong><code>&gt;</code></strong>: Greater than logical operator.</li>
<li><strong><code>&gt;=</code></strong>: Greater than or equal to logical operator.</li>
</ul>
</div>
<div id="logical-operators" class="section level3" number="21.1.3">
<h3><span class="header-section-number">C.1.3</span> Logical operators</h3>
<ul>
<li><strong><code>and</code></strong> logical operator.
<ul>
<li>If both comparisons are <code>True</code> return <code>True</code>.</li>
<li>If either or both comparisons are <code>False</code> return <code>False</code>.</li>
</ul></li>
<li><strong><code>or</code></strong> logical operator.
<ul>
<li>If either or both comparisons are <code>True</code> return <code>True</code>.</li>
<li>If both comparisons are <code>False</code> return <code>False</code>.</li>
</ul></li>
</ul>
</div>
</div>
<div id="functions-1" class="section level2" number="21.2">
<h2><span class="header-section-number">C.2</span> Functions</h2>
<ul>
<li><strong><code>print()</code></strong>: Print specified text.</li>
<li><strong><code>type()</code></strong>: Check <strong>class/type</strong> of a <strong>variable</strong>.</li>
<li><strong><code>str()</code></strong> : Transform <strong>variable</strong> to string <strong>class</strong>.</li>
<li><strong><code>int()</code></strong> : Transform <strong>variable</strong> to integer <strong>class</strong>.</li>
<li><strong><code>float()</code></strong> : Transform <strong>variable</strong> to float <strong>class</strong>.</li>
<li><strong><code>len()</code></strong>: Calculate number of characters in a string <strong>variable</strong>.</li>
<li><strong><code>set()</code></strong>: Transform a <strong>list</strong> to a <strong>set</strong>.</li>
<li><strong><code>reversed()</code></strong>: Reverse a <strong>string</strong>.</li>
<li><strong><code>open()</code></strong>: Open a file for reading (<code>r</code>), writing (<code>w</code>), or appending (<code>a</code>).</li>
</ul>
<div id="biopython-functions" class="section level3" number="21.2.1">
<h3><span class="header-section-number">C.2.1</span> Biopython functions</h3>
<p>For a full list of <code>Bio.SeqIO</code> methods please see the <a href="https://biopython.org/wiki/SeqIO">wiki</a></p>
<ul>
<li><strong><code>SeqIO.parse()</code></strong>: Takes a filename and format name to return a <code>SeqRecord</code> <strong>list</strong>.
<ul>
<li>e.g. <code>fastq_list = SeqIO.parse("example_input.fastq", "fastq")</code></li>
</ul></li>
<li><strong><code>SeqIO.write()</code></strong>: Writes a <code>SeqRecord</code> list as a file with a specified format.
<ul>
<li>e.g. <code>seqIO.write(fastq_list, "example_output.fastq", "fastq")</code></li>
</ul></li>
</ul>
</div>
</div>
<div id="methods-1" class="section level2" number="21.3">
<h2><span class="header-section-number">C.3</span> Methods</h2>
<div id="string-methods" class="section level3" number="21.3.1">
<h3><span class="header-section-number">C.3.1</span> String methods</h3>
<ul>
<li><strong><code>.upper()</code></strong>: Convert string to upper case.</li>
<li><strong><code>.lower()</code></strong>: Convert string to lower case.</li>
<li><strong><code>.count()</code></strong>: Count number of specified string pattern in <strong>string variable</strong> or .</li>
<li><strong><code>.split()</code></strong>: Split string by specified delimiter.</li>
<li><strong><code>.startswith()</code></strong>: Check if a string starts with a particular sub-string. Returns <code>True</code> or <code>False</code>.</li>
<li><strong><code>.strip()</code></strong>: Remove leading or trailing white spaces.</li>
</ul>
</div>
<div id="list-methods" class="section level3" number="21.3.2">
<h3><span class="header-section-number">C.3.2</span> List methods</h3>
<ul>
<li><strong><code>.append()</code></strong>: Append a value to the end of a <strong>list</strong>.</li>
</ul>
</div>
<div id="set-methods" class="section level3" number="21.3.3">
<h3><span class="header-section-number">C.3.3</span> Set methods</h3>
<ul>
<li><strong><code>.add()</code></strong>: Add a value to a <strong>set</strong>.</li>
</ul>
</div>
<div id="file-methods" class="section level3" number="21.3.4">
<h3><span class="header-section-number">C.3.4</span> File methods</h3>
<ul>
<li><strong><code>.write()</code></strong>: <strong>Write</strong> data to a file <strong>opened</strong> for <strong>writing</strong>.</li>
<li><strong><code>.readline()</code></strong>: Extract the first line from a file <strong>opened</strong> for <strong>reading</strong>.</li>
</ul>
</div>
<div id="biopython-methods" class="section level3" number="21.3.5">
<h3><span class="header-section-number">C.3.5</span> Biopython methods</h3>
<ul>
<li><strong><code>.translate()</code></strong>: Translate a DNA sequence record element to a protein sequence.</li>
</ul>
</div>
</div>
<div id="statements" class="section level2" number="21.4">
<h2><span class="header-section-number">C.4</span> Statements</h2>
<ul>
<li><strong><code>for &lt;loop_variable&gt; in &lt;variable&gt;:</code></strong> : Loop through each <strong>value</strong> in a <strong>variable</strong>.</li>
<li><strong><code>with &lt;data&gt; as &lt;variable_name&gt;:</code></strong> : Start a data stream.</li>
</ul>

</div>
</div>
<p style="text-align: center;">
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
