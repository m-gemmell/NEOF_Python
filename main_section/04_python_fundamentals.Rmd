---
title: "Python for Bioinformatics"
author: Graeme Fox
date: "`r format(Sys.time(), '%B, %Y')`"
---
# Python Fundamentals
  
  This chapter covers some of the fundamental concepts of scripting in Python.
  An understanding of how to use *operators*, *variables*, and *functions* will
  give a good grounding in how the language works and allow you to develop
  your own methods and code.
  
  You definitely do not need to memorise all the information here as all of these
  concepts will be explored more in the rest of the tutorial. The best way to
  learn how various aspects of the Python language work is by *doing* rather
  then by *reading*. 
  
  Consider
  coming back to this page later if you want to remind yourself of how a
  particular operator works or how to define a function, for example.
  
  <b> For each of the following sections of example code, enter them directly into the Python interpreter and press enter after each line.</b>

## Operators

<center>![](../images/operators.svg){height=200px}</center>
  Python allows the use of the usual arithmetic operators and
  follows the traditional rules of mathematical precedence (BODMAS). The 
  maths operators are:
  
  * \+ (addition)
    
  * \- (subtraction)
    
  * \* (multiplication)
    
  * \/ (division)
    
  * \** (power)
    
  * \// (integer division)
  
## Comments

<center>![](../images/comment.jpg){height=200px}</center>

It is often useful to include human-readable comments in your scripts and code.
Comments in Python are indicated by the hash symbol (#). Anything to the right
of the hash is considered a comment and is ignored by the interpreter.
When working through the workbook there is no need to add the comments into the
commands or scripts.

```
# This line is a comment

print("This section will print") # This section is ignored

```

## Variables
  Variables are used to store information which can then referenced
  or manipulated later. They are also useful to label data with a descriptive name
  which is more easily read by a human. You can think of a variable as a 'container'
  to hold a piece of information. 
  
  Variables are assigned a value using the equals (=) character.
  Variable names must start with either a letter or an underscore, must only contain
  alphanumeric characters (and underscores), and are case sensitive. Python supports 
  several classes (or types) of variable including strings, integers, floats, and booleans.

### Strings

<center>![](../images/string.png){height=200px}</center>

  **Strings** are used to store alphanumeric text. A string is defined by enclosing the text with either single or double quotes.
    
  Enter the following into the Python terminal, pressing enter after each line. Here we define two string variables, and then retrieve them again by using their name, or identifier.
    
  ```
  DNA_string = "GCACAAACC"
  amino_acids = "ARG VAL TRP"
  
  DNA_string
  amino_acids
  ```
  
### Integers  
  **Integers** are used to store whole numbers. These should not be declared with quote marks
  otherwise they will be stored as a string.
  
  Enter the following:
    
  ```
  my_int = 7
  
  my_int
  ```
  
### Floats (floating point numbers)

<center>![](../images/float.png){height=200px}</center>


  **Floating point numbers** are used to store real numbers (I.e. a number written
  with a decimal point dividing the integer and the fractional parts).
  
  Enter the following:
    
  ```
  my_float = 7.0001
  another_float = 345.765
  yet_another_float = -5.423e+19
  
  my_float
  another_float
  yet_another_float
  ```
  
### Booleans

<center>![](../images/bool.png){height=200px}</center>


  **Booleans** are a special type of variable than can represent one of
  two values: *True* or *False*. You can compare any two values in Python
  and get a result of either True or False.
    
  To check if two values are equal we use double equals:  ==
  To check if two values are not equal we use:   !=
  Greater than or less than also work.
    
  Enter the following:
    
  ```
  a_bool = 10>9
  a_bool
  
  another_bool = "ATGCA" != "ATGCA"
  another_bool
  
  yet_another_bool = 9>42
  yet_another_bool
  ```
  
## Classes of variable

Every variable in Python has a class. These are the string, integer, float, or boolean characteristics we described earlier.

  Unlike some other languages, you do not need to tell Python which class a variable should have. Python will try to figure it out based on the value
  assigned.
    
  You can check the class of a variable by passing it to the 'type' function:
    
  ```
  variable1 = "a piece of text"
  type(variable1)
  
  variable2 = 5
  type(variable2)
  
  variable3 = 7.0001
  type(variable3)
  
  variable4 = True
  type(variable4)
  ```
  
## Transforming variables

<center>![](../images/transform.png){height=200px}</center>

  
  Variables can be transformed from one type to another provided the 
  value can be coerced into the new data type (I.e. you could not transform a 
  string of text to a floating point number). 
    
  To transform a float to an integer using the int() function (note the loss 
  of precision):
    
  ```
  a_float = 17.45
  
  int(a_float)
  ```
    
  To transform an integer to a string using the str() function:
    
  ```
  an_integer = 783473
  str(an_integer)
  ```
    
  You can also transform to a floating point using float().
  
## Functions and methods

<center>![](../images/function.jpg){height=200px}</center>


  Functions and methods are groups of instructions that together perform a specific task. 
  This may be a task that you need to run repeatedly on your data and by storing
  these instructions in a single function, you only need to enter the code 
  once and simply re-use it each time. A function returns a value after it has 
  performed the specific task.

### Running a function
  A function is a distinct piece of code which requires data to be sent to it in order to run.
  To run a function you need to give the name of the function followed by a pair of
  braces with the desired input within the braces. 
  
  We have already been using some functions: the int() and str() functions.
  
  For example, we might want to find the length of a string of nucleotides.
  In this instance, we can use
  the built-in len() function on the string:
  
  (use any string of 'ACGT' you like, no need to copy this one exactly!)
  
  ```
  DNA = "ACGTGTTATATGCGCGTTAGTGTAGTCGATC"
  
  # print the length of the string
  len(DNA)
  ```
  
### Running a method
Methods are very similar to functions in that they process an input in some manner.
They differ in that methods are associated with a particular data class 
(string, for example) and are called via the data itself. 

Methods are called using a
different syntax; the variable is followed by "." and the name of the method with
a pair of braces.

First let's Try a couple of methods associated with manipulation of string data:

```
# define a string called sequencers
sequencers = "illumina,oxford_nanopore,pac-bio"

# the upper() method converts string variables to uppercase
sequencers.upper()

# split() chops a string up wherever the specified sub-string occurs (comma in this case)
sequencers.split(",")

```

We can also use built-in methods for some simple analysis using the "DNA" string generated earlier. For example, the built in 'count' method can be used to count the number of each nucleotide in the string.



```
DNA.count("A")
DNA.count("C")
DNA.count("G")
DNA.count("T")
```

By using the len() function and the count() method, we can calculate the GC content of the DNA sequence:

```
## count the number of G and C in the sequence
G_total = DNA.count("G")
C_total = DNA.count("C")

# calculate the percentage of the sequence that is GC
(G_total + C_total)/len(DNA)*100
```

## Recap

<center>![](../images/recap.webp){height=300px}</center>

We have described and tried some of the major types of variable which are used in Python. 

All variables have a 'class' and this can determine which functions
and methods we can apply to them. 

We have also explored functions and methods,
and can now apply them to variables.

There was lots of information in this chapter and you do not need to have memorised it. Please refer back to this chapter at any point.